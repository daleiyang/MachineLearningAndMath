<!DOCTYPE html>
<!-- saved from url=(0072)http://www.hankcs.com/ml/principal-component-analysis-k-means-cs229.html -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<link rel="dns-prefetch" href="http://apps.bdimg.com/">
<meta http-equiv="X-UA-Compatible" content="IE=11,IE=10,IE=9,IE=8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimum-scale=1.0, maximum-scale=1.0">
<meta name="apple-mobile-web-app-title" content="码农场">
<meta http-equiv="Cache-Control" content="no-siteapp">
<title>CS229编程7：K-means聚类与主成分分析-码农场</title>
<link rel="dns-prefetch" href="http://apps.bdimg.com/">
<link rel="dns-prefetch" href="http://s.w.org/">
		<script src="./CS229编程7：K-means聚类与主成分分析-码农场_files/f(6).txt"></script><script async="" src="./CS229编程7：K-means聚类与主成分分析-码农场_files/analytics.js(1).下载"></script><script src="./CS229编程7：K-means聚类与主成分分析-码农场_files/ca-pub-1152644711996772.js.下载"></script><script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/11\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/11\/svg\/","svgExt":".svg","source":{"concatemoji":"http:\/\/www.hankcs.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.9.8"}};
			!function(a,b,c){function d(a,b){var c=String.fromCharCode;l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,a),0,0);var d=k.toDataURL();l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,b),0,0);var e=k.toDataURL();return d===e}function e(a){var b;if(!l||!l.fillText)return!1;switch(l.textBaseline="top",l.font="600 32px Arial",a){case"flag":return!(b=d([55356,56826,55356,56819],[55356,56826,8203,55356,56819]))&&(b=d([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]),!b);case"emoji":return b=d([55358,56760,9792,65039],[55358,56760,8203,9792,65039]),!b}return!1}function f(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var g,h,i,j,k=b.createElement("canvas"),l=k.getContext&&k.getContext("2d");for(j=Array("flag","emoji"),c.supports={everything:!0,everythingExceptFlag:!0},i=0;i<j.length;i++)c.supports[j[i]]=e(j[i]),c.supports.everything=c.supports.everything&&c.supports[j[i]],"flag"!==j[i]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[j[i]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(h=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",h,!1),a.addEventListener("load",h,!1)):(a.attachEvent("onload",h),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),g=c.source||{},g.concatemoji?f(g.concatemoji):g.wpemoji&&g.twemoji&&(f(g.twemoji),f(g.wpemoji)))}(window,document,window._wpemojiSettings);
		</script><script src="./CS229编程7：K-means聚类与主成分分析-码农场_files/wp-emoji-release.min.js.下载" type="text/javascript" defer=""></script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel="stylesheet" id="_bootstrap-css" href="./CS229编程7：K-means聚类与主成分分析-码农场_files/bootstrap.min.css" type="text/css" media="all">
<link rel="stylesheet" id="_fontawesome-css" href="./CS229编程7：K-means聚类与主成分分析-码农场_files/font-awesome.min.css" type="text/css" media="all">
<link rel="stylesheet" id="_main-css" href="./CS229编程7：K-means聚类与主成分分析-码农场_files/main.css" type="text/css" media="all">
<script type="text/javascript" src="./CS229编程7：K-means聚类与主成分分析-码农场_files/jquery.min.js.下载"></script>
<link rel="https://api.w.org/" href="http://www.hankcs.com/wp-json/">
<link rel="prev" title="Python循序渐进主成分分析" href="http://www.hankcs.com/ml/python-step-by-step-to-achieve-the-principal-component-analysis.html">
<link rel="next" title="CS229编程8：异常检测与推荐系统" href="http://www.hankcs.com/ml/anomaly-detection-and-recommender-systems-cs229.html">
<link rel="canonical" href="http://www.hankcs.com/ml/principal-component-analysis-k-means-cs229.html">
<link rel="shortlink" href="http://www.hankcs.com/?p=8446">
<link rel="alternate" type="application/json+oembed" href="http://www.hankcs.com/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fwww.hankcs.com%2Fml%2Fprincipal-component-analysis-k-means-cs229.html">
<link rel="alternate" type="text/xml+oembed" href="http://www.hankcs.com/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fwww.hankcs.com%2Fml%2Fprincipal-component-analysis-k-means-cs229.html&amp;format=xml">
<meta name="keywords" content="CS229, matlab, 机器学习">
<meta name="description" content="斯坦福ML（Matlab）公开课，这次练习先实现K-means聚类算法并应用于图像压缩，然后实现PCA并用于人脸图像，最后展示高维数据的可视化技巧。我发现matlab做动画特别方便，顺手把算法执行过程动画化了。K-means聚类循序渐进，先在简单的2D数据上做实验：先在上述2D数据集上熟悉K-means的原理，算法原理用matlab描述如下：% I">
<link rel="icon" href="http://www.hankcs.com/wp-content/uploads/2017/04/cropped-Hankcs_512-32x32.png" sizes="32x32">
<link rel="icon" href="http://www.hankcs.com/wp-content/uploads/2017/04/cropped-Hankcs_512-192x192.png" sizes="192x192">
<link rel="apple-touch-icon-precomposed" href="http://www.hankcs.com/wp-content/uploads/2017/04/cropped-Hankcs_512-180x180.png">
<meta name="msapplication-TileImage" content="http://www.hankcs.com/wp-content/uploads/2017/04/cropped-Hankcs_512-270x270.png">
<link rel="shortcut icon" href="http://www.hankcs.com/favicon.ico">
<!--[if lt IE 9]><script src="http://www.hankcs.com/wp-content/themes/dux/js/libs/html5.min.js"></script><![endif]-->
<!--
	generated 25645 seconds ago
	generated in 0.253 seconds
	served from batcache in 0.009 seconds
	expires in 60755 seconds
-->
<link rel="preload" href="./CS229编程7：K-means聚类与主成分分析-码农场_files/f(7).txt" as="script"><script type="text/javascript" src="./CS229编程7：K-means聚类与主成分分析-码农场_files/f(7).txt"></script><link rel="preload" href="http://pagead2.googlesyndication.com/pagead/js/r20180813/r20180604/show_ads_impl.js" as="script"><script async="" data-requirecontext="_" data-requiremodule="main" src="./CS229编程7：K-means聚类与主成分分析-码农场_files/main.js.下载"></script><script src="./CS229编程7：K-means聚类与主成分分析-码农场_files/share.js.下载"></script><link href="./CS229编程7：K-means聚类与主成分分析-码农场_files/share.css" rel="styleSheet" type="text/css"><script async="" data-requirecontext="_" data-requiremodule="lazyload" src="./CS229编程7：K-means聚类与主成分分析-码农场_files/lazyload.min.js.下载"></script><script async="" data-requirecontext="_" data-requiremodule="prettyprint" src="./CS229编程7：K-means聚类与主成分分析-码农场_files/prettyprint.js.下载"></script><script async="" data-requirecontext="_" data-requiremodule="signpop" src="./CS229编程7：K-means聚类与主成分分析-码农场_files/signpop.js.下载"></script><script async="" data-requirecontext="_" data-requiremodule="comment" src="./CS229编程7：K-means聚类与主成分分析-码农场_files/comment.js.下载"></script><img style="width:0;height:0;display:none;visibility:hidden;" src="./CS229编程7：K-means聚类与主成分分析-码农场_files/saved_resource"></head>
<body class="post-template-default single single-post postid-8446 single-format-standard comment-open site-layout-2">
<header class="header">
	<div class="container">
		<div class="logo"><a href="http://www.hankcs.com/" title="码农场-自然语言处理、机器学习算法"><img src="./CS229编程7：K-means聚类与主成分分析-码农场_files/logo.png">码农场</a></div>		<a href="http://www.hankcs.com/" title="码农场-自然语言处理、机器学习算法" class="brand">放牧代码和思想
<br>专注自然语言处理、机器学习算法</a>		<ul class="site-nav site-navbar">
			<li id="menu-item-1834" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1834"><a href="http://www.hankcs.com/program/cpp/">C++</a></li>
<li id="menu-item-1835" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1835"><a href="http://www.hankcs.com/program/java/">Java</a></li>
<li id="menu-item-5754" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-5754"><a href="http://www.hankcs.com/ml/">机器学习</a></li>
<li id="menu-item-2954" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-2954"><a href="http://www.hankcs.com/nlp/">NLP</a>
<ul class="sub-menu">
	<li id="menu-item-4344" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-4344"><a href="http://www.hankcs.com/nlp/corpus/">语料库</a></li>
	<li id="menu-item-4342" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-4342"><a href="http://www.hankcs.com/nlp/segment/">中文分词</a></li>
	<li id="menu-item-4343" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-4343"><a href="http://www.hankcs.com/nlp/ner/">命名实体识别</a></li>
	<li id="menu-item-4479" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-4479"><a href="http://www.hankcs.com/nlp/parsing/">句法分析</a></li>
</ul>
</li>
<li id="menu-item-1837" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1837"><a href="http://www.hankcs.com/program/algorithm/">算法</a></li>
<li id="menu-item-1839" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1839"><a href="http://www.hankcs.com/software/">软件</a></li>
<li id="menu-item-1838" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-1838"><a href="http://www.hankcs.com/nihongonote/">日语</a>
<ul class="sub-menu">
	<li id="menu-item-1860" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1860"><a href="http://www.hankcs.com/nihongonote/riyurimen/">日语入门</a></li>
	<li id="menu-item-1861" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1861"><a href="http://www.hankcs.com/nihongonote/listening/">日语听力</a></li>
	<li id="menu-item-1863" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-1863"><a href="http://www.hankcs.com/nihongonote/tekusuto/">日语综合教程</a>
	<ul class="sub-menu">
		<li id="menu-item-2190" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-2190"><a href="http://www.hankcs.com/nihongonote/tekusuto/disance/">第三册</a></li>
		<li id="menu-item-2192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-2192"><a href="http://www.hankcs.com/nihongonote/tekusuto/daiyonnsatu/">第四册</a></li>
		<li id="menu-item-2191" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-2191"><a href="http://www.hankcs.com/nihongonote/tekusuto/5/">第五册</a></li>
		<li id="menu-item-2702" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-2702"><a href="http://www.hankcs.com/nihongonote/tekusuto/%e7%ac%ac%e5%85%ad%e5%86%8c/">第六册</a></li>
		<li id="menu-item-3604" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3604"><a href="http://www.hankcs.com/nihongonote/tekusuto/%e7%ac%ac%e4%b8%83%e5%86%8c/">第七册</a></li>
	</ul>
</li>
	<li id="menu-item-1859" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-1859"><a href="http://www.hankcs.com/nihongonote/fd2/">新编日语阅读文选</a>
	<ul class="sub-menu">
		<li id="menu-item-2187" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-2187"><a href="http://www.hankcs.com/nihongonote/fd2/c1/">第一册</a></li>
		<li id="menu-item-2189" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-2189"><a href="http://www.hankcs.com/nihongonote/fd2/c2/">第二册</a></li>
		<li id="menu-item-2188" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-2188"><a href="http://www.hankcs.com/nihongonote/fd2/c3/">第三册</a></li>
	</ul>
</li>
	<li id="menu-item-1858" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1858"><a href="http://www.hankcs.com/nihongonote/jpkaiwa/">日语商务贸易会话</a></li>
</ul>
</li>
<li id="menu-item-1843" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1843"><a href="http://www.hankcs.com/about/">关于</a></li>
							<li class="navto-search"><a href="javascript:;" class="search-show active"><i class="fa fa-search"></i></a></li>
					</ul>
		<div class="topbar">
			<ul class="site-nav topmenu">
				<li id="menu-item-5755" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-5755"><a href="http://www.hankcs.com/about/#comments"><i class="fa fa-comment"></i> 留言板</a></li>
				<li><a target="_blank" rel="external nofollow" href="https://github.com/hankcs"><i class="fa fa-github-alt"></i> GitHub</a></li>                                <li><a target="_blank" rel="external nofollow" href="http://weibo.com/hankcs"><i class="fa fa-weibo"></i> 微博</a></li>                                <li><a target="_blank" rel="external nofollow" href="https://twitter.com/hankcs"><i class="fa fa-twitter"></i> Twitter</a></li>                                <li><a target="_blank" href="http://blog.hankcs.com/"><i class="fa fa-language"></i> English</a></li>                <li><a target="_blank" href="http://www.hankcs.com/feed"><i class="fa fa-rss"></i> RSS</a></li>			</ul>
							&nbsp; &nbsp; <i class="fa fa-bullhorn url"></i> <a href="http://www.hankcs.com/about/" target="_blank">我是一个浪人，这里是我的个人博客。我没有师门，都是瞎写的，不用太认真，也不要过于期待。</a><a href="http://www.hankcs.com/about/#comments" target="_blank" textvalue="">留言板</a>。					</div>
		<i class="fa fa-bars m-icon-nav"></i>
	</div>
</header>
<div class="site-search">
	<div class="container">
		<form method="get" class="site-search-form" action="http://www.hankcs.com/"><input class="search-input" name="s" type="text" placeholder="输入关键字" value=""><button class="search-btn" type="submit"><i class="fa fa-search"></i></button></form>	</div>
</div><section class="container">
	<div class="content-wrap">
	<div class="content">
				<header class="article-header">
			<h1 class="article-title"><a href="http://www.hankcs.com/ml/principal-component-analysis-k-means-cs229.html">CS229编程7：K-means聚类与主成分分析</a></h1>
			<div class="article-meta">
				<span class="item">
					<a href="http://www.hankcs.com/">码农场</a> <small>&gt;</small> <a href="http://www.hankcs.com/ml/">机器学习</a><span class="muted"></span>				</span>
				<span class="item">2016-11-10</span>
																<span class="item post-views">阅读(1438)</span>				<span class="item"><a class="pc" href="http://www.hankcs.com/ml/principal-component-analysis-k-means-cs229.html#respond">评论(4)</a></span>				<span class="item"></span>
			</div>
		</header>
		<article class="article-content">
			<div class="asb asb-post asb-post-01"><script async="" src="./CS229编程7：K-means聚类与主成分分析-码农场_files/f(8).txt"></script>
<!-- 文章页 - 页面标题下 728 90 -->
<ins class="adsbygoogle" style="display:inline-block;width:728px;height:90px" data-ad-client="ca-pub-1152644711996772" data-ad-slot="5413029241" data-adsbygoogle-status="done"><ins id="aswift_0_expand" style="display:inline-table;border:none;height:90px;margin:0;padding:0;position:relative;visibility:visible;width:728px;background-color:transparent;"><ins id="aswift_0_anchor" style="display:block;border:none;height:90px;margin:0;padding:0;position:relative;visibility:visible;width:728px;background-color:transparent;"><iframe width="728" height="90" frameborder="0" marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no" allowfullscreen="true" onload="var i=this.id,s=window.google_iframe_oncopy,H=s&amp;&amp;s.handlers,h=H&amp;&amp;H[i],w=this.contentWindow,d;try{d=w.document}catch(e){}if(h&amp;&amp;d&amp;&amp;(!d.body||!d.body.firstChild)){if(h.call){setTimeout(h,0)}else if(h.match){try{h=s.upd(h,i)}catch(e){}w.location.replace(h)}}" id="aswift_0" name="aswift_0" style="left:0;position:absolute;top:0;width:728px;height:90px;" src="./CS229编程7：K-means聚类与主成分分析-码农场_files/saved_resource(15).html"></iframe></ins></ins></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></div>			<div class="post_nav" style="width: 0px;"><div class="post_nav_side" style="height: 100%;"><div class="post_nav_top"><p>目录</p></div><div class="post_nav_bottom"></div><span class="post_nav_close icon-remove" title="关闭目录" style="opacity: 0; display: none;"><i class="fa fa-times"></i></span></div><ul class="post_nav_content"><li class="h2_nav"><a href="http://www.hankcs.com/ml/principal-component-analysis-k-means-cs229.html#h2-0">K-means聚类</a><i class="post_nav_dot"></i></li>
<li class="h3_nav"><a href="http://www.hankcs.com/ml/principal-component-analysis-k-means-cs229.html#h3-1">随机初始化</a><i class="post_nav_dot"></i></li>
<li class="h3_nav"><a href="http://www.hankcs.com/ml/principal-component-analysis-k-means-cs229.html#h3-2">寻找最近重心</a><i class="post_nav_dot"></i></li>
<li class="h3_nav"><a href="http://www.hankcs.com/ml/principal-component-analysis-k-means-cs229.html#h3-3">计算重心</a><i class="post_nav_dot"></i></li>
<li class="h3_nav"><a href="http://www.hankcs.com/ml/principal-component-analysis-k-means-cs229.html#h3-4">运行K-means</a><i class="post_nav_dot"></i></li>
<li class="h2_nav"><a href="http://www.hankcs.com/ml/principal-component-analysis-k-means-cs229.html#h2-5">图像压缩</a><i class="post_nav_dot"></i></li>
<li class="h2_nav"><a href="http://www.hankcs.com/ml/principal-component-analysis-k-means-cs229.html#h2-6">主成分分析</a><i class="post_nav_dot"></i></li>
<li class="h3_nav"><a href="http://www.hankcs.com/ml/principal-component-analysis-k-means-cs229.html#h3-7">简单数据集</a><i class="post_nav_dot"></i></li>
<li class="h3_nav"><a href="http://www.hankcs.com/ml/principal-component-analysis-k-means-cs229.html#h3-8">实现PCA</a><i class="post_nav_dot"></i></li>
<li class="h3_nav"><a href="http://www.hankcs.com/ml/principal-component-analysis-k-means-cs229.html#h3-9">数据标准化</a><i class="post_nav_dot"></i></li>
<li class="h3_nav"><a href="http://www.hankcs.com/ml/principal-component-analysis-k-means-cs229.html#h3-10">实现</a><i class="post_nav_dot"></i></li>
<li class="h3_nav"><a href="http://www.hankcs.com/ml/principal-component-analysis-k-means-cs229.html#h3-11">PCA降维</a><i class="post_nav_dot"></i></li>
<li class="h3_nav"><a href="http://www.hankcs.com/ml/principal-component-analysis-k-means-cs229.html#h3-12">还原数据</a><i class="post_nav_dot"></i></li>
<li class="h2_nav"><a href="http://www.hankcs.com/ml/principal-component-analysis-k-means-cs229.html#h2-13">人脸数据集</a><i class="post_nav_dot"></i></li>
<li class="h3_nav"><a href="http://www.hankcs.com/ml/principal-component-analysis-k-means-cs229.html#h3-14">主成分分析</a><i class="post_nav_dot"></i></li>
<li class="h3_nav"><a href="http://www.hankcs.com/ml/principal-component-analysis-k-means-cs229.html#h3-15">降维与还原</a><i class="post_nav_dot"></i></li>
<li class="h2_nav"><a href="http://www.hankcs.com/ml/principal-component-analysis-k-means-cs229.html#h2-16">为了可视化进行的PCA</a><i class="post_nav_dot"></i></li>
<li class="h3_nav"><a href="http://www.hankcs.com/ml/principal-component-analysis-k-means-cs229.html#h3-17">PCA降维</a><i class="post_nav_dot"></i></li>
</ul></div><p style="text-indent: 2em;"><span style="text-indent: 32px;"><img src="./CS229编程7：K-means聚类与主成分分析-码农场_files/6cbb8645gw1f9mhg8asw2g20v40ncgqw.gif" title="ex.gif" alt="ex.gif" style="text-align: center; white-space: normal; width: 0px; height: 0px;" width="0" height="0" border="0" vspace="0" data-tag="bdshare">斯坦<img src="./CS229编程7：K-means聚类与主成分分析-码农场_files/6cbb8645gw1f9mhhls29ag20o40j1tc1.gif" title="ex 2.gif" alt="ex 2.gif" style="text-align: center; white-space: normal; width: 0px; height: 0px;" width="0" height="0" border="0" vspace="0" data-tag="bdshare"><img src="./CS229编程7：K-means聚类与主成分分析-码农场_files/6cbb8645gw1f9mqo4t80kg20v40ncqvc.gif" style="text-align: center; white-space: normal; width: 0px; height: 0px;" width="0" height="0" border="0" vspace="0" title="" alt="" data-tag="bdshare"><img src="./CS229编程7：K-means聚类与主成分分析-码农场_files/6cbb8645gw1f9mlm741x3j20v40nc0zv.jpg" title="compress.png" alt="compress.png" style="text-align: center; white-space: normal; width: 0px; height: 0px;" width="0" height="0" border="0" vspace="0" data-tag="bdshare"><img src="./CS229编程7：K-means聚类与主成分分析-码农场_files/6cbb8645gw1f9mpxyjd4pj20v40nc403.jpg" title="还原.png" alt="还原.png" style="text-align: center; white-space: normal; width: 0px; height: 0px;" width="0" height="0" border="0" vspace="0" data-tag="bdshare"><img src="./CS229编程7：K-means聚类与主成分分析-码农场_files/6cbb8645gw1f9mq23e6srj20v40ncgra.jpg" title="face.png" alt="face.png" style="text-align: center; white-space: normal; width: 0px; height: 0px;" width="0" height="0" border="0" vspace="0" data-tag="bdshare"><img src="./CS229编程7：K-means聚类与主成分分析-码农场_files/6cbb8645gw1f9mq63pxn8j20v40ncjvh.jpg" title="人脸主成分.png" alt="人脸主成分.png" style="text-align: center; white-space: normal; width: 0px; height: 0px;" width="0" height="0" border="0" vspace="0" data-tag="bdshare"><img src="./CS229编程7：K-means聚类与主成分分析-码农场_files/6cbb8645gw1f9mq84y94sj20v40ncjvm.jpg" title="降维还原.png" alt="降维还原.png" style="text-align: center; white-space: normal; width: 0px; height: 0px;" width="0" height="0" border="0" vspace="0" data-tag="bdshare"><img src="./CS229编程7：K-means聚类与主成分分析-码农场_files/6cbb8645gw1f9mqnnvnjkj20v40nc79j.jpg" title="降维丑鸟.png" alt="降维丑鸟.png" style="text-align: center; white-space: normal; width: 0px; height: 0px;" width="0" height="0" border="0" vspace="0" data-tag="bdshare">福ML（</span><span style="text-indent: 32px; text-decoration: line-through;">Matlab</span><img src="./CS229编程7：K-means聚类与主成分分析-码农场_files/j_0064.gif" data-tag="bdshare"><span style="text-indent: 32px;">）公开课，</span>这次练习先实现K-means聚类算法并应用于图像压缩，然后实现PCA并用于人脸图像，最后展示高维数据的可视化技巧。我发现matlab做动画特别方便，顺手把算法执行过程动画化了。</p>
<h2 id="h2-0"><span style="text-indent: 32px;">K-means聚类</span></h2>
<p style="text-indent: 2em;"><span style="text-indent: 32px;">循序渐进，先在简单的2D数据上做实验：<br></span></p>
<p style="text-align:center"><span style="text-indent: 32px;"><img src="./CS229编程7：K-means聚类与主成分分析-码农场_files/6cbb8645gw1f9mgin84kvj20v40ncn0l.jpg" title="data-scatter.png" alt="data-scatter.png" data-tag="bdshare"></span></p>
<p style="text-indent: 2em;"><span style="text-indent: 32px;">先在上述2D数据集上熟悉<span style="text-indent: 32px;">K-means的原理，算法原理用matlab描述如下：</span></span></p>
<pre class="prettyprint lang-as3 linenums"><ol class="linenums"><li class="L0"><span class="pun">%</span><span class="pln">&nbsp;</span><span class="typ">Initialize</span><span class="pln">&nbsp;centroids					</span></li><li class="L1"><span class="pln">centroids&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;kMeansInitCentroids</span><span class="pun">(</span><span class="pln">X</span><span class="pun">,</span><span class="pln">&nbsp;K</span><span class="pun">);</span></li><li class="L2"><span class="pln">&nbsp;</span></li><li class="L3"><span class="kwd">for</span><span class="pln">&nbsp;iter&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;</span><span class="lit">1</span><span class="pun">:</span><span class="pln">iterations</span></li><li class="L4"><span class="pln">&nbsp;</span></li><li class="L5"><span class="pln">						</span></li><li class="L6"><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">%</span><span class="pln">&nbsp;</span><span class="typ">Cluster</span><span class="pln">&nbsp;assignment&nbsp;step</span><span class="pun">:</span><span class="pln">&nbsp;</span><span class="typ">Assign</span><span class="pln">&nbsp;each&nbsp;data&nbsp;point&nbsp;to&nbsp;the</span></li><li class="L7"><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">%</span><span class="pln">&nbsp;closest&nbsp;centroid</span><span class="pun">.</span><span class="pln">&nbsp;idx</span><span class="pun">(</span><span class="pln">i</span><span class="pun">)</span><span class="pln">&nbsp;corresponds&nbsp;to&nbsp;c</span><span class="pun">ˆ(</span><span class="pln">i</span><span class="pun">),</span><span class="pln">&nbsp;the&nbsp;index</span></li><li class="L8"><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">%</span><span class="pln">&nbsp;of&nbsp;the&nbsp;centroid&nbsp;assigned&nbsp;to&nbsp;example&nbsp;i&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li class="L9"><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;idx&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;findClosestCentroids</span><span class="pun">(</span><span class="pln">X</span><span class="pun">,</span><span class="pln">&nbsp;centroids</span><span class="pun">);</span></li><li class="L0"><span class="pln">&nbsp;</span></li><li class="L1"><span class="pln">						</span></li><li class="L2"><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">%</span><span class="pln">&nbsp;</span><span class="typ">Move</span><span class="pln">&nbsp;centroid&nbsp;step</span><span class="pun">:</span><span class="pln">&nbsp;</span><span class="typ">Compute</span><span class="pln">&nbsp;means&nbsp;based&nbsp;on&nbsp;centroid</span></li><li class="L3"><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">%</span><span class="pln">&nbsp;assignments&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li class="L4"><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;centroids&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;computeMeans</span><span class="pun">(</span><span class="pln">X</span><span class="pun">,</span><span class="pln">&nbsp;idx</span><span class="pun">,</span><span class="pln">&nbsp;K</span><span class="pun">);</span></li><li class="L5"><span class="pln">&nbsp;</span></li><li class="L6"><span class="pln">						</span></li><li class="L7"><span class="kwd">end</span></li></ol></pre>
<p style="text-indent: 2em;"><span style="text-indent: 32px;"><span style="text-indent: 32px;"></span></span>先选取K个重心，然后迭代：</p>
<ol class=" list-paddingleft-2" style="list-style-type: decimal;">
<li>
<p style="text-indent: 2em;">将每个数据点分配给最近的重心</p>
</li>
<li>
<p style="text-indent: 2em;">分配导致重心变化，于是重新计算重心</p>
</li>
</ol>
<p style="text-indent: 2em;"><span style="text-indent: 32px;">K-means最终一定会收敛，但视初始化的重心不同，最终得到的聚类结果不一定是最优的。所以实践的时候一般<span style="text-indent: 32px;">初始化</span>不同的重心，然后选择损失函数最小的聚类结果。</span></p>
<h3 id="h3-1">随机初始化<br></h3>
<p style="white-space: normal; text-indent: 2em;">实践中，一种初始化策略是随机选取K个数据点作为质心：</p>
<pre class="prettyprint lang-as3 linenums"><ol class="linenums"><li class="L0"><span class="kwd">function</span><span class="pln">&nbsp;centroids&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;kMeansInitCentroids</span><span class="pun">(</span><span class="pln">X</span><span class="pun">,</span><span class="pln">&nbsp;K</span><span class="pun">)</span></li><li class="L1"><span class="pun">%</span><span class="pln">KMEANSINITCENTROIDS&nbsp;</span><span class="typ">This</span><span class="pln">&nbsp;</span><span class="kwd">function</span><span class="pln">&nbsp;initializes&nbsp;K&nbsp;centroids&nbsp;that&nbsp;are&nbsp;to&nbsp;be&nbsp;</span></li><li class="L2"><span class="pun">%</span><span class="pln">used&nbsp;</span><span class="kwd">in</span><span class="pln">&nbsp;K</span><span class="pun">-</span><span class="typ">Means</span><span class="pln">&nbsp;on&nbsp;the&nbsp;dataset&nbsp;X</span></li><li class="L3"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;&nbsp;centroids&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;KMEANSINITCENTROIDS</span><span class="pun">(</span><span class="pln">X</span><span class="pun">,</span><span class="pln">&nbsp;K</span><span class="pun">)</span><span class="pln">&nbsp;returns&nbsp;K&nbsp;initial&nbsp;centroids&nbsp;to&nbsp;be</span></li><li class="L4"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;&nbsp;used&nbsp;</span><span class="kwd">with</span><span class="pln">&nbsp;the&nbsp;K</span><span class="pun">-</span><span class="typ">Means</span><span class="pln">&nbsp;on&nbsp;the&nbsp;dataset&nbsp;X</span></li><li class="L5"><span class="pun">%</span></li><li class="L6"><span class="pln">&nbsp;</span></li><li class="L7"><span class="pun">%</span><span class="pln">&nbsp;</span><span class="typ">You</span><span class="pln">&nbsp;should&nbsp;</span><span class="kwd">return</span><span class="pln">&nbsp;</span><span class="kwd">this</span><span class="pln">&nbsp;values&nbsp;correctly</span></li><li class="L8"><span class="pln">centroids&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;zeros</span><span class="pun">(</span><span class="pln">K</span><span class="pun">,</span><span class="pln">&nbsp;size</span><span class="pun">(</span><span class="pln">X</span><span class="pun">,</span><span class="pln">&nbsp;</span><span class="lit">2</span><span class="pun">));</span></li><li class="L9"><span class="pln">&nbsp;</span></li><li class="L0"><span class="pun">%</span><span class="pln">&nbsp;</span><span class="pun">======================</span><span class="pln">&nbsp;YOUR&nbsp;CODE&nbsp;HERE&nbsp;</span><span class="pun">======================</span></li><li class="L1"><span class="pun">%</span><span class="pln">&nbsp;</span><span class="typ">Instructions</span><span class="pun">:</span><span class="pln">&nbsp;</span><span class="typ">You</span><span class="pln">&nbsp;should&nbsp;</span><span class="kwd">set</span><span class="pln">&nbsp;centroids&nbsp;to&nbsp;randomly&nbsp;chosen&nbsp;examples&nbsp;</span><span class="kwd">from</span></li><li class="L2"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;dataset&nbsp;X</span></li><li class="L3"><span class="pun">%</span></li><li class="L4"><span class="pln">&nbsp;</span></li><li class="L5"><span class="pln">&nbsp;</span></li><li class="L6"><span class="pln">&nbsp;</span></li><li class="L7"><span class="pln">&nbsp;</span></li><li class="L8"><span class="pun">%</span><span class="pln">&nbsp;</span><span class="typ">Initialize</span><span class="pln">&nbsp;the&nbsp;centroids&nbsp;to&nbsp;be&nbsp;random&nbsp;examples</span></li><li class="L9"><span class="pun">%</span><span class="pln">&nbsp;</span><span class="typ">Randomly</span><span class="pln">&nbsp;reorder&nbsp;the&nbsp;indices&nbsp;of&nbsp;examples</span></li><li class="L0"><span class="pln">randidx&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;randperm</span><span class="pun">(</span><span class="pln">size</span><span class="pun">(</span><span class="pln">X</span><span class="pun">,</span><span class="pln">&nbsp;</span><span class="lit">1</span><span class="pun">));</span></li><li class="L1"><span class="pun">%</span><span class="pln">&nbsp;</span><span class="typ">Take</span><span class="pln">&nbsp;the&nbsp;first&nbsp;K&nbsp;examples&nbsp;</span><span class="kwd">as</span><span class="pln">&nbsp;centroids</span></li><li class="L2"><span class="pln">centroids&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;X</span><span class="pun">(</span><span class="pln">randidx</span><span class="pun">(</span><span class="lit">1</span><span class="pun">:</span><span class="pln">K</span><span class="pun">),</span><span class="pln">&nbsp;</span><span class="pun">:);</span></li><li class="L3"><span class="pln">&nbsp;</span></li><li class="L4"><span class="pln">&nbsp;</span></li><li class="L5"><span class="pln">&nbsp;</span></li><li class="L6"><span class="pln">&nbsp;</span></li><li class="L7"><span class="pln">&nbsp;</span></li><li class="L8"><span class="pln">&nbsp;</span></li><li class="L9"><span class="pun">%</span><span class="pln">&nbsp;</span><span class="pun">=============================================================</span></li><li class="L0"><span class="pln">&nbsp;</span></li><li class="L1"><span class="kwd">end</span></li></ol></pre>
<h3 id="h3-2"><span style="text-indent: 32px;">寻找最近重心<br></span></h3>
<p style="text-indent: 2em;"><span style="text-indent: 32px;">对每个点，找到重心j使得<br></span></p>
<p style="text-align:center"><span style="text-indent: 32px;"><img src="./CS229编程7：K-means聚类与主成分分析-码农场_files/6cbb8645gw1f9mgcrnhtgj20hu024dg1.jpg" title="hankcs.com 2016-11-09 下午1.11.31.png" alt="hankcs.com 2016-11-09 下午1.11.31.png" width="305" height="36" border="0" vspace="0" style="width: 305px; height: 36px;" data-tag="bdshare"></span></p>
<p style="text-indent: 2em;"><span style="text-indent: 32px;">也就是欧氏距离最小。</span></p>
<p style="text-indent: 2em;"><span style="text-indent: 32px;">其实现如下：<br></span></p>
<pre class="prettyprint lang-as3 linenums"><ol class="linenums"><li class="L0"><span class="kwd">function</span><span class="pln">&nbsp;idx&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;findClosestCentroids</span><span class="pun">(</span><span class="pln">X</span><span class="pun">,</span><span class="pln">&nbsp;centroids</span><span class="pun">)</span></li><li class="L1"><span class="pun">%</span><span class="pln">FINDCLOSESTCENTROIDS&nbsp;computes&nbsp;the&nbsp;centroid&nbsp;memberships&nbsp;</span><span class="kwd">for</span><span class="pln">&nbsp;every&nbsp;example</span></li><li class="L2"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;&nbsp;idx&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;FINDCLOSESTCENTROIDS&nbsp;</span><span class="pun">(</span><span class="pln">X</span><span class="pun">,</span><span class="pln">&nbsp;centroids</span><span class="pun">)</span><span class="pln">&nbsp;returns&nbsp;the&nbsp;closest&nbsp;centroids</span></li><li class="L3"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;&nbsp;</span><span class="kwd">in</span><span class="pln">&nbsp;idx&nbsp;</span><span class="kwd">for</span><span class="pln">&nbsp;a&nbsp;dataset&nbsp;X&nbsp;</span><span class="kwd">where</span><span class="pln">&nbsp;each&nbsp;row&nbsp;</span><span class="kwd">is</span><span class="pln">&nbsp;a&nbsp;single&nbsp;example</span><span class="pun">.</span><span class="pln">&nbsp;idx&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;m&nbsp;x&nbsp;</span><span class="lit">1</span><span class="pln">&nbsp;</span></li><li class="L4"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;&nbsp;vector&nbsp;of&nbsp;centroid&nbsp;assignments&nbsp;</span><span class="pun">(</span><span class="pln">i</span><span class="pun">.</span><span class="pln">e</span><span class="pun">.</span><span class="pln">&nbsp;each&nbsp;entry&nbsp;</span><span class="kwd">in</span><span class="pln">&nbsp;range&nbsp;</span><span class="pun">[</span><span class="lit">1.</span><span class="pun">.</span><span class="pln">K</span><span class="pun">])</span></li><li class="L5"><span class="pun">%</span></li><li class="L6"><span class="pln">&nbsp;</span></li><li class="L7"><span class="pun">%</span><span class="pln">&nbsp;</span><span class="typ">Set</span><span class="pln">&nbsp;K</span></li><li class="L8"><span class="pln">K&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;size</span><span class="pun">(</span><span class="pln">centroids</span><span class="pun">,</span><span class="pln">&nbsp;</span><span class="lit">1</span><span class="pun">);</span></li><li class="L9"><span class="pln">&nbsp;</span></li><li class="L0"><span class="pun">%</span><span class="pln">&nbsp;</span><span class="typ">You</span><span class="pln">&nbsp;need&nbsp;to&nbsp;</span><span class="kwd">return</span><span class="pln">&nbsp;the&nbsp;following&nbsp;variables&nbsp;correctly</span><span class="pun">.</span></li><li class="L1"><span class="pln">idx&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;zeros</span><span class="pun">(</span><span class="pln">size</span><span class="pun">(</span><span class="pln">X</span><span class="pun">,</span><span class="lit">1</span><span class="pun">),</span><span class="pln">&nbsp;</span><span class="lit">1</span><span class="pun">);</span></li><li class="L2"><span class="pln">&nbsp;</span></li><li class="L3"><span class="pun">%</span><span class="pln">&nbsp;</span><span class="pun">======================</span><span class="pln">&nbsp;YOUR&nbsp;CODE&nbsp;HERE&nbsp;</span><span class="pun">======================</span></li><li class="L4"><span class="pun">%</span><span class="pln">&nbsp;</span><span class="typ">Instructions</span><span class="pun">:</span><span class="pln">&nbsp;</span><span class="typ">Go</span><span class="pln">&nbsp;over&nbsp;every&nbsp;example</span><span class="pun">,</span><span class="pln">&nbsp;find&nbsp;its&nbsp;closest&nbsp;centroid</span><span class="pun">,</span><span class="pln">&nbsp;</span><span class="kwd">and</span><span class="pln">&nbsp;store</span></li><li class="L5"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;index&nbsp;inside&nbsp;idx&nbsp;at&nbsp;the&nbsp;appropriate&nbsp;location</span><span class="pun">.</span></li><li class="L6"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="typ">Concretely</span><span class="pun">,</span><span class="pln">&nbsp;idx</span><span class="pun">(</span><span class="pln">i</span><span class="pun">)</span><span class="pln">&nbsp;should&nbsp;contain&nbsp;the&nbsp;index&nbsp;of&nbsp;the&nbsp;centroid</span></li><li class="L7"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;closest&nbsp;to&nbsp;example&nbsp;i</span><span class="pun">.</span><span class="pln">&nbsp;</span><span class="typ">Hence</span><span class="pun">,</span><span class="pln">&nbsp;it&nbsp;should&nbsp;be&nbsp;a&nbsp;value&nbsp;</span><span class="kwd">in</span><span class="pln">&nbsp;the&nbsp;</span></li><li class="L8"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;range&nbsp;</span><span class="lit">1.</span><span class="pun">.</span><span class="pln">K</span></li><li class="L9"><span class="pun">%</span></li><li class="L0"><span class="pun">%</span><span class="pln">&nbsp;</span><span class="typ">Note</span><span class="pun">:</span><span class="pln">&nbsp;</span><span class="typ">You</span><span class="pln">&nbsp;can&nbsp;</span><span class="kwd">use</span><span class="pln">&nbsp;a&nbsp;</span><span class="kwd">for</span><span class="pun">-</span><span class="pln">loop&nbsp;over&nbsp;the&nbsp;examples&nbsp;to&nbsp;compute&nbsp;</span><span class="kwd">this</span><span class="pun">.</span></li><li class="L1"><span class="pun">%</span></li><li class="L2"><span class="kwd">for</span><span class="pln">&nbsp;i&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;</span><span class="lit">1</span><span class="pun">:</span><span class="pln">size</span><span class="pun">(</span><span class="pln">X</span><span class="pun">,</span><span class="lit">1</span><span class="pun">)</span></li><li class="L3"><span class="pln">&nbsp;&nbsp;&nbsp;means&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;</span><span class="lit">0</span><span class="pun">;</span></li><li class="L4"><span class="pln">&nbsp;&nbsp;&nbsp;</span><span class="kwd">for</span><span class="pln">&nbsp;k&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;</span><span class="lit">1</span><span class="pun">:</span><span class="pln">size</span><span class="pun">(</span><span class="pln">X</span><span class="pun">,</span><span class="lit">2</span><span class="pun">)</span></li><li class="L5"><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;means&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;means&nbsp;</span><span class="pun">+</span><span class="pln">&nbsp;</span><span class="pun">(</span><span class="pln">X</span><span class="pun">(</span><span class="pln">i</span><span class="pun">,</span><span class="pln">k</span><span class="pun">)</span><span class="pln">&nbsp;</span><span class="pun">-</span><span class="pln">&nbsp;centroids</span><span class="pun">(</span><span class="lit">1</span><span class="pun">,</span><span class="pln">k</span><span class="pun">))^</span><span class="lit">2</span><span class="pun">;</span></li><li class="L6"><span class="pln">&nbsp;&nbsp;&nbsp;</span><span class="kwd">end</span></li><li class="L7"><span class="pln">&nbsp;&nbsp;&nbsp;id&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;</span><span class="lit">1</span><span class="pun">;</span></li><li class="L8"><span class="pln">&nbsp;&nbsp;&nbsp;</span><span class="kwd">for</span><span class="pln">&nbsp;j&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;</span><span class="lit">2</span><span class="pun">:</span><span class="pln">&nbsp;K</span></li><li class="L9"><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;temp&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;</span><span class="lit">0</span><span class="pun">;</span></li><li class="L0"><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">for</span><span class="pln">&nbsp;k&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;</span><span class="lit">1</span><span class="pun">:</span><span class="pln">size</span><span class="pun">(</span><span class="pln">X</span><span class="pun">,</span><span class="lit">2</span><span class="pun">)</span></li><li class="L1"><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;temp&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;temp&nbsp;</span><span class="pun">+</span><span class="pln">&nbsp;</span><span class="pun">(</span><span class="pln">X</span><span class="pun">(</span><span class="pln">i</span><span class="pun">,</span><span class="pln">k</span><span class="pun">)</span><span class="pln">&nbsp;</span><span class="pun">-</span><span class="pln">&nbsp;centroids</span><span class="pun">(</span><span class="pln">j</span><span class="pun">,</span><span class="pln">k</span><span class="pun">))^</span><span class="lit">2</span><span class="pun">;</span></li><li class="L2"><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">end</span></li><li class="L3"><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln">&nbsp;temp&nbsp;</span><span class="pun">&lt;=</span><span class="pln">&nbsp;means</span></li><li class="L4"><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;means&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;temp</span><span class="pun">;</span></li><li class="L5"><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;id&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;j</span><span class="pun">;</span></li><li class="L6"><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">end</span></li><li class="L7"><span class="pln">&nbsp;&nbsp;&nbsp;</span><span class="kwd">end</span></li><li class="L8"><span class="pln">&nbsp;&nbsp;&nbsp;idx</span><span class="pun">(</span><span class="pln">i</span><span class="pun">)</span><span class="pln">&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;id</span><span class="pun">;</span></li><li class="L9"><span class="kwd">end</span></li><li class="L0"><span class="pln">&nbsp;</span></li><li class="L1"><span class="pln">&nbsp;</span></li><li class="L2"><span class="pln">&nbsp;</span></li><li class="L3"><span class="pln">&nbsp;</span></li><li class="L4"><span class="pln">&nbsp;</span></li><li class="L5"><span class="pln">&nbsp;</span></li><li class="L6"><span class="pln">&nbsp;</span></li><li class="L7"><span class="pun">%</span><span class="pln">&nbsp;</span><span class="pun">=============================================================</span></li><li class="L8"><span class="pln">&nbsp;</span></li><li class="L9"><span class="kwd">end</span></li></ol></pre>
<p style="text-indent: 2em;"><span style="text-indent: 32px;"></span>上述代码可以应用于任意维度的数据，下面这段就是在计算任意维度空间两点间的欧氏距离，也许写成函数更好</p>
<pre class="prettyprint lang-as3 linenums"><ol class="linenums"><li class="L0"><span class="pln">&nbsp;&nbsp;&nbsp;</span><span class="kwd">for</span><span class="pln">&nbsp;k&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;</span><span class="lit">1</span><span class="pun">:</span><span class="pln">size</span><span class="pun">(</span><span class="pln">X</span><span class="pun">,</span><span class="lit">2</span><span class="pun">)</span></li><li class="L1"><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;means&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;means&nbsp;</span><span class="pun">+</span><span class="pln">&nbsp;</span><span class="pun">(</span><span class="pln">X</span><span class="pun">(</span><span class="pln">i</span><span class="pun">,</span><span class="pln">k</span><span class="pun">)</span><span class="pln">&nbsp;</span><span class="pun">-</span><span class="pln">&nbsp;centroids</span><span class="pun">(</span><span class="lit">1</span><span class="pun">,</span><span class="pln">k</span><span class="pun">))^</span><span class="lit">2</span><span class="pun">;</span></li><li class="L2"><span class="pln">&nbsp;&nbsp;&nbsp;</span><span class="kwd">end</span></li></ol></pre>
<p style="text-indent: 2em;">调用方法如下：</p>
<pre class="prettyprint lang-as3 linenums"><ol class="linenums"><li class="L0"><span class="pun">%%</span><span class="pln">&nbsp;</span><span class="pun">=================</span><span class="pln">&nbsp;</span><span class="typ">Part</span><span class="pln">&nbsp;</span><span class="lit">1</span><span class="pun">:</span><span class="pln">&nbsp;</span><span class="typ">Find</span><span class="pln">&nbsp;</span><span class="typ">Closest</span><span class="pln">&nbsp;</span><span class="typ">Centroids</span><span class="pln">&nbsp;</span><span class="pun">====================</span></li><li class="L1"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;</span><span class="typ">To</span><span class="pln">&nbsp;help&nbsp;you&nbsp;implement&nbsp;K</span><span class="pun">-</span><span class="typ">Means</span><span class="pun">,</span><span class="pln">&nbsp;we&nbsp;have&nbsp;divided&nbsp;the&nbsp;learning&nbsp;algorithm&nbsp;</span></li><li class="L2"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;</span><span class="kwd">into</span><span class="pln">&nbsp;two&nbsp;functions&nbsp;</span><span class="pun">--</span><span class="pln">&nbsp;findClosestCentroids&nbsp;</span><span class="kwd">and</span><span class="pln">&nbsp;computeCentroids</span><span class="pun">.</span><span class="pln">&nbsp;</span><span class="typ">In</span><span class="pln">&nbsp;</span><span class="kwd">this</span></li><li class="L3"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;part</span><span class="pun">,</span><span class="pln">&nbsp;you&nbsp;shoudl&nbsp;complete&nbsp;the&nbsp;code&nbsp;</span><span class="kwd">in</span><span class="pln">&nbsp;the&nbsp;findClosestCentroids&nbsp;</span><span class="kwd">function</span><span class="pun">.</span><span class="pln">&nbsp;</span></li><li class="L4"><span class="pun">%</span></li><li class="L5"><span class="pln">fprintf</span><span class="pun">(</span><span class="str">'Finding&nbsp;closest&nbsp;centroids.\n\n'</span><span class="pun">);</span></li><li class="L6"><span class="pln">&nbsp;</span></li><li class="L7"><span class="pun">%</span><span class="pln">&nbsp;</span><span class="typ">Load</span><span class="pln">&nbsp;an&nbsp;example&nbsp;dataset&nbsp;that&nbsp;we&nbsp;will&nbsp;be&nbsp;</span><span class="kwd">using</span></li><li class="L8"><span class="pln">load</span><span class="pun">(</span><span class="str">'ex7data2.mat'</span><span class="pun">);</span></li><li class="L9"><span class="pln">&nbsp;</span></li><li class="L0"><span class="pun">%</span><span class="pln">&nbsp;</span><span class="typ">Select</span><span class="pln">&nbsp;an&nbsp;initial&nbsp;</span><span class="kwd">set</span><span class="pln">&nbsp;of&nbsp;centroids</span></li><li class="L1"><span class="pln">K&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;</span><span class="lit">3</span><span class="pun">;</span><span class="pln">&nbsp;</span><span class="pun">%</span><span class="pln">&nbsp;</span><span class="lit">3</span><span class="pln">&nbsp;</span><span class="typ">Centroids</span></li><li class="L2"><span class="pln">initial_centroids&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;</span><span class="pun">[</span><span class="lit">3</span><span class="pln">&nbsp;</span><span class="lit">3</span><span class="pun">;</span><span class="pln">&nbsp;</span><span class="lit">6</span><span class="pln">&nbsp;</span><span class="lit">2</span><span class="pun">;</span><span class="pln">&nbsp;</span><span class="lit">8</span><span class="pln">&nbsp;</span><span class="lit">5</span><span class="pun">];</span></li><li class="L3"><span class="pln">&nbsp;</span></li><li class="L4"><span class="pun">%</span><span class="pln">&nbsp;</span><span class="typ">Find</span><span class="pln">&nbsp;the&nbsp;closest&nbsp;centroids&nbsp;</span><span class="kwd">for</span><span class="pln">&nbsp;the&nbsp;examples&nbsp;</span><span class="kwd">using</span><span class="pln">&nbsp;the</span></li><li class="L5"><span class="pun">%</span><span class="pln">&nbsp;initial_centroids</span></li><li class="L6"><span class="pln">idx&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;findClosestCentroids</span><span class="pun">(</span><span class="pln">X</span><span class="pun">,</span><span class="pln">&nbsp;initial_centroids</span><span class="pun">);</span></li><li class="L7"><span class="pln">&nbsp;</span></li><li class="L8"><span class="pln">fprintf</span><span class="pun">(</span><span class="str">'Closest&nbsp;centroids&nbsp;for&nbsp;the&nbsp;first&nbsp;3&nbsp;examples:&nbsp;\n'</span><span class="pun">)</span></li><li class="L9"><span class="pln">fprintf</span><span class="pun">(</span><span class="str">'&nbsp;%d'</span><span class="pun">,</span><span class="pln">&nbsp;idx</span><span class="pun">(</span><span class="lit">1</span><span class="pun">:</span><span class="lit">3</span><span class="pun">));</span></li><li class="L0"><span class="pln">fprintf</span><span class="pun">(</span><span class="str">'\n(the&nbsp;closest&nbsp;centroids&nbsp;should&nbsp;be&nbsp;1,&nbsp;3,&nbsp;2&nbsp;respectively)\n'</span><span class="pun">);</span></li><li class="L1"><span class="pln">&nbsp;</span></li><li class="L2"><span class="pln">fprintf</span><span class="pun">(</span><span class="str">'Program&nbsp;paused.&nbsp;Press&nbsp;enter&nbsp;to&nbsp;continue.\n'</span><span class="pun">);</span></li><li class="L3"><span class="pln">pause</span><span class="pun">;</span></li></ol></pre>
<h3 id="h3-3">计算重心<br></h3>
<p style="text-indent: 2em;">第k个团的重心计算方法如下：</p>
<p style="text-align:center"><img src="./CS229编程7：K-means聚类与主成分分析-码农场_files/6cbb8645gw1f9mgo06fmej209i03i74c.jpg" title="hankcs.com 2016-11-09 下午1.22.26.png" alt="hankcs.com 2016-11-09 下午1.22.26.png" width="152" height="56" border="0" vspace="0" style="width: 152px; height: 56px;" data-tag="bdshare"></p>
<p style="text-indent: 2em;">实现如下：</p>
<pre class="prettyprint lang-as3 linenums"><ol class="linenums"><li class="L0"><span class="kwd">function</span><span class="pln">&nbsp;centroids&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;computeCentroids</span><span class="pun">(</span><span class="pln">X</span><span class="pun">,</span><span class="pln">&nbsp;idx</span><span class="pun">,</span><span class="pln">&nbsp;K</span><span class="pun">)</span></li><li class="L1"><span class="pun">%</span><span class="pln">COMPUTECENTROIDS&nbsp;returs&nbsp;the&nbsp;</span><span class="kwd">new</span><span class="pln">&nbsp;centroids&nbsp;</span><span class="kwd">by</span><span class="pln">&nbsp;computing&nbsp;the&nbsp;means&nbsp;of&nbsp;the&nbsp;</span></li><li class="L2"><span class="pun">%</span><span class="pln">data&nbsp;points&nbsp;assigned&nbsp;to&nbsp;each&nbsp;centroid</span><span class="pun">.</span></li><li class="L3"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;&nbsp;centroids&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;COMPUTECENTROIDS</span><span class="pun">(</span><span class="pln">X</span><span class="pun">,</span><span class="pln">&nbsp;idx</span><span class="pun">,</span><span class="pln">&nbsp;K</span><span class="pun">)</span><span class="pln">&nbsp;returns&nbsp;the&nbsp;</span><span class="kwd">new</span><span class="pln">&nbsp;centroids&nbsp;</span><span class="kwd">by</span><span class="pln">&nbsp;</span></li><li class="L4"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;&nbsp;computing&nbsp;the&nbsp;means&nbsp;of&nbsp;the&nbsp;data&nbsp;points&nbsp;assigned&nbsp;to&nbsp;each&nbsp;centroid</span><span class="pun">.</span><span class="pln">&nbsp;</span><span class="typ">It</span><span class="pln">&nbsp;</span><span class="kwd">is</span></li><li class="L5"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;&nbsp;given&nbsp;a&nbsp;dataset&nbsp;X&nbsp;</span><span class="kwd">where</span><span class="pln">&nbsp;each&nbsp;row&nbsp;</span><span class="kwd">is</span><span class="pln">&nbsp;a&nbsp;single&nbsp;data&nbsp;point</span><span class="pun">,</span><span class="pln">&nbsp;a&nbsp;vector</span></li><li class="L6"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;&nbsp;idx&nbsp;of&nbsp;centroid&nbsp;assignments&nbsp;</span><span class="pun">(</span><span class="pln">i</span><span class="pun">.</span><span class="pln">e</span><span class="pun">.</span><span class="pln">&nbsp;each&nbsp;entry&nbsp;</span><span class="kwd">in</span><span class="pln">&nbsp;range&nbsp;</span><span class="pun">[</span><span class="lit">1.</span><span class="pun">.</span><span class="pln">K</span><span class="pun">])</span><span class="pln">&nbsp;</span><span class="kwd">for</span><span class="pln">&nbsp;each</span></li><li class="L7"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;&nbsp;example</span><span class="pun">,</span><span class="pln">&nbsp;</span><span class="kwd">and</span><span class="pln">&nbsp;K</span><span class="pun">,</span><span class="pln">&nbsp;the&nbsp;number&nbsp;of&nbsp;centroids</span><span class="pun">.</span><span class="pln">&nbsp;</span><span class="typ">You</span><span class="pln">&nbsp;should&nbsp;</span><span class="kwd">return</span><span class="pln">&nbsp;a&nbsp;matrix</span></li><li class="L8"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;&nbsp;centroids</span><span class="pun">,</span><span class="pln">&nbsp;</span><span class="kwd">where</span><span class="pln">&nbsp;each&nbsp;row&nbsp;of&nbsp;centroids&nbsp;</span><span class="kwd">is</span><span class="pln">&nbsp;the&nbsp;mean&nbsp;of&nbsp;the&nbsp;data&nbsp;points</span></li><li class="L9"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;&nbsp;assigned&nbsp;to&nbsp;it</span><span class="pun">.</span></li><li class="L0"><span class="pun">%</span></li><li class="L1"><span class="pln">&nbsp;</span></li><li class="L2"><span class="pun">%</span><span class="pln">&nbsp;</span><span class="typ">Useful</span><span class="pln">&nbsp;variables</span></li><li class="L3"><span class="pun">[</span><span class="pln">m&nbsp;n</span><span class="pun">]</span><span class="pln">&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;size</span><span class="pun">(</span><span class="pln">X</span><span class="pun">);</span></li><li class="L4"><span class="pln">&nbsp;</span></li><li class="L5"><span class="pun">%</span><span class="pln">&nbsp;</span><span class="typ">You</span><span class="pln">&nbsp;need&nbsp;to&nbsp;</span><span class="kwd">return</span><span class="pln">&nbsp;the&nbsp;following&nbsp;variables&nbsp;correctly</span><span class="pun">.</span></li><li class="L6"><span class="pln">centroids&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;zeros</span><span class="pun">(</span><span class="pln">K</span><span class="pun">,</span><span class="pln">&nbsp;n</span><span class="pun">);</span></li><li class="L7"><span class="pln">&nbsp;</span></li><li class="L8"><span class="pln">&nbsp;</span></li><li class="L9"><span class="pun">%</span><span class="pln">&nbsp;</span><span class="pun">======================</span><span class="pln">&nbsp;YOUR&nbsp;CODE&nbsp;HERE&nbsp;</span><span class="pun">======================</span></li><li class="L0"><span class="pun">%</span><span class="pln">&nbsp;</span><span class="typ">Instructions</span><span class="pun">:</span><span class="pln">&nbsp;</span><span class="typ">Go</span><span class="pln">&nbsp;over&nbsp;every&nbsp;centroid&nbsp;</span><span class="kwd">and</span><span class="pln">&nbsp;compute&nbsp;mean&nbsp;of&nbsp;all&nbsp;points&nbsp;that</span></li><li class="L1"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;belong&nbsp;to&nbsp;it</span><span class="pun">.</span><span class="pln">&nbsp;</span><span class="typ">Concretely</span><span class="pun">,</span><span class="pln">&nbsp;the&nbsp;row&nbsp;vector&nbsp;centroids</span><span class="pun">(</span><span class="pln">i</span><span class="pun">,</span><span class="pln">&nbsp;</span><img draggable="false" class="emoji" alt="🙂" src="./CS229编程7：K-means聚类与主成分分析-码农场_files/1f642.svg" data-tag="bdshare"></li><li class="L2"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;should&nbsp;contain&nbsp;the&nbsp;mean&nbsp;of&nbsp;the&nbsp;data&nbsp;points&nbsp;assigned&nbsp;to</span></li><li class="L3"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;centroid&nbsp;i</span><span class="pun">.</span></li><li class="L4"><span class="pun">%</span></li><li class="L5"><span class="pun">%</span><span class="pln">&nbsp;</span><span class="typ">Note</span><span class="pun">:</span><span class="pln">&nbsp;</span><span class="typ">You</span><span class="pln">&nbsp;can&nbsp;</span><span class="kwd">use</span><span class="pln">&nbsp;a&nbsp;</span><span class="kwd">for</span><span class="pun">-</span><span class="pln">loop&nbsp;over&nbsp;the&nbsp;centroids&nbsp;to&nbsp;compute&nbsp;</span><span class="kwd">this</span><span class="pun">.</span></li><li class="L6"><span class="pun">%</span></li><li class="L7"><span class="pln">&nbsp;</span></li><li class="L8"><span class="pln">&nbsp;</span></li><li class="L9"><span class="kwd">for</span><span class="pln">&nbsp;i&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;</span><span class="lit">1</span><span class="pun">:</span><span class="pln">K</span></li><li class="L0"><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="typ">Ck</span><span class="pln">&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;</span><span class="lit">0</span><span class="pun">;</span></li><li class="L1"><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">for</span><span class="pln">&nbsp;j&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;</span><span class="lit">1</span><span class="pun">:</span><span class="pln">m</span></li><li class="L2"><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln">&nbsp;idx</span><span class="pun">(</span><span class="pln">j</span><span class="pun">)</span><span class="pln">&nbsp;</span><span class="pun">==</span><span class="pln">&nbsp;i</span><span class="pun">;</span></li><li class="L3"><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="typ">Ck</span><span class="pln">&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;</span><span class="typ">Ck</span><span class="pln">&nbsp;</span><span class="pun">+</span><span class="pln">&nbsp;</span><span class="lit">1</span><span class="pun">;</span></li><li class="L4"><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">for</span><span class="pln">&nbsp;k&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;</span><span class="lit">1</span><span class="pun">:</span><span class="pln">n</span></li><li class="L5"><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;centroids</span><span class="pun">(</span><span class="pln">i</span><span class="pun">,</span><span class="pln">k</span><span class="pun">)</span><span class="pln">&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;centroids</span><span class="pun">(</span><span class="pln">i</span><span class="pun">,</span><span class="pln">k</span><span class="pun">)</span><span class="pln">&nbsp;</span><span class="pun">+</span><span class="pln">&nbsp;X</span><span class="pun">(</span><span class="pln">j</span><span class="pun">,</span><span class="pln">k</span><span class="pun">);</span><span class="pln">&nbsp;</span></li><li class="L6"><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">end</span><span class="pln">&nbsp;</span></li><li class="L7"><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">end</span></li><li class="L8"><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">end</span></li><li class="L9"><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">for</span><span class="pln">&nbsp;k&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;</span><span class="lit">1</span><span class="pun">:</span><span class="pln">n</span></li><li class="L0"><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;centroids</span><span class="pun">(</span><span class="pln">i</span><span class="pun">,</span><span class="pln">k</span><span class="pun">)</span><span class="pln">&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;centroids</span><span class="pun">(</span><span class="pln">i</span><span class="pun">,</span><span class="pln">k</span><span class="pun">)</span><span class="pln">&nbsp;</span><span class="pun">/</span><span class="pln">&nbsp;</span><span class="typ">Ck</span><span class="pun">;</span></li><li class="L1"><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">end</span></li><li class="L2"><span class="kwd">end</span></li><li class="L3"><span class="pln">&nbsp;</span></li><li class="L4"><span class="pln">&nbsp;</span></li><li class="L5"><span class="pln">&nbsp;</span></li><li class="L6"><span class="pln">&nbsp;</span></li><li class="L7"><span class="pln">&nbsp;</span></li><li class="L8"><span class="pln">&nbsp;</span></li><li class="L9"><span class="pln">&nbsp;</span></li><li class="L0"><span class="pln">&nbsp;</span></li><li class="L1"><span class="pun">%</span><span class="pln">&nbsp;</span><span class="pun">=============================================================</span></li><li class="L2"><span class="pln">&nbsp;</span></li><li class="L3"><span class="pln">&nbsp;</span></li><li class="L4"><span class="kwd">end</span></li></ol></pre>
<h3 id="h3-4">运行<span style="text-indent: 32px;">K-means</span></h3>
<p style="text-indent: 2em;"><span style="text-indent: 32px;">将这两个步骤结合起来，就得到了可运行的<span style="text-indent: 32px;">K-means：</span></span></p>
<pre class="prettyprint lang-as3 linenums"><ol class="linenums"><li class="L0"><span class="kwd">function</span><span class="pln">&nbsp;</span><span class="pun">[</span><span class="pln">centroids</span><span class="pun">,</span><span class="pln">&nbsp;idx</span><span class="pun">]</span><span class="pln">&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;runkMeans</span><span class="pun">(</span><span class="pln">X</span><span class="pun">,</span><span class="pln">&nbsp;initial_centroids</span><span class="pun">,</span><span class="pln">&nbsp;</span><span class="pun">...</span></li><li class="L1"><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;max_iters</span><span class="pun">,</span><span class="pln">&nbsp;plot_progress</span><span class="pun">)</span></li><li class="L2"><span class="pun">%</span><span class="pln">RUNKMEANS&nbsp;runs&nbsp;the&nbsp;K</span><span class="pun">-</span><span class="typ">Means</span><span class="pln">&nbsp;algorithm&nbsp;on&nbsp;data&nbsp;matrix&nbsp;X</span><span class="pun">,</span><span class="pln">&nbsp;</span><span class="kwd">where</span><span class="pln">&nbsp;each&nbsp;row&nbsp;of&nbsp;X</span></li><li class="L3"><span class="pun">%</span><span class="kwd">is</span><span class="pln">&nbsp;a&nbsp;single&nbsp;example</span></li><li class="L4"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;&nbsp;</span><span class="pun">[</span><span class="pln">centroids</span><span class="pun">,</span><span class="pln">&nbsp;idx</span><span class="pun">]</span><span class="pln">&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;RUNKMEANS</span><span class="pun">(</span><span class="pln">X</span><span class="pun">,</span><span class="pln">&nbsp;initial_centroids</span><span class="pun">,</span><span class="pln">&nbsp;max_iters</span><span class="pun">,</span><span class="pln">&nbsp;</span><span class="pun">...</span></li><li class="L5"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;&nbsp;plot_progress</span><span class="pun">)</span><span class="pln">&nbsp;runs&nbsp;the&nbsp;K</span><span class="pun">-</span><span class="typ">Means</span><span class="pln">&nbsp;algorithm&nbsp;on&nbsp;data&nbsp;matrix&nbsp;X</span><span class="pun">,</span><span class="pln">&nbsp;</span><span class="kwd">where</span><span class="pln">&nbsp;each&nbsp;</span></li><li class="L6"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;&nbsp;row&nbsp;of&nbsp;X&nbsp;</span><span class="kwd">is</span><span class="pln">&nbsp;a&nbsp;single&nbsp;example</span><span class="pun">.</span><span class="pln">&nbsp;</span><span class="typ">It</span><span class="pln">&nbsp;uses&nbsp;initial_centroids&nbsp;used&nbsp;</span><span class="kwd">as</span><span class="pln">&nbsp;the</span></li><li class="L7"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;&nbsp;initial&nbsp;centroids</span><span class="pun">.</span><span class="pln">&nbsp;max_iters&nbsp;specifies&nbsp;the&nbsp;total&nbsp;number&nbsp;of&nbsp;interactions&nbsp;</span></li><li class="L8"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;&nbsp;of&nbsp;K</span><span class="pun">-</span><span class="typ">Means</span><span class="pln">&nbsp;to&nbsp;execute</span><span class="pun">.</span><span class="pln">&nbsp;plot_progress&nbsp;</span><span class="kwd">is</span><span class="pln">&nbsp;a&nbsp;</span><span class="kwd">true</span><span class="pun">/</span><span class="kwd">false</span><span class="pln">&nbsp;flag&nbsp;that&nbsp;</span></li><li class="L9"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;&nbsp;indicates&nbsp;</span><span class="kwd">if</span><span class="pln">&nbsp;the&nbsp;</span><span class="kwd">function</span><span class="pln">&nbsp;should&nbsp;also&nbsp;plot&nbsp;its&nbsp;progress&nbsp;</span><span class="kwd">as</span><span class="pln">&nbsp;the&nbsp;</span></li><li class="L0"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;&nbsp;learning&nbsp;happens</span><span class="pun">.</span><span class="pln">&nbsp;</span><span class="typ">This</span><span class="pln">&nbsp;</span><span class="kwd">is</span><span class="pln">&nbsp;</span><span class="kwd">set</span><span class="pln">&nbsp;to&nbsp;</span><span class="kwd">false</span><span class="pln">&nbsp;</span><span class="kwd">by</span><span class="pln">&nbsp;</span><span class="kwd">default</span><span class="pun">.</span><span class="pln">&nbsp;runkMeans&nbsp;returns&nbsp;</span></li><li class="L1"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;&nbsp;centroids</span><span class="pun">,</span><span class="pln">&nbsp;a&nbsp;</span><span class="typ">Kxn</span><span class="pln">&nbsp;matrix&nbsp;of&nbsp;the&nbsp;computed&nbsp;centroids&nbsp;</span><span class="kwd">and</span><span class="pln">&nbsp;idx</span><span class="pun">,</span><span class="pln">&nbsp;a&nbsp;m&nbsp;x&nbsp;</span><span class="lit">1</span><span class="pln">&nbsp;</span></li><li class="L2"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;&nbsp;vector&nbsp;of&nbsp;centroid&nbsp;assignments&nbsp;</span><span class="pun">(</span><span class="pln">i</span><span class="pun">.</span><span class="pln">e</span><span class="pun">.</span><span class="pln">&nbsp;each&nbsp;entry&nbsp;</span><span class="kwd">in</span><span class="pln">&nbsp;range&nbsp;</span><span class="pun">[</span><span class="lit">1.</span><span class="pun">.</span><span class="pln">K</span><span class="pun">])</span></li><li class="L3"><span class="pun">%</span></li><li class="L4"><span class="pln">&nbsp;</span></li><li class="L5"><span class="pun">%</span><span class="pln">&nbsp;</span><span class="typ">Set</span><span class="pln">&nbsp;</span><span class="kwd">default</span><span class="pln">&nbsp;value&nbsp;</span><span class="kwd">for</span><span class="pln">&nbsp;plot&nbsp;progress</span></li><li class="L6"><span class="kwd">if</span><span class="pln">&nbsp;</span><span class="pun">~</span><span class="pln">exist</span><span class="pun">(</span><span class="str">'plot_progress'</span><span class="pun">,</span><span class="pln">&nbsp;</span><span class="str">'var'</span><span class="pun">)</span><span class="pln">&nbsp;</span><span class="pun">||</span><span class="pln">&nbsp;isempty</span><span class="pun">(</span><span class="pln">plot_progress</span><span class="pun">)</span></li><li class="L7"><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;plot_progress&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;</span><span class="kwd">false</span><span class="pun">;</span></li><li class="L8"><span class="kwd">end</span></li><li class="L9"><span class="pln">&nbsp;</span></li><li class="L0"><span class="pun">%</span><span class="pln">&nbsp;</span><span class="typ">Plot</span><span class="pln">&nbsp;the&nbsp;data&nbsp;</span><span class="kwd">if</span><span class="pln">&nbsp;we&nbsp;are&nbsp;plotting&nbsp;progress</span></li><li class="L1"><span class="kwd">if</span><span class="pln">&nbsp;plot_progress</span></li><li class="L2"><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;figure</span><span class="pun">;</span></li><li class="L3"><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;hold&nbsp;on</span><span class="pun">;</span></li><li class="L4"><span class="kwd">end</span></li><li class="L5"><span class="pln">&nbsp;</span></li><li class="L6"><span class="pun">%</span><span class="pln">&nbsp;</span><span class="typ">Initialize</span><span class="pln">&nbsp;values</span></li><li class="L7"><span class="pun">[</span><span class="pln">m&nbsp;n</span><span class="pun">]</span><span class="pln">&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;size</span><span class="pun">(</span><span class="pln">X</span><span class="pun">);</span></li><li class="L8"><span class="pln">K&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;size</span><span class="pun">(</span><span class="pln">initial_centroids</span><span class="pun">,</span><span class="pln">&nbsp;</span><span class="lit">1</span><span class="pun">);</span></li><li class="L9"><span class="pln">centroids&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;initial_centroids</span><span class="pun">;</span></li><li class="L0"><span class="pln">previous_centroids&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;centroids</span><span class="pun">;</span></li><li class="L1"><span class="pln">idx&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;zeros</span><span class="pun">(</span><span class="pln">m</span><span class="pun">,</span><span class="pln">&nbsp;</span><span class="lit">1</span><span class="pun">);</span></li><li class="L2"><span class="pln">&nbsp;</span></li><li class="L3"><span class="pun">%</span><span class="pln">&nbsp;</span><span class="typ">Run</span><span class="pln">&nbsp;K</span><span class="pun">-</span><span class="typ">Means</span></li><li class="L4"><span class="kwd">for</span><span class="pln">&nbsp;i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">:</span><span class="pln">max_iters</span></li><li class="L5"><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li class="L6"><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">%</span><span class="pln">&nbsp;</span><span class="typ">Output</span><span class="pln">&nbsp;progress</span></li><li class="L7"><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;fprintf</span><span class="pun">(</span><span class="str">'K-Means&nbsp;iteration&nbsp;%d/%d...\n'</span><span class="pun">,</span><span class="pln">&nbsp;i</span><span class="pun">,</span><span class="pln">&nbsp;max_iters</span><span class="pun">);</span></li><li class="L8"><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln">&nbsp;exist</span><span class="pun">(</span><span class="str">'OCTAVE_VERSION'</span><span class="pun">)</span></li><li class="L9"><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fflush</span><span class="pun">(</span><span class="pln">stdout</span><span class="pun">);</span></li><li class="L0"><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">end</span></li><li class="L1"><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li class="L2"><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">%</span><span class="pln">&nbsp;</span><span class="typ">For</span><span class="pln">&nbsp;each&nbsp;example&nbsp;</span><span class="kwd">in</span><span class="pln">&nbsp;X</span><span class="pun">,</span><span class="pln">&nbsp;assign&nbsp;it&nbsp;to&nbsp;the&nbsp;closest&nbsp;centroid</span></li><li class="L3"><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;idx&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;findClosestCentroids</span><span class="pun">(</span><span class="pln">X</span><span class="pun">,</span><span class="pln">&nbsp;centroids</span><span class="pun">);</span></li><li class="L4"><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li class="L5"><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">%</span><span class="pln">&nbsp;</span><span class="typ">Optionally</span><span class="pun">,</span><span class="pln">&nbsp;plot&nbsp;progress&nbsp;here</span></li><li class="L6"><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln">&nbsp;plot_progress</span></li><li class="L7"><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plotProgresskMeans</span><span class="pun">(</span><span class="pln">X</span><span class="pun">,</span><span class="pln">&nbsp;centroids</span><span class="pun">,</span><span class="pln">&nbsp;previous_centroids</span><span class="pun">,</span><span class="pln">&nbsp;idx</span><span class="pun">,</span><span class="pln">&nbsp;K</span><span class="pun">,</span><span class="pln">&nbsp;i</span><span class="pun">);</span></li><li class="L8"><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;previous_centroids&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;centroids</span><span class="pun">;</span></li><li class="L9"><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li class="L0"><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frame</span><span class="pun">=</span><span class="pln">getframe</span><span class="pun">(</span><span class="pln">gcf</span><span class="pun">);</span></li><li class="L1"><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;im</span><span class="pun">=</span><span class="pln">frame2im</span><span class="pun">(</span><span class="pln">frame</span><span class="pun">);</span></li><li class="L2"><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">[</span><span class="pln">I</span><span class="pun">,</span><span class="pln">map</span><span class="pun">]=</span><span class="pln">rgb2ind</span><span class="pun">(</span><span class="pln">im</span><span class="pun">,</span><span class="lit">256</span><span class="pun">);</span></li><li class="L3"><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln">&nbsp;i</span><span class="pun">==</span><span class="lit">1</span></li><li class="L4"><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imwrite</span><span class="pun">(</span><span class="pln">I</span><span class="pun">,</span><span class="pln">map</span><span class="pun">,</span><span class="str">'ex.gif'</span><span class="pun">,</span><span class="str">'gif'</span><span class="pun">,</span><span class="str">'Loopcount'</span><span class="pun">,</span><span class="typ">Inf</span><span class="pun">,</span><span class="str">'DelayTime'</span><span class="pun">,</span><span class="lit">0.2</span><span class="pun">);</span></li><li class="L5"><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">else</span></li><li class="L6"><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imwrite</span><span class="pun">(</span><span class="pln">I</span><span class="pun">,</span><span class="pln">map</span><span class="pun">,</span><span class="str">'ex.gif'</span><span class="pun">,</span><span class="str">'gif'</span><span class="pun">,</span><span class="str">'WriteMode'</span><span class="pun">,</span><span class="str">'append'</span><span class="pun">,</span><span class="str">'DelayTime'</span><span class="pun">,</span><span class="lit">0.2</span><span class="pun">);</span><span class="pln">&nbsp;&nbsp;</span></li><li class="L7"><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">end</span></li><li class="L8"><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">end</span></li><li class="L9"><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li class="L0"><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">%</span><span class="pln">&nbsp;</span><span class="typ">Given</span><span class="pln">&nbsp;the&nbsp;memberships</span><span class="pun">,</span><span class="pln">&nbsp;compute&nbsp;</span><span class="kwd">new</span><span class="pln">&nbsp;centroids</span></li><li class="L1"><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;centroids&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;computeCentroids</span><span class="pun">(</span><span class="pln">X</span><span class="pun">,</span><span class="pln">&nbsp;idx</span><span class="pun">,</span><span class="pln">&nbsp;K</span><span class="pun">);</span></li><li class="L2"><span class="kwd">end</span></li><li class="L3"><span class="pln">&nbsp;</span></li><li class="L4"><span class="pun">%</span><span class="pln">&nbsp;</span><span class="typ">Hold</span><span class="pln">&nbsp;off&nbsp;</span><span class="kwd">if</span><span class="pln">&nbsp;we&nbsp;are&nbsp;plotting&nbsp;progress</span></li><li class="L5"><span class="kwd">if</span><span class="pln">&nbsp;plot_progress</span></li><li class="L6"><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;hold&nbsp;off</span><span class="pun">;</span></li><li class="L7"><span class="kwd">end</span></li><li class="L8"><span class="pln">&nbsp;</span></li><li class="L9"><span class="kwd">end</span></li></ol></pre>
<p style="text-indent: 2em;">其中，我加了一段输出gif的代码：</p>
<pre class="prettyprint lang-as3 linenums"><ol class="linenums"><li class="L0"><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frame</span><span class="pun">=</span><span class="pln">getframe</span><span class="pun">(</span><span class="pln">gcf</span><span class="pun">);</span></li><li class="L1"><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;im</span><span class="pun">=</span><span class="pln">frame2im</span><span class="pun">(</span><span class="pln">frame</span><span class="pun">);</span></li><li class="L2"><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">[</span><span class="pln">I</span><span class="pun">,</span><span class="pln">map</span><span class="pun">]=</span><span class="pln">rgb2ind</span><span class="pun">(</span><span class="pln">im</span><span class="pun">,</span><span class="lit">256</span><span class="pun">);</span></li><li class="L3"><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln">&nbsp;i</span><span class="pun">==</span><span class="lit">1</span></li><li class="L4"><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imwrite</span><span class="pun">(</span><span class="pln">I</span><span class="pun">,</span><span class="pln">map</span><span class="pun">,</span><span class="str">'ex.gif'</span><span class="pun">,</span><span class="str">'gif'</span><span class="pun">,</span><span class="str">'Loopcount'</span><span class="pun">,</span><span class="typ">Inf</span><span class="pun">,</span><span class="str">'DelayTime'</span><span class="pun">,</span><span class="lit">0.2</span><span class="pun">);</span></li><li class="L5"><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">else</span></li><li class="L6"><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imwrite</span><span class="pun">(</span><span class="pln">I</span><span class="pun">,</span><span class="pln">map</span><span class="pun">,</span><span class="str">'ex.gif'</span><span class="pun">,</span><span class="str">'gif'</span><span class="pun">,</span><span class="str">'WriteMode'</span><span class="pun">,</span><span class="str">'append'</span><span class="pun">,</span><span class="str">'DelayTime'</span><span class="pun">,</span><span class="lit">0.2</span><span class="pun">);</span><span class="pln">&nbsp;&nbsp;</span></li><li class="L7"><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">end</span></li></ol></pre>
<p style="text-indent: 2em;"><span style="text-indent: 32px;"><span style="text-indent: 32px;"></span></span>得到：</p>
<p style="text-align:center"><img src="./CS229编程7：K-means聚类与主成分分析-码农场_files/6cbb8645gw1f9mhg8asw2g20v40ncgqw.gif" title="ex.gif" alt="ex.gif" data-tag="bdshare"></p>
<p style="text-indent: 2em;">如果去掉getframe的参数gcf，则只捕捉图像部分：</p>
<p style="text-align:center"><img src="./CS229编程7：K-means聚类与主成分分析-码农场_files/6cbb8645gw1f9mhhls29ag20o40j1tc1.gif" title="ex 2.gif" alt="ex 2.gif" data-tag="bdshare"></p>
<p style="text-indent: 2em;">想当初，输出gif的功能在Python里费了不少功夫，现在一两句话搞定，不得不说商业软件有商业软件的好处。</p>
<h2 id="h2-5"><span style="text-indent: 2em;">图像压缩</span></h2>
<p style="text-indent: 2em;">对于下面这张128*128的24位图片：</p>
<p style="text-align:center"><img src="./CS229编程7：K-means聚类与主成分分析-码农场_files/6cbb8645gw1f9ml6ied5sj203k03kaa4.jpg" title="bird_small.png" alt="bird_small.png" data-tag="bdshare"></p>
<p style="text-indent: 2em;">这是一只丑陋的鸟，每个像素由8位RGB分量组成，共2^24种颜色。加载方法如下：</p>
<pre class="prettyprint lang-as3 linenums"><ol class="linenums"><li class="L0"><span class="pun">%%</span><span class="pln">&nbsp;</span><span class="pun">=============</span><span class="pln">&nbsp;</span><span class="typ">Part</span><span class="pln">&nbsp;</span><span class="lit">4</span><span class="pun">:</span><span class="pln">&nbsp;K</span><span class="pun">-</span><span class="typ">Means</span><span class="pln">&nbsp;</span><span class="typ">Clustering</span><span class="pln">&nbsp;on&nbsp;</span><span class="typ">Pixels</span><span class="pln">&nbsp;</span><span class="pun">===============</span></li><li class="L1"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;</span><span class="typ">In</span><span class="pln">&nbsp;</span><span class="kwd">this</span><span class="pln">&nbsp;exercise</span><span class="pun">,</span><span class="pln">&nbsp;you&nbsp;will&nbsp;</span><span class="kwd">use</span><span class="pln">&nbsp;K</span><span class="pun">-</span><span class="typ">Means</span><span class="pln">&nbsp;to&nbsp;compress&nbsp;an&nbsp;image</span><span class="pun">.</span><span class="pln">&nbsp;</span><span class="typ">To</span><span class="pln">&nbsp;</span><span class="kwd">do</span><span class="pln">&nbsp;</span><span class="kwd">this</span><span class="pun">,</span></li><li class="L2"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;you&nbsp;will&nbsp;first&nbsp;run&nbsp;K</span><span class="pun">-</span><span class="typ">Means</span><span class="pln">&nbsp;on&nbsp;the&nbsp;colors&nbsp;of&nbsp;the&nbsp;pixels&nbsp;</span><span class="kwd">in</span><span class="pln">&nbsp;the&nbsp;image&nbsp;</span><span class="kwd">and</span></li><li class="L3"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;</span><span class="kwd">then</span><span class="pln">&nbsp;you&nbsp;will&nbsp;map&nbsp;each&nbsp;pixel&nbsp;on&nbsp;to&nbsp;it</span><span class="str">'s&nbsp;closest&nbsp;centroid.</span></li><li class="L4"><span class="str">%&nbsp;&nbsp;</span></li><li class="L5"><span class="str">%&nbsp;&nbsp;You&nbsp;should&nbsp;now&nbsp;complete&nbsp;the&nbsp;code&nbsp;in&nbsp;kMeansInitCentroids.m</span></li><li class="L6"><span class="str">%</span></li><li class="L7"><span class="str">&nbsp;</span></li><li class="L8"><span class="str">fprintf('</span><span class="pln">\n</span><span class="typ">Running</span><span class="pln">&nbsp;K</span><span class="pun">-</span><span class="typ">Means</span><span class="pln">&nbsp;clustering&nbsp;on&nbsp;pixels&nbsp;</span><span class="kwd">from</span><span class="pln">&nbsp;an&nbsp;image</span><span class="pun">.</span><span class="pln">\n\n</span><span class="str">');</span></li><li class="L9"><span class="str">&nbsp;</span></li><li class="L0"><span class="str">%&nbsp;&nbsp;Load&nbsp;an&nbsp;image&nbsp;of&nbsp;a&nbsp;bird</span></li><li class="L1"><span class="str">A&nbsp;=&nbsp;double(imread('</span><span class="pln">bird_small</span><span class="pun">.</span><span class="pln">png</span><span class="str">'));</span></li><li class="L2"><span class="str">&nbsp;</span></li><li class="L3"><span class="str">%&nbsp;If&nbsp;imread&nbsp;does&nbsp;not&nbsp;work&nbsp;for&nbsp;you,&nbsp;you&nbsp;can&nbsp;try&nbsp;instead</span></li><li class="L4"><span class="str">%&nbsp;&nbsp;&nbsp;load&nbsp;('</span><span class="pln">bird_small</span><span class="pun">.</span><span class="pln">mat</span><span class="str">');</span></li><li class="L5"><span class="str">&nbsp;</span></li><li class="L6"><span class="str">A&nbsp;=&nbsp;A&nbsp;/&nbsp;255;&nbsp;%&nbsp;Divide&nbsp;by&nbsp;255&nbsp;so&nbsp;that&nbsp;all&nbsp;values&nbsp;are&nbsp;in&nbsp;the&nbsp;range&nbsp;0&nbsp;-&nbsp;1</span></li><li class="L7"><span class="str">&nbsp;</span></li><li class="L8"><span class="str">%&nbsp;Size&nbsp;of&nbsp;the&nbsp;image</span></li><li class="L9"><span class="str">img_size&nbsp;=&nbsp;size(A);</span></li><li class="L0"><span class="str">&nbsp;</span></li><li class="L1"><span class="str">%&nbsp;Reshape&nbsp;the&nbsp;image&nbsp;into&nbsp;an&nbsp;Nx3&nbsp;matrix&nbsp;where&nbsp;N&nbsp;=&nbsp;number&nbsp;of&nbsp;pixels.</span></li><li class="L2"><span class="str">%&nbsp;Each&nbsp;row&nbsp;will&nbsp;contain&nbsp;the&nbsp;Red,&nbsp;Green&nbsp;and&nbsp;Blue&nbsp;pixel&nbsp;values</span></li><li class="L3"><span class="str">%&nbsp;This&nbsp;gives&nbsp;us&nbsp;our&nbsp;dataset&nbsp;matrix&nbsp;X&nbsp;that&nbsp;we&nbsp;will&nbsp;use&nbsp;K-Means&nbsp;on.</span></li><li class="L4"><span class="str">X&nbsp;=&nbsp;reshape(A,&nbsp;img_size(1)&nbsp;*&nbsp;img_size(2),&nbsp;3);</span></li></ol></pre>
<p style="text-indent: 2em;">其中，imread得到X*Y*3的矩阵。</p>
<p style="text-indent: 2em;">这次任务是将其压缩为4位，共16种颜色表示的图片。<span style="text-indent: 2em;">原理是利用K-means算法在RGB3维空间中找出这16种颜色——像素们的重心，并将每个像素点表示为其中一种，于是完成24-&gt;4的压缩。</span></p>
<p style="text-indent: 2em;"><span style="text-indent: 2em;">调用代码</span></p>
<p style="text-indent: 2em;"><span style="text-indent: 2em;"></span></p>
<pre class="prettyprint lang-as3 linenums"><ol class="linenums"><li class="L0"><span class="pun">%</span><span class="pln">&nbsp;</span><span class="typ">Run</span><span class="pln">&nbsp;your&nbsp;K</span><span class="pun">-</span><span class="typ">Means</span><span class="pln">&nbsp;algorithm&nbsp;on&nbsp;</span><span class="kwd">this</span><span class="pln">&nbsp;data</span></li><li class="L1"><span class="pun">%</span><span class="pln">&nbsp;</span><span class="typ">You</span><span class="pln">&nbsp;should&nbsp;</span><span class="kwd">try</span><span class="pln">&nbsp;different&nbsp;values&nbsp;of&nbsp;K&nbsp;</span><span class="kwd">and</span><span class="pln">&nbsp;max_iters&nbsp;here</span></li><li class="L2"><span class="pln">K&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;</span><span class="lit">16</span><span class="pun">;</span><span class="pln">&nbsp;</span></li><li class="L3"><span class="pln">max_iters&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;</span><span class="lit">10</span><span class="pun">;</span></li><li class="L4"><span class="pln">&nbsp;</span></li><li class="L5"><span class="pun">%</span><span class="pln">&nbsp;</span><span class="typ">When</span><span class="pln">&nbsp;</span><span class="kwd">using</span><span class="pln">&nbsp;K</span><span class="pun">-</span><span class="typ">Means</span><span class="pun">,</span><span class="pln">&nbsp;it&nbsp;</span><span class="kwd">is</span><span class="pln">&nbsp;important&nbsp;the&nbsp;initialize&nbsp;the&nbsp;centroids</span></li><li class="L6"><span class="pun">%</span><span class="pln">&nbsp;randomly</span><span class="pun">.</span><span class="pln">&nbsp;</span></li><li class="L7"><span class="pun">%</span><span class="pln">&nbsp;</span><span class="typ">You</span><span class="pln">&nbsp;should&nbsp;complete&nbsp;the&nbsp;code&nbsp;</span><span class="kwd">in</span><span class="pln">&nbsp;kMeansInitCentroids</span><span class="pun">.</span><span class="pln">m&nbsp;before&nbsp;proceeding</span></li><li class="L8"><span class="pln">initial_centroids&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;kMeansInitCentroids</span><span class="pun">(</span><span class="pln">X</span><span class="pun">,</span><span class="pln">&nbsp;K</span><span class="pun">);</span></li><li class="L9"><span class="pln">&nbsp;</span></li><li class="L0"><span class="pun">%</span><span class="pln">&nbsp;</span><span class="typ">Run</span><span class="pln">&nbsp;K</span><span class="pun">-</span><span class="typ">Means</span></li><li class="L1"><span class="pun">[</span><span class="pln">centroids</span><span class="pun">,</span><span class="pln">&nbsp;idx</span><span class="pun">]</span><span class="pln">&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;runkMeans</span><span class="pun">(</span><span class="pln">X</span><span class="pun">,</span><span class="pln">&nbsp;initial_centroids</span><span class="pun">,</span><span class="pln">&nbsp;max_iters</span><span class="pun">);</span></li><li class="L2"><span class="pln">&nbsp;</span></li><li class="L3"><span class="pln">fprintf</span><span class="pun">(</span><span class="str">'Program&nbsp;paused.&nbsp;Press&nbsp;enter&nbsp;to&nbsp;continue.\n'</span><span class="pun">);</span></li><li class="L4"><span class="pln">pause</span><span class="pun">;</span></li></ol></pre>
<p style="text-indent: 2em;"><span style="text-indent: 2em;"></span>idx就是每个像素点最近的重心的index，将像素点替换为重心就得到压缩后的图片：</p>
<pre class="prettyprint lang-as3 linenums"><ol class="linenums"><li class="L0"><span class="pun">%%</span><span class="pln">&nbsp;</span><span class="pun">=================</span><span class="pln">&nbsp;</span><span class="typ">Part</span><span class="pln">&nbsp;</span><span class="lit">5</span><span class="pun">:</span><span class="pln">&nbsp;</span><span class="typ">Image</span><span class="pln">&nbsp;</span><span class="typ">Compression</span><span class="pln">&nbsp;</span><span class="pun">======================</span></li><li class="L1"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;</span><span class="typ">In</span><span class="pln">&nbsp;</span><span class="kwd">this</span><span class="pln">&nbsp;part&nbsp;of&nbsp;the&nbsp;exercise</span><span class="pun">,</span><span class="pln">&nbsp;you&nbsp;will&nbsp;</span><span class="kwd">use</span><span class="pln">&nbsp;the&nbsp;clusters&nbsp;of&nbsp;K</span><span class="pun">-</span><span class="typ">Means</span><span class="pln">&nbsp;to</span></li><li class="L2"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;compress&nbsp;an&nbsp;image</span><span class="pun">.</span><span class="pln">&nbsp;</span><span class="typ">To</span><span class="pln">&nbsp;</span><span class="kwd">do</span><span class="pln">&nbsp;</span><span class="kwd">this</span><span class="pun">,</span><span class="pln">&nbsp;we&nbsp;first&nbsp;find&nbsp;the&nbsp;closest&nbsp;clusters&nbsp;</span><span class="kwd">for</span></li><li class="L3"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;each&nbsp;example</span><span class="pun">.</span><span class="pln">&nbsp;</span><span class="typ">After</span><span class="pln">&nbsp;that</span><span class="pun">,</span><span class="pln">&nbsp;we&nbsp;</span></li><li class="L4"><span class="pln">&nbsp;</span></li><li class="L5"><span class="pln">fprintf</span><span class="pun">(</span><span class="str">'\nApplying&nbsp;K-Means&nbsp;to&nbsp;compress&nbsp;an&nbsp;image.\n\n'</span><span class="pun">);</span></li><li class="L6"><span class="pln">&nbsp;</span></li><li class="L7"><span class="pun">%</span><span class="pln">&nbsp;</span><span class="typ">Find</span><span class="pln">&nbsp;closest&nbsp;cluster&nbsp;members</span></li><li class="L8"><span class="pln">idx&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;findClosestCentroids</span><span class="pun">(</span><span class="pln">X</span><span class="pun">,</span><span class="pln">&nbsp;centroids</span><span class="pun">);</span></li><li class="L9"><span class="pln">&nbsp;</span></li><li class="L0"><span class="pun">%</span><span class="pln">&nbsp;</span><span class="typ">Essentially</span><span class="pun">,</span><span class="pln">&nbsp;now&nbsp;we&nbsp;have&nbsp;represented&nbsp;the&nbsp;image&nbsp;X&nbsp;</span><span class="kwd">as</span><span class="pln">&nbsp;</span><span class="kwd">in</span><span class="pln">&nbsp;terms&nbsp;of&nbsp;the</span></li><li class="L1"><span class="pun">%</span><span class="pln">&nbsp;indices&nbsp;</span><span class="kwd">in</span><span class="pln">&nbsp;idx</span><span class="pun">.</span><span class="pln">&nbsp;</span></li><li class="L2"><span class="pln">&nbsp;</span></li><li class="L3"><span class="pun">%</span><span class="pln">&nbsp;</span><span class="typ">We</span><span class="pln">&nbsp;can&nbsp;now&nbsp;recover&nbsp;the&nbsp;image&nbsp;</span><span class="kwd">from</span><span class="pln">&nbsp;the&nbsp;indices&nbsp;</span><span class="pun">(</span><span class="pln">idx</span><span class="pun">)</span><span class="pln">&nbsp;</span><span class="kwd">by</span><span class="pln">&nbsp;mapping&nbsp;each&nbsp;pixel</span></li><li class="L4"><span class="pun">%</span><span class="pln">&nbsp;</span><span class="pun">(</span><span class="pln">specified&nbsp;</span><span class="kwd">by</span><span class="pln">&nbsp;it</span><span class="str">'s&nbsp;index&nbsp;in&nbsp;idx)&nbsp;to&nbsp;the&nbsp;centroid&nbsp;value</span></li><li class="L5"><span class="str">X_recovered&nbsp;=&nbsp;centroids(idx,:);</span></li><li class="L6"><span class="str">&nbsp;</span></li><li class="L7"><span class="str">%&nbsp;Reshape&nbsp;the&nbsp;recovered&nbsp;image&nbsp;into&nbsp;proper&nbsp;dimensions</span></li><li class="L8"><span class="str">X_recovered&nbsp;=&nbsp;reshape(X_recovered,&nbsp;img_size(1),&nbsp;img_size(2),&nbsp;3);</span></li><li class="L9"><span class="str">&nbsp;</span></li><li class="L0"><span class="str">%&nbsp;Display&nbsp;the&nbsp;original&nbsp;image&nbsp;</span></li><li class="L1"><span class="str">subplot(1,&nbsp;2,&nbsp;1);</span></li><li class="L2"><span class="str">imagesc(A);&nbsp;</span></li><li class="L3"><span class="str">title('</span><span class="typ">Original</span><span class="str">');</span></li><li class="L4"><span class="str">&nbsp;</span></li><li class="L5"><span class="str">%&nbsp;Display&nbsp;compressed&nbsp;image&nbsp;side&nbsp;by&nbsp;side</span></li><li class="L6"><span class="str">subplot(1,&nbsp;2,&nbsp;2);</span></li><li class="L7"><span class="str">imagesc(X_recovered)</span></li><li class="L8"><span class="str">title(sprintf('</span><span class="typ">Compressed</span><span class="pun">,</span><span class="pln">&nbsp;</span><span class="kwd">with</span><span class="pln">&nbsp;</span><span class="pun">%</span><span class="pln">d&nbsp;colors</span><span class="pun">.</span><span class="str">',&nbsp;K));</span></li><li class="L9"><span class="str">&nbsp;</span></li><li class="L0"><span class="str">&nbsp;</span></li><li class="L1"><span class="str">fprintf('</span><span class="typ">Program</span><span class="pln">&nbsp;paused</span><span class="pun">.</span><span class="pln">&nbsp;</span><span class="typ">Press</span><span class="pln">&nbsp;enter&nbsp;to&nbsp;</span><span class="kwd">continue</span><span class="pun">.</span><span class="pln">\n</span><span class="str">');</span></li><li class="L2"><span class="str">pause;</span></li></ol></pre>
<p style="text-indent: 2em;">其中，imagesc是Display image with scaled colors的缩写，默认使用colormap的全部色彩。</p>
<p style="text-indent: 2em;">运行后得到：</p>
<p style="text-align:center"><img src="./CS229编程7：K-means聚类与主成分分析-码农场_files/6cbb8645gw1f9mlm741x3j20v40nc0zv.jpg" title="compress.png" alt="compress.png" data-tag="bdshare"></p>
<p style="text-indent: 2em;">似乎变得更丑了。</p>
<h2 id="h2-6">主成分分析<br></h2>
<p style="text-indent: 2em;">这部分先利用一个简单的2D数据集熟悉熟悉PCA，然后应用到5000张人脸组成的数据集上。</p>
<h3 id="h3-7">简单数据集<br></h3>
<p style="text-indent: 2em;">将下面这个2D数据集降维到1维：</p>
<pre class="prettyprint lang-as3 linenums"><ol class="linenums"><li class="L0"><span class="pun">%%</span><span class="pln">&nbsp;</span><span class="pun">==================</span><span class="pln">&nbsp;</span><span class="typ">Part</span><span class="pln">&nbsp;</span><span class="lit">1</span><span class="pun">:</span><span class="pln">&nbsp;</span><span class="typ">Load</span><span class="pln">&nbsp;</span><span class="typ">Example</span><span class="pln">&nbsp;</span><span class="typ">Dataset</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">===================</span></li><li class="L1"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;</span><span class="typ">We</span><span class="pln">&nbsp;start&nbsp;</span><span class="kwd">this</span><span class="pln">&nbsp;exercise&nbsp;</span><span class="kwd">by</span><span class="pln">&nbsp;</span><span class="kwd">using</span><span class="pln">&nbsp;a&nbsp;small&nbsp;dataset&nbsp;that&nbsp;</span><span class="kwd">is</span><span class="pln">&nbsp;easily&nbsp;to</span></li><li class="L2"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;visualize</span></li><li class="L3"><span class="pun">%</span></li><li class="L4"><span class="pln">fprintf</span><span class="pun">(</span><span class="str">'Visualizing&nbsp;example&nbsp;dataset&nbsp;for&nbsp;PCA.\n\n'</span><span class="pun">);</span></li><li class="L5"><span class="pln">&nbsp;</span></li><li class="L6"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;</span><span class="typ">The</span><span class="pln">&nbsp;following&nbsp;command&nbsp;loads&nbsp;the&nbsp;dataset</span><span class="pun">.</span><span class="pln">&nbsp;</span><span class="typ">You</span><span class="pln">&nbsp;should&nbsp;now&nbsp;have&nbsp;the&nbsp;</span></li><li class="L7"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;variable&nbsp;X&nbsp;</span><span class="kwd">in</span><span class="pln">&nbsp;your&nbsp;environment</span></li><li class="L8"><span class="pln">load&nbsp;</span><span class="pun">(</span><span class="str">'ex7data1.mat'</span><span class="pun">);</span></li><li class="L9"><span class="pln">&nbsp;</span></li><li class="L0"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;</span><span class="typ">Visualize</span><span class="pln">&nbsp;the&nbsp;example&nbsp;dataset</span></li><li class="L1"><span class="pln">plot</span><span class="pun">(</span><span class="pln">X</span><span class="pun">(:,</span><span class="pln">&nbsp;</span><span class="lit">1</span><span class="pun">),</span><span class="pln">&nbsp;X</span><span class="pun">(:,</span><span class="pln">&nbsp;</span><span class="lit">2</span><span class="pun">),</span><span class="pln">&nbsp;</span><span class="str">'bo'</span><span class="pun">);</span></li><li class="L2"><span class="pln">axis</span><span class="pun">([</span><span class="lit">0.5</span><span class="pln">&nbsp;</span><span class="lit">6.5</span><span class="pln">&nbsp;</span><span class="lit">2</span><span class="pln">&nbsp;</span><span class="lit">8</span><span class="pun">]);</span><span class="pln">&nbsp;axis&nbsp;square</span><span class="pun">;</span></li><li class="L3"><span class="pln">&nbsp;</span></li><li class="L4"><span class="pln">fprintf</span><span class="pun">(</span><span class="str">'Program&nbsp;paused.&nbsp;Press&nbsp;enter&nbsp;to&nbsp;continue.\n'</span><span class="pun">);</span></li><li class="L5"><span class="pln">pause</span><span class="pun">;</span></li></ol></pre>
<p style="text-indent: 2em;">得到：</p>
<p style="text-align:center"><img src="./CS229编程7：K-means聚类与主成分分析-码农场_files/6cbb8645gw1f9mlq7eyhdj20v40nc0tt.jpg" title="simpledata.png" alt="simpledata.png" data-tag="bdshare"></p>
<h3 id="h3-8">实现PCA<br></h3>
<p style="text-indent: 2em;">原理可以参考cs229的视频，或者《<a href="http://www.hankcs.com/ml/python-step-by-step-to-achieve-the-principal-component-analysis.html" target="_blank">Python循序渐进主成分分析</a>》</p>
<p style="text-indent: 2em;">大致分为两步</p>
<ol class=" list-paddingleft-2" style="list-style-type: decimal;">
<li>
<p style="text-indent: 2em;">计算协方差矩阵</p>
</li>
<li>
<p style="text-indent: 2em;">利用matlab的SVD方法得到特征向量和特征值</p>
</li>
</ol>
<h3 id="h3-9">数据标准化</h3>
<p style="text-indent: 2em;">在执行PCA之前必须注意，要将数据标准化到均值=0，范围相同。实现如下：</p>
<pre class="prettyprint lang-as3 linenums"><ol class="linenums"><li class="L0"><span class="kwd">function</span><span class="pln">&nbsp;</span><span class="pun">[</span><span class="pln">X_norm</span><span class="pun">,</span><span class="pln">&nbsp;mu</span><span class="pun">,</span><span class="pln">&nbsp;sigma</span><span class="pun">]</span><span class="pln">&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;featureNormalize</span><span class="pun">(</span><span class="pln">X</span><span class="pun">)</span></li><li class="L1"><span class="pun">%</span><span class="pln">FEATURENORMALIZE&nbsp;</span><span class="typ">Normalizes</span><span class="pln">&nbsp;the&nbsp;features&nbsp;</span><span class="kwd">in</span><span class="pln">&nbsp;X&nbsp;</span></li><li class="L2"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;&nbsp;FEATURENORMALIZE</span><span class="pun">(</span><span class="pln">X</span><span class="pun">)</span><span class="pln">&nbsp;returns&nbsp;a&nbsp;normalized&nbsp;version&nbsp;of&nbsp;X&nbsp;</span><span class="kwd">where</span></li><li class="L3"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;&nbsp;the&nbsp;mean&nbsp;value&nbsp;of&nbsp;each&nbsp;feature&nbsp;</span><span class="kwd">is</span><span class="pln">&nbsp;</span><span class="lit">0</span><span class="pln">&nbsp;</span><span class="kwd">and</span><span class="pln">&nbsp;the&nbsp;standard&nbsp;deviation</span></li><li class="L4"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;&nbsp;</span><span class="kwd">is</span><span class="pln">&nbsp;</span><span class="lit">1.</span><span class="pln">&nbsp;</span><span class="typ">This</span><span class="pln">&nbsp;</span><span class="kwd">is</span><span class="pln">&nbsp;often&nbsp;a&nbsp;good&nbsp;preprocessing&nbsp;step&nbsp;to&nbsp;</span><span class="kwd">do</span><span class="pln">&nbsp;</span><span class="kwd">when</span></li><li class="L5"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;&nbsp;working&nbsp;</span><span class="kwd">with</span><span class="pln">&nbsp;learning&nbsp;algorithms</span><span class="pun">.</span></li><li class="L6"><span class="pln">&nbsp;</span></li><li class="L7"><span class="pln">mu&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;mean</span><span class="pun">(</span><span class="pln">X</span><span class="pun">);</span></li><li class="L8"><span class="pln">X_norm&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;bsxfun</span><span class="pun">(</span><span class="lit">@minus</span><span class="pun">,</span><span class="pln">&nbsp;X</span><span class="pun">,</span><span class="pln">&nbsp;mu</span><span class="pun">);</span></li><li class="L9"><span class="pln">&nbsp;</span></li><li class="L0"><span class="pln">sigma&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;std</span><span class="pun">(</span><span class="pln">X_norm</span><span class="pun">);</span></li><li class="L1"><span class="pln">X_norm&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;bsxfun</span><span class="pun">(</span><span class="lit">@rdivide</span><span class="pun">,</span><span class="pln">&nbsp;X_norm</span><span class="pun">,</span><span class="pln">&nbsp;sigma</span><span class="pun">);</span></li><li class="L2"><span class="pln">&nbsp;</span></li><li class="L3"><span class="pln">&nbsp;</span></li><li class="L4"><span class="pun">%</span><span class="pln">&nbsp;</span><span class="pun">============================================================</span></li><li class="L5"><span class="pln">&nbsp;</span></li><li class="L6"><span class="kwd">end</span></li></ol></pre>
<p style="text-indent: 2em;">跟前面几次练习一摸一样。</p>
<h3 id="h3-10">实现<br></h3>
<p style="text-indent: 2em;">第一步，计算协方差矩阵，也就是</p>
<p style="text-align:center"><img src="./CS229编程7：K-means聚类与主成分分析-码农场_files/6cbb8645gw1f9mpandtctj206c02uq2u.jpg" title="hankcs.com 2016-11-09 下午6.20.56.png" alt="hankcs.com 2016-11-09 下午6.20.56.png" width="94" height="42" border="0" vspace="0" style="width: 94px; height: 42px;" data-tag="bdshare"></p>
<p style="text-indent: 2em;">这里X是按行排列的数据点构成的矩阵。</p>
<p style="text-indent: 2em;">之后调用[U,S,V] = SVD(X)，得到的U就是主成分矩阵，S矩阵对角线上就是相应特征向量对应的特征值。</p>
<p style="text-indent: 2em;">实现如下：</p>
<pre class="prettyprint lang-as3 linenums"><ol class="linenums"><li class="L0"><span class="kwd">function</span><span class="pln">&nbsp;</span><span class="pun">[</span><span class="pln">U</span><span class="pun">,</span><span class="pln">&nbsp;S</span><span class="pun">]</span><span class="pln">&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;pca</span><span class="pun">(</span><span class="pln">X</span><span class="pun">)</span></li><li class="L1"><span class="pun">%</span><span class="pln">PCA&nbsp;</span><span class="typ">Run</span><span class="pln">&nbsp;principal&nbsp;component&nbsp;analysis&nbsp;on&nbsp;the&nbsp;dataset&nbsp;X</span></li><li class="L2"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;&nbsp;</span><span class="pun">[</span><span class="pln">U</span><span class="pun">,</span><span class="pln">&nbsp;S</span><span class="pun">,</span><span class="pln">&nbsp;X</span><span class="pun">]</span><span class="pln">&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;pca</span><span class="pun">(</span><span class="pln">X</span><span class="pun">)</span><span class="pln">&nbsp;computes&nbsp;eigenvectors&nbsp;of&nbsp;the&nbsp;covariance&nbsp;matrix&nbsp;of&nbsp;X</span></li><li class="L3"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;&nbsp;</span><span class="typ">Returns</span><span class="pln">&nbsp;the&nbsp;eigenvectors&nbsp;U</span><span class="pun">,</span><span class="pln">&nbsp;the&nbsp;eigenvalues&nbsp;</span><span class="pun">(</span><span class="pln">on&nbsp;diagonal</span><span class="pun">)</span><span class="pln">&nbsp;</span><span class="kwd">in</span><span class="pln">&nbsp;S</span></li><li class="L4"><span class="pun">%</span></li><li class="L5"><span class="pln">&nbsp;</span></li><li class="L6"><span class="pun">%</span><span class="pln">&nbsp;</span><span class="typ">Useful</span><span class="pln">&nbsp;values</span></li><li class="L7"><span class="pun">[</span><span class="pln">m</span><span class="pun">,</span><span class="pln">&nbsp;n</span><span class="pun">]</span><span class="pln">&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;size</span><span class="pun">(</span><span class="pln">X</span><span class="pun">);</span></li><li class="L8"><span class="pln">&nbsp;</span></li><li class="L9"><span class="pun">%</span><span class="pln">&nbsp;</span><span class="typ">You</span><span class="pln">&nbsp;need&nbsp;to&nbsp;</span><span class="kwd">return</span><span class="pln">&nbsp;the&nbsp;following&nbsp;variables&nbsp;correctly</span><span class="pun">.</span></li><li class="L0"><span class="pln">U&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;zeros</span><span class="pun">(</span><span class="pln">n</span><span class="pun">);</span></li><li class="L1"><span class="pln">S&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;zeros</span><span class="pun">(</span><span class="pln">n</span><span class="pun">);</span></li><li class="L2"><span class="pln">&nbsp;</span></li><li class="L3"><span class="pun">%</span><span class="pln">&nbsp;</span><span class="pun">======================</span><span class="pln">&nbsp;YOUR&nbsp;CODE&nbsp;HERE&nbsp;</span><span class="pun">======================</span></li><li class="L4"><span class="pun">%</span><span class="pln">&nbsp;</span><span class="typ">Instructions</span><span class="pun">:</span><span class="pln">&nbsp;</span><span class="typ">You</span><span class="pln">&nbsp;should&nbsp;first&nbsp;compute&nbsp;the&nbsp;covariance&nbsp;matrix</span><span class="pun">.</span><span class="pln">&nbsp;</span><span class="typ">Then</span><span class="pun">,</span><span class="pln">&nbsp;you</span></li><li class="L5"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;should&nbsp;</span><span class="kwd">use</span><span class="pln">&nbsp;the&nbsp;</span><span class="str">"svd"</span><span class="pln">&nbsp;</span><span class="kwd">function</span><span class="pln">&nbsp;to&nbsp;compute&nbsp;the&nbsp;eigenvectors</span></li><li class="L6"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">and</span><span class="pln">&nbsp;eigenvalues&nbsp;of&nbsp;the&nbsp;covariance&nbsp;matrix</span><span class="pun">.</span><span class="pln">&nbsp;</span></li><li class="L7"><span class="pun">%</span></li><li class="L8"><span class="pun">%</span><span class="pln">&nbsp;</span><span class="typ">Note</span><span class="pun">:</span><span class="pln">&nbsp;</span><span class="typ">When</span><span class="pln">&nbsp;computing&nbsp;the&nbsp;covariance&nbsp;matrix</span><span class="pun">,</span><span class="pln">&nbsp;remember&nbsp;to&nbsp;divide&nbsp;</span><span class="kwd">by</span><span class="pln">&nbsp;m&nbsp;</span><span class="pun">(</span><span class="pln">the</span></li><li class="L9"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;number&nbsp;of&nbsp;examples</span><span class="pun">).</span></li><li class="L0"><span class="pun">%</span></li><li class="L1"><span class="pln">&nbsp;</span></li><li class="L2"><span class="typ">Sigma</span><span class="pln">&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;X</span><span class="str">'&nbsp;*&nbsp;X&nbsp;/&nbsp;m;</span></li><li class="L3"><span class="str">[U,&nbsp;S,&nbsp;V]&nbsp;=&nbsp;svd(Sigma);</span></li><li class="L4"><span class="str">&nbsp;</span></li><li class="L5"><span class="str">&nbsp;</span></li><li class="L6"><span class="str">&nbsp;</span></li><li class="L7"><span class="str">&nbsp;</span></li><li class="L8"><span class="str">&nbsp;</span></li><li class="L9"><span class="str">%&nbsp;=========================================================================</span></li><li class="L0"><span class="str">&nbsp;</span></li><li class="L1"><span class="str">end</span></li></ol></pre>
<p style="text-indent: 2em;">调用并可视化特征向量：</p>
<pre class="prettyprint lang-as3 linenums"><ol class="linenums"><li class="L0"><span class="pun">%%</span><span class="pln">&nbsp;</span><span class="pun">===============</span><span class="pln">&nbsp;</span><span class="typ">Part</span><span class="pln">&nbsp;</span><span class="lit">2</span><span class="pun">:</span><span class="pln">&nbsp;</span><span class="typ">Principal</span><span class="pln">&nbsp;</span><span class="typ">Component</span><span class="pln">&nbsp;</span><span class="typ">Analysis</span><span class="pln">&nbsp;</span><span class="pun">===============</span></li><li class="L1"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;</span><span class="typ">You</span><span class="pln">&nbsp;should&nbsp;now&nbsp;implement&nbsp;PCA</span><span class="pun">,</span><span class="pln">&nbsp;a&nbsp;dimension&nbsp;reduction&nbsp;technique</span><span class="pun">.</span><span class="pln">&nbsp;</span><span class="typ">You</span></li><li class="L2"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;should&nbsp;complete&nbsp;the&nbsp;code&nbsp;</span><span class="kwd">in</span><span class="pln">&nbsp;pca</span><span class="pun">.</span><span class="pln">m</span></li><li class="L3"><span class="pun">%</span></li><li class="L4"><span class="pln">fprintf</span><span class="pun">(</span><span class="str">'\nRunning&nbsp;PCA&nbsp;on&nbsp;example&nbsp;dataset.\n\n'</span><span class="pun">);</span></li><li class="L5"><span class="pln">&nbsp;</span></li><li class="L6"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;</span><span class="typ">Before</span><span class="pln">&nbsp;running&nbsp;PCA</span><span class="pun">,</span><span class="pln">&nbsp;it&nbsp;</span><span class="kwd">is</span><span class="pln">&nbsp;important&nbsp;to&nbsp;first&nbsp;normalize&nbsp;X</span></li><li class="L7"><span class="pun">[</span><span class="pln">X_norm</span><span class="pun">,</span><span class="pln">&nbsp;mu</span><span class="pun">,</span><span class="pln">&nbsp;sigma</span><span class="pun">]</span><span class="pln">&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;featureNormalize</span><span class="pun">(</span><span class="pln">X</span><span class="pun">);</span></li><li class="L8"><span class="pln">&nbsp;</span></li><li class="L9"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;</span><span class="typ">Run</span><span class="pln">&nbsp;PCA</span></li><li class="L0"><span class="pun">[</span><span class="pln">U</span><span class="pun">,</span><span class="pln">&nbsp;S</span><span class="pun">]</span><span class="pln">&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;pca</span><span class="pun">(</span><span class="pln">X_norm</span><span class="pun">);</span></li><li class="L1"><span class="pln">&nbsp;</span></li><li class="L2"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;</span><span class="typ">Compute</span><span class="pln">&nbsp;mu</span><span class="pun">,</span><span class="pln">&nbsp;the&nbsp;mean&nbsp;of&nbsp;the&nbsp;each&nbsp;feature</span></li><li class="L3"><span class="pln">&nbsp;</span></li><li class="L4"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;</span><span class="typ">Draw</span><span class="pln">&nbsp;the&nbsp;eigenvectors&nbsp;centered&nbsp;at&nbsp;mean&nbsp;of&nbsp;data</span><span class="pun">.</span><span class="pln">&nbsp;</span><span class="typ">These</span><span class="pln">&nbsp;lines&nbsp;show&nbsp;the</span></li><li class="L5"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;directions&nbsp;of&nbsp;maximum&nbsp;variations&nbsp;</span><span class="kwd">in</span><span class="pln">&nbsp;the&nbsp;dataset</span><span class="pun">.</span></li><li class="L6"><span class="pln">hold&nbsp;on</span><span class="pun">;</span></li><li class="L7"><span class="pln">drawLine</span><span class="pun">(</span><span class="pln">mu</span><span class="pun">,</span><span class="pln">&nbsp;mu&nbsp;</span><span class="pun">+</span><span class="pln">&nbsp;</span><span class="lit">1.5</span><span class="pln">&nbsp;</span><span class="pun">*</span><span class="pln">&nbsp;S</span><span class="pun">(</span><span class="lit">1</span><span class="pun">,</span><span class="lit">1</span><span class="pun">)</span><span class="pln">&nbsp;</span><span class="pun">*</span><span class="pln">&nbsp;U</span><span class="pun">(:,</span><span class="lit">1</span><span class="pun">)</span><span class="str">',&nbsp;'</span><span class="pun">-</span><span class="pln">k</span><span class="str">',&nbsp;'</span><span class="typ">LineWidth</span><span class="str">',&nbsp;2);</span></li><li class="L8"><span class="str">drawLine(mu,&nbsp;mu&nbsp;+&nbsp;1.5&nbsp;*&nbsp;S(2,2)&nbsp;*&nbsp;U(:,2)'</span><span class="pun">,</span><span class="pln">&nbsp;</span><span class="str">'-k'</span><span class="pun">,</span><span class="pln">&nbsp;</span><span class="str">'LineWidth'</span><span class="pun">,</span><span class="pln">&nbsp;</span><span class="lit">2</span><span class="pun">);</span></li><li class="L9"><span class="pln">hold&nbsp;off</span><span class="pun">;</span></li><li class="L0"><span class="pln">&nbsp;</span></li><li class="L1"><span class="pln">fprintf</span><span class="pun">(</span><span class="str">'Top&nbsp;eigenvector:&nbsp;\n'</span><span class="pun">);</span></li><li class="L2"><span class="pln">fprintf</span><span class="pun">(</span><span class="str">'&nbsp;U(:,1)&nbsp;=&nbsp;%f&nbsp;%f&nbsp;\n'</span><span class="pun">,</span><span class="pln">&nbsp;U</span><span class="pun">(</span><span class="lit">1</span><span class="pun">,</span><span class="lit">1</span><span class="pun">),</span><span class="pln">&nbsp;U</span><span class="pun">(</span><span class="lit">2</span><span class="pun">,</span><span class="lit">1</span><span class="pun">));</span></li><li class="L3"><span class="pln">fprintf</span><span class="pun">(</span><span class="str">'\n(you&nbsp;should&nbsp;expect&nbsp;to&nbsp;see&nbsp;-0.707107&nbsp;-0.707107)\n'</span><span class="pun">);</span></li><li class="L4"><span class="pln">&nbsp;</span></li><li class="L5"><span class="pln">fprintf</span><span class="pun">(</span><span class="str">'Program&nbsp;paused.&nbsp;Press&nbsp;enter&nbsp;to&nbsp;continue.\n'</span><span class="pun">);</span></li><li class="L6"><span class="pln">pause</span><span class="pun">;</span></li></ol></pre>
<p style="text-indent: 2em;">得到</p>
<p style="text-align:center"><img src="./CS229编程7：K-means聚类与主成分分析-码农场_files/6cbb8645gw1f9mphsovnuj20v40ncjsk.jpg" title="特征向量.png" alt="特征向量.png" data-tag="bdshare"></p>
<p style="text-indent: 2em;">这个效果跟<span style="text-indent: 32px;">《</span><a href="http://www.hankcs.com/ml/python-step-by-step-to-achieve-the-principal-component-analysis.html" target="_blank" style="text-indent: 32px; white-space: normal;">Python循序渐进主成分分析</a><span style="text-indent: 32px;">》相比真是弱爆了。</span></p>
<h3 id="h3-11"><span style="text-indent: 32px;">PCA降维<br></span></h3>
<p style="text-indent: 2em;"><span style="text-indent: 32px;">原向量乘以主成分矩阵前K列得到降维后的向量：<br></span></p>
<pre class="prettyprint lang-as3 linenums"><ol class="linenums"><li class="L0"><span class="kwd">function</span><span class="pln">&nbsp;Z&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;projectData</span><span class="pun">(</span><span class="pln">X</span><span class="pun">,</span><span class="pln">&nbsp;U</span><span class="pun">,</span><span class="pln">&nbsp;K</span><span class="pun">)</span></li><li class="L1"><span class="pun">%</span><span class="pln">PROJECTDATA&nbsp;</span><span class="typ">Computes</span><span class="pln">&nbsp;the&nbsp;reduced&nbsp;data&nbsp;representation&nbsp;</span><span class="kwd">when</span><span class="pln">&nbsp;projecting&nbsp;only&nbsp;</span></li><li class="L2"><span class="pun">%</span><span class="pln">on&nbsp;to&nbsp;the&nbsp;top&nbsp;k&nbsp;eigenvectors</span></li><li class="L3"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;&nbsp;Z&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;projectData</span><span class="pun">(</span><span class="pln">X</span><span class="pun">,</span><span class="pln">&nbsp;U</span><span class="pun">,</span><span class="pln">&nbsp;K</span><span class="pun">)</span><span class="pln">&nbsp;computes&nbsp;the&nbsp;projection&nbsp;of&nbsp;</span></li><li class="L4"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;&nbsp;the&nbsp;normalized&nbsp;inputs&nbsp;X&nbsp;</span><span class="kwd">into</span><span class="pln">&nbsp;the&nbsp;reduced&nbsp;dimensional&nbsp;space&nbsp;spanned&nbsp;</span><span class="kwd">by</span></li><li class="L5"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;&nbsp;the&nbsp;first&nbsp;K&nbsp;columns&nbsp;of&nbsp;U</span><span class="pun">.</span><span class="pln">&nbsp;</span><span class="typ">It</span><span class="pln">&nbsp;returns&nbsp;the&nbsp;projected&nbsp;examples&nbsp;</span><span class="kwd">in</span><span class="pln">&nbsp;Z</span><span class="pun">.</span></li><li class="L6"><span class="pun">%</span></li><li class="L7"><span class="pln">&nbsp;</span></li><li class="L8"><span class="pun">%</span><span class="pln">&nbsp;</span><span class="typ">You</span><span class="pln">&nbsp;need&nbsp;to&nbsp;</span><span class="kwd">return</span><span class="pln">&nbsp;the&nbsp;following&nbsp;variables&nbsp;correctly</span><span class="pun">.</span></li><li class="L9"><span class="pln">Z&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;zeros</span><span class="pun">(</span><span class="pln">size</span><span class="pun">(</span><span class="pln">X</span><span class="pun">,</span><span class="pln">&nbsp;</span><span class="lit">1</span><span class="pun">),</span><span class="pln">&nbsp;K</span><span class="pun">);</span></li><li class="L0"><span class="pln">&nbsp;</span></li><li class="L1"><span class="pun">%</span><span class="pln">&nbsp;</span><span class="pun">======================</span><span class="pln">&nbsp;YOUR&nbsp;CODE&nbsp;HERE&nbsp;</span><span class="pun">======================</span></li><li class="L2"><span class="pun">%</span><span class="pln">&nbsp;</span><span class="typ">Instructions</span><span class="pun">:</span><span class="pln">&nbsp;</span><span class="typ">Compute</span><span class="pln">&nbsp;the&nbsp;projection&nbsp;of&nbsp;the&nbsp;data&nbsp;</span><span class="kwd">using</span><span class="pln">&nbsp;only&nbsp;the&nbsp;top&nbsp;K&nbsp;</span></li><li class="L3"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eigenvectors&nbsp;</span><span class="kwd">in</span><span class="pln">&nbsp;U&nbsp;</span><span class="pun">(</span><span class="pln">first&nbsp;K&nbsp;columns</span><span class="pun">).</span><span class="pln">&nbsp;</span></li><li class="L4"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="typ">For</span><span class="pln">&nbsp;the&nbsp;i</span><span class="pun">-</span><span class="pln">th&nbsp;example&nbsp;X</span><span class="pun">(</span><span class="pln">i</span><span class="pun">,:),</span><span class="pln">&nbsp;the&nbsp;projection&nbsp;on&nbsp;to&nbsp;the&nbsp;k</span><span class="pun">-</span><span class="pln">th&nbsp;</span></li><li class="L5"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eigenvector&nbsp;</span><span class="kwd">is</span><span class="pln">&nbsp;given&nbsp;</span><span class="kwd">as</span><span class="pln">&nbsp;follows</span><span class="pun">:</span></li><li class="L6"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;X</span><span class="pun">(</span><span class="pln">i</span><span class="pun">,</span><span class="pln">&nbsp;</span><span class="pun">:)</span><span class="str">';</span></li><li class="L7"><span class="str">%&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;projection_k&nbsp;=&nbsp;x'</span><span class="pln">&nbsp;</span><span class="pun">*</span><span class="pln">&nbsp;U</span><span class="pun">(:,</span><span class="pln">&nbsp;k</span><span class="pun">);</span></li><li class="L8"><span class="pun">%</span></li><li class="L9"><span class="pln">&nbsp;</span></li><li class="L0"><span class="pln">x&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;X</span><span class="str">';</span></li><li class="L1"><span class="str">Z&nbsp;=&nbsp;x'</span><span class="pln">&nbsp;</span><span class="pun">*</span><span class="pln">&nbsp;U</span><span class="pun">(:,</span><span class="pln">&nbsp;</span><span class="lit">1</span><span class="pun">:</span><span class="pln">K</span><span class="pun">);</span></li><li class="L2"><span class="pln">&nbsp;</span></li><li class="L3"><span class="pun">%</span><span class="pln">&nbsp;</span><span class="pun">=============================================================</span></li><li class="L4"><span class="pln">&nbsp;</span></li><li class="L5"><span class="kwd">end</span></li></ol></pre>
<p style="text-indent: 2em;"><span style="text-indent: 32px;"></span>调用方法</p>
<pre class="prettyprint lang-as3 linenums"><ol class="linenums"><li class="L0"><span class="pun">%%</span><span class="pln">&nbsp;</span><span class="pun">===================</span><span class="pln">&nbsp;</span><span class="typ">Part</span><span class="pln">&nbsp;</span><span class="lit">3</span><span class="pun">:</span><span class="pln">&nbsp;</span><span class="typ">Dimension</span><span class="pln">&nbsp;</span><span class="typ">Reduction</span><span class="pln">&nbsp;</span><span class="pun">===================</span></li><li class="L1"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;</span><span class="typ">You</span><span class="pln">&nbsp;should&nbsp;now&nbsp;implement&nbsp;the&nbsp;projection&nbsp;step&nbsp;to&nbsp;map&nbsp;the&nbsp;data&nbsp;onto&nbsp;the&nbsp;</span></li><li class="L2"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;first&nbsp;k&nbsp;eigenvectors</span><span class="pun">.</span><span class="pln">&nbsp;</span><span class="typ">The</span><span class="pln">&nbsp;code&nbsp;will&nbsp;</span><span class="kwd">then</span><span class="pln">&nbsp;plot&nbsp;the&nbsp;data&nbsp;</span><span class="kwd">in</span><span class="pln">&nbsp;</span><span class="kwd">this</span><span class="pln">&nbsp;reduced&nbsp;</span></li><li class="L3"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;dimensional&nbsp;space</span><span class="pun">.</span><span class="pln">&nbsp;&nbsp;</span><span class="typ">This</span><span class="pln">&nbsp;will&nbsp;show&nbsp;you&nbsp;what&nbsp;the&nbsp;data&nbsp;looks&nbsp;like&nbsp;</span><span class="kwd">when</span><span class="pln">&nbsp;</span></li><li class="L4"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;</span><span class="kwd">using</span><span class="pln">&nbsp;only&nbsp;the&nbsp;corresponding&nbsp;eigenvectors&nbsp;to&nbsp;reconstruct&nbsp;it</span><span class="pun">.</span></li><li class="L5"><span class="pun">%</span></li><li class="L6"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;</span><span class="typ">You</span><span class="pln">&nbsp;should&nbsp;complete&nbsp;the&nbsp;code&nbsp;</span><span class="kwd">in</span><span class="pln">&nbsp;projectData</span><span class="pun">.</span><span class="pln">m</span></li><li class="L7"><span class="pun">%</span></li><li class="L8"><span class="pln">fprintf</span><span class="pun">(</span><span class="str">'\nDimension&nbsp;reduction&nbsp;on&nbsp;example&nbsp;dataset.\n\n'</span><span class="pun">);</span></li><li class="L9"><span class="pln">&nbsp;</span></li><li class="L0"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;</span><span class="typ">Plot</span><span class="pln">&nbsp;the&nbsp;normalized&nbsp;dataset&nbsp;</span><span class="pun">(</span><span class="pln">returned&nbsp;</span><span class="kwd">from</span><span class="pln">&nbsp;pca</span><span class="pun">)</span></li><li class="L1"><span class="pln">plot</span><span class="pun">(</span><span class="pln">X_norm</span><span class="pun">(:,</span><span class="pln">&nbsp;</span><span class="lit">1</span><span class="pun">),</span><span class="pln">&nbsp;X_norm</span><span class="pun">(:,</span><span class="pln">&nbsp;</span><span class="lit">2</span><span class="pun">),</span><span class="pln">&nbsp;</span><span class="str">'bo'</span><span class="pun">);</span></li><li class="L2"><span class="pln">axis</span><span class="pun">([-</span><span class="lit">4</span><span class="pln">&nbsp;</span><span class="lit">3</span><span class="pln">&nbsp;</span><span class="pun">-</span><span class="lit">4</span><span class="pln">&nbsp;</span><span class="lit">3</span><span class="pun">]);</span><span class="pln">&nbsp;axis&nbsp;square</span></li><li class="L3"><span class="pln">&nbsp;</span></li><li class="L4"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;</span><span class="typ">Project</span><span class="pln">&nbsp;the&nbsp;data&nbsp;onto&nbsp;K&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;</span><span class="lit">1</span><span class="pln">&nbsp;dimension</span></li><li class="L5"><span class="pln">K&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;</span><span class="lit">1</span><span class="pun">;</span></li><li class="L6"><span class="pln">Z&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;projectData</span><span class="pun">(</span><span class="pln">X_norm</span><span class="pun">,</span><span class="pln">&nbsp;U</span><span class="pun">,</span><span class="pln">&nbsp;K</span><span class="pun">);</span></li><li class="L7"><span class="pln">fprintf</span><span class="pun">(</span><span class="str">'Projection&nbsp;of&nbsp;the&nbsp;first&nbsp;example:&nbsp;%f\n'</span><span class="pun">,</span><span class="pln">&nbsp;Z</span><span class="pun">(</span><span class="lit">1</span><span class="pun">));</span></li><li class="L8"><span class="pln">fprintf</span><span class="pun">(</span><span class="str">'\n(this&nbsp;value&nbsp;should&nbsp;be&nbsp;about&nbsp;1.481274)\n\n'</span><span class="pun">);</span></li></ol></pre>
<h3 id="h3-12">还原数据</h3>
<p style="text-indent: 2em;">既然有projectData，那么就可以利用转置矩阵将映射后的数据（一维）有损还原：</p>
<pre class="prettyprint lang-as3 linenums"><ol class="linenums"><li class="L0"><span class="kwd">function</span><span class="pln">&nbsp;X_rec&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;recoverData</span><span class="pun">(</span><span class="pln">Z</span><span class="pun">,</span><span class="pln">&nbsp;U</span><span class="pun">,</span><span class="pln">&nbsp;K</span><span class="pun">)</span></li><li class="L1"><span class="pun">%</span><span class="pln">RECOVERDATA&nbsp;</span><span class="typ">Recovers</span><span class="pln">&nbsp;an&nbsp;approximation&nbsp;of&nbsp;the&nbsp;original&nbsp;data&nbsp;</span><span class="kwd">when</span><span class="pln">&nbsp;</span><span class="kwd">using</span><span class="pln">&nbsp;the&nbsp;</span></li><li class="L2"><span class="pun">%</span><span class="pln">projected&nbsp;data</span></li><li class="L3"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;&nbsp;X_rec&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;RECOVERDATA</span><span class="pun">(</span><span class="pln">Z</span><span class="pun">,</span><span class="pln">&nbsp;U</span><span class="pun">,</span><span class="pln">&nbsp;K</span><span class="pun">)</span><span class="pln">&nbsp;recovers&nbsp;an&nbsp;approximation&nbsp;the&nbsp;</span></li><li class="L4"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;&nbsp;original&nbsp;data&nbsp;that&nbsp;has&nbsp;been&nbsp;reduced&nbsp;to&nbsp;K&nbsp;dimensions</span><span class="pun">.</span><span class="pln">&nbsp;</span><span class="typ">It</span><span class="pln">&nbsp;returns&nbsp;the</span></li><li class="L5"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;&nbsp;approximate&nbsp;reconstruction&nbsp;</span><span class="kwd">in</span><span class="pln">&nbsp;X_rec</span><span class="pun">.</span></li><li class="L6"><span class="pun">%</span></li><li class="L7"><span class="pln">&nbsp;</span></li><li class="L8"><span class="pun">%</span><span class="pln">&nbsp;</span><span class="typ">You</span><span class="pln">&nbsp;need&nbsp;to&nbsp;</span><span class="kwd">return</span><span class="pln">&nbsp;the&nbsp;following&nbsp;variables&nbsp;correctly</span><span class="pun">.</span></li><li class="L9"><span class="pln">X_rec&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;zeros</span><span class="pun">(</span><span class="pln">size</span><span class="pun">(</span><span class="pln">Z</span><span class="pun">,</span><span class="pln">&nbsp;</span><span class="lit">1</span><span class="pun">),</span><span class="pln">&nbsp;size</span><span class="pun">(</span><span class="pln">U</span><span class="pun">,</span><span class="pln">&nbsp;</span><span class="lit">1</span><span class="pun">));</span></li><li class="L0"><span class="pln">&nbsp;</span></li><li class="L1"><span class="pun">%</span><span class="pln">&nbsp;</span><span class="pun">======================</span><span class="pln">&nbsp;YOUR&nbsp;CODE&nbsp;HERE&nbsp;</span><span class="pun">======================</span></li><li class="L2"><span class="pun">%</span><span class="pln">&nbsp;</span><span class="typ">Instructions</span><span class="pun">:</span><span class="pln">&nbsp;</span><span class="typ">Compute</span><span class="pln">&nbsp;the&nbsp;approximation&nbsp;of&nbsp;the&nbsp;data&nbsp;</span><span class="kwd">by</span><span class="pln">&nbsp;projecting&nbsp;back</span></li><li class="L3"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;onto&nbsp;the&nbsp;original&nbsp;space&nbsp;</span><span class="kwd">using</span><span class="pln">&nbsp;the&nbsp;top&nbsp;K&nbsp;eigenvectors&nbsp;</span><span class="kwd">in</span><span class="pln">&nbsp;U</span><span class="pun">.</span></li><li class="L4"><span class="pun">%</span></li><li class="L5"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="typ">For</span><span class="pln">&nbsp;the&nbsp;i</span><span class="pun">-</span><span class="pln">th&nbsp;example&nbsp;Z</span><span class="pun">(</span><span class="pln">i</span><span class="pun">,:),</span><span class="pln">&nbsp;the&nbsp;</span><span class="pun">(</span><span class="pln">approximate</span><span class="pun">)</span></li><li class="L6"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;recovered&nbsp;data&nbsp;</span><span class="kwd">for</span><span class="pln">&nbsp;dimension&nbsp;j&nbsp;</span><span class="kwd">is</span><span class="pln">&nbsp;given&nbsp;</span><span class="kwd">as</span><span class="pln">&nbsp;follows</span><span class="pun">:</span></li><li class="L7"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;v&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;Z</span><span class="pun">(</span><span class="pln">i</span><span class="pun">,</span><span class="pln">&nbsp;</span><span class="pun">:)</span><span class="str">';</span></li><li class="L8"><span class="str">%&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;recovered_j&nbsp;=&nbsp;v'</span><span class="pln">&nbsp;</span><span class="pun">*</span><span class="pln">&nbsp;U</span><span class="pun">(</span><span class="pln">j</span><span class="pun">,</span><span class="pln">&nbsp;</span><span class="lit">1</span><span class="pun">:</span><span class="pln">K</span><span class="pun">)</span><span class="str">';</span></li><li class="L9"><span class="str">%</span></li><li class="L0"><span class="str">%&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Notice&nbsp;that&nbsp;U(j,&nbsp;1:K)&nbsp;is&nbsp;a&nbsp;row&nbsp;vector.</span></li><li class="L1"><span class="str">%&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li class="L2"><span class="str">&nbsp;</span></li><li class="L3"><span class="str">v&nbsp;=&nbsp;Z'</span><span class="pun">;</span></li><li class="L4"><span class="pln">X_rec&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;v</span><span class="str">'&nbsp;*&nbsp;U(:,&nbsp;1:K)'</span><span class="pun">;</span></li><li class="L5"><span class="pln">&nbsp;</span></li><li class="L6"><span class="pun">%</span><span class="pln">&nbsp;</span><span class="pun">=============================================================</span></li><li class="L7"><span class="pln">&nbsp;</span></li><li class="L8"><span class="kwd">end</span></li></ol></pre>
<p style="text-indent: 2em;">这里的还原是有损的，<span style="text-indent: 32px;">毕竟少了一个维度。</span></p>
<p style="text-indent: 2em;">调用并可视化</p>
<pre class="prettyprint lang-as3 linenums"><ol class="linenums"><li class="L0"><span class="pln">X_rec&nbsp;&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;recoverData</span><span class="pun">(</span><span class="pln">Z</span><span class="pun">,</span><span class="pln">&nbsp;U</span><span class="pun">,</span><span class="pln">&nbsp;K</span><span class="pun">);</span></li><li class="L1"><span class="pln">fprintf</span><span class="pun">(</span><span class="str">'Approximation&nbsp;of&nbsp;the&nbsp;first&nbsp;example:&nbsp;%f&nbsp;%f\n'</span><span class="pun">,</span><span class="pln">&nbsp;X_rec</span><span class="pun">(</span><span class="lit">1</span><span class="pun">,</span><span class="pln">&nbsp;</span><span class="lit">1</span><span class="pun">),</span><span class="pln">&nbsp;X_rec</span><span class="pun">(</span><span class="lit">1</span><span class="pun">,</span><span class="pln">&nbsp;</span><span class="lit">2</span><span class="pun">));</span></li><li class="L2"><span class="pln">fprintf</span><span class="pun">(</span><span class="str">'\n(this&nbsp;value&nbsp;should&nbsp;be&nbsp;about&nbsp;&nbsp;-1.047419&nbsp;-1.047419)\n\n'</span><span class="pun">);</span></li><li class="L3"><span class="pln">&nbsp;</span></li><li class="L4"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;</span><span class="typ">Draw</span><span class="pln">&nbsp;lines&nbsp;connecting&nbsp;the&nbsp;projected&nbsp;points&nbsp;to&nbsp;the&nbsp;original&nbsp;points</span></li><li class="L5"><span class="pln">hold&nbsp;on</span><span class="pun">;</span></li><li class="L6"><span class="pln">plot</span><span class="pun">(</span><span class="pln">X_rec</span><span class="pun">(:,</span><span class="pln">&nbsp;</span><span class="lit">1</span><span class="pun">),</span><span class="pln">&nbsp;X_rec</span><span class="pun">(:,</span><span class="pln">&nbsp;</span><span class="lit">2</span><span class="pun">),</span><span class="pln">&nbsp;</span><span class="str">'ro'</span><span class="pun">);</span></li><li class="L7"><span class="kwd">for</span><span class="pln">&nbsp;i&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;</span><span class="lit">1</span><span class="pun">:</span><span class="pln">size</span><span class="pun">(</span><span class="pln">X_norm</span><span class="pun">,</span><span class="pln">&nbsp;</span><span class="lit">1</span><span class="pun">)</span></li><li class="L8"><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;drawLine</span><span class="pun">(</span><span class="pln">X_norm</span><span class="pun">(</span><span class="pln">i</span><span class="pun">,:),</span><span class="pln">&nbsp;X_rec</span><span class="pun">(</span><span class="pln">i</span><span class="pun">,:),</span><span class="pln">&nbsp;</span><span class="str">'--k'</span><span class="pun">,</span><span class="pln">&nbsp;</span><span class="str">'LineWidth'</span><span class="pun">,</span><span class="pln">&nbsp;</span><span class="lit">1</span><span class="pun">);</span></li><li class="L9"><span class="kwd">end</span></li><li class="L0"><span class="pln">hold&nbsp;off</span></li><li class="L1"><span class="pln">&nbsp;</span></li><li class="L2"><span class="pln">fprintf</span><span class="pun">(</span><span class="str">'Program&nbsp;paused.&nbsp;Press&nbsp;enter&nbsp;to&nbsp;continue.\n'</span><span class="pun">);</span></li><li class="L3"><span class="pln">pause</span><span class="pun">;</span></li></ol></pre>
<p style="text-indent: 2em;">得到</p>
<p style="text-align:center"><img src="./CS229编程7：K-means聚类与主成分分析-码农场_files/6cbb8645gw1f9mpxyjd4pj20v40nc403.jpg" title="还原.png" alt="还原.png" data-tag="bdshare"></p>
<p style="text-indent: 2em;">红色是降维后的一维点，蓝色是还原到二维的点。这个图还是很直观的，将投影解释得很清楚。</p>
<h2 id="h2-13">人脸数据集<br></h2>
<p style="text-indent: 2em;">这部分将PCA应用于人脸数据集，可视化PCA之后与还原的效果。</p>
<p style="text-indent: 2em;">每张数据都是32*32的灰度图，加载与可视化的代码与<a href="http://www.hankcs.com/ml/multi-class-classification-and-neural-networks-cs229.html" target="_blank">神经网络</a>那次相同，最后得到：</p>
<p style="text-align:center"><img src="./CS229编程7：K-means聚类与主成分分析-码农场_files/6cbb8645gw1f9mq23e6srj20v40ncgra.jpg" title="face.png" alt="face.png" data-tag="bdshare"></p>
<h3 id="h3-14">主成分分析</h3>
<p style="text-indent: 2em;">每张图片都是1024维的向量，跟普通的数据点没什么两样，对其进行主成分：</p>
<pre class="prettyprint lang-as3 linenums"><ol class="linenums"><li class="L0"><span class="pun">%%</span><span class="pln">&nbsp;</span><span class="pun">===========</span><span class="pln">&nbsp;</span><span class="typ">Part</span><span class="pln">&nbsp;</span><span class="lit">5</span><span class="pun">:</span><span class="pln">&nbsp;PCA&nbsp;on&nbsp;</span><span class="typ">Face</span><span class="pln">&nbsp;</span><span class="typ">Data</span><span class="pun">:</span><span class="pln">&nbsp;</span><span class="typ">Eigenfaces</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">===================</span></li><li class="L1"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;</span><span class="typ">Run</span><span class="pln">&nbsp;PCA&nbsp;</span><span class="kwd">and</span><span class="pln">&nbsp;visualize&nbsp;the&nbsp;eigenvectors&nbsp;which&nbsp;are&nbsp;</span><span class="kwd">in</span><span class="pln">&nbsp;</span><span class="kwd">this</span><span class="pln">&nbsp;</span><span class="kwd">case</span><span class="pln">&nbsp;eigenfaces</span></li><li class="L2"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;</span><span class="typ">We</span><span class="pln">&nbsp;display&nbsp;the&nbsp;first&nbsp;</span><span class="lit">36</span><span class="pln">&nbsp;eigenfaces</span><span class="pun">.</span></li><li class="L3"><span class="pun">%</span></li><li class="L4"><span class="pln">fprintf</span><span class="pun">([</span><span class="str">'\nRunning&nbsp;PCA&nbsp;on&nbsp;face&nbsp;dataset.\n'</span><span class="pln">&nbsp;</span><span class="pun">...</span></li><li class="L5"><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="str">'(this&nbsp;mght&nbsp;take&nbsp;a&nbsp;minute&nbsp;or&nbsp;two&nbsp;...)\n\n'</span><span class="pun">]);</span></li><li class="L6"><span class="pln">&nbsp;</span></li><li class="L7"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;</span><span class="typ">Before</span><span class="pln">&nbsp;running&nbsp;PCA</span><span class="pun">,</span><span class="pln">&nbsp;it&nbsp;</span><span class="kwd">is</span><span class="pln">&nbsp;important&nbsp;to&nbsp;first&nbsp;normalize&nbsp;X&nbsp;</span><span class="kwd">by</span><span class="pln">&nbsp;subtracting&nbsp;</span></li><li class="L8"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;the&nbsp;mean&nbsp;value&nbsp;</span><span class="kwd">from</span><span class="pln">&nbsp;each&nbsp;feature</span></li><li class="L9"><span class="pun">[</span><span class="pln">X_norm</span><span class="pun">,</span><span class="pln">&nbsp;mu</span><span class="pun">,</span><span class="pln">&nbsp;sigma</span><span class="pun">]</span><span class="pln">&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;featureNormalize</span><span class="pun">(</span><span class="pln">X</span><span class="pun">);</span></li><li class="L0"><span class="pln">&nbsp;</span></li><li class="L1"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;</span><span class="typ">Run</span><span class="pln">&nbsp;PCA</span></li><li class="L2"><span class="pun">[</span><span class="pln">U</span><span class="pun">,</span><span class="pln">&nbsp;S</span><span class="pun">]</span><span class="pln">&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;pca</span><span class="pun">(</span><span class="pln">X_norm</span><span class="pun">);</span></li><li class="L3"><span class="pln">&nbsp;</span></li><li class="L4"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;</span><span class="typ">Visualize</span><span class="pln">&nbsp;the&nbsp;top&nbsp;</span><span class="lit">36</span><span class="pln">&nbsp;eigenvectors&nbsp;found</span></li><li class="L5"><span class="pln">displayData</span><span class="pun">(</span><span class="pln">U</span><span class="pun">(:,</span><span class="pln">&nbsp;</span><span class="lit">1</span><span class="pun">:</span><span class="lit">36</span><span class="pun">)</span><span class="str">');</span></li><li class="L6"><span class="str">&nbsp;</span></li><li class="L7"><span class="str">fprintf('</span><span class="typ">Program</span><span class="pln">&nbsp;paused</span><span class="pun">.</span><span class="pln">&nbsp;</span><span class="typ">Press</span><span class="pln">&nbsp;enter&nbsp;to&nbsp;</span><span class="kwd">continue</span><span class="pun">.</span><span class="pln">\n</span><span class="str">');</span></li><li class="L8"><span class="str">pause;</span></li></ol></pre>
<p style="text-indent: 2em;">注意到特征向量跟原数据的维度一模一样，可以直接显示出来，于是这里可视化了前36个特征向量：</p>
<p style="text-align:center"><img src="./CS229编程7：K-means聚类与主成分分析-码农场_files/6cbb8645gw1f9mq63pxn8j20v40ncjvh.jpg" title="人脸主成分.png" alt="人脸主成分.png" data-tag="bdshare"></p>
<h3 id="h3-15">降维与还原<br></h3>
<p style="text-indent: 2em;">取维度=100，像上次那样进行降维与还原：</p>
<pre class="prettyprint lang-as3 linenums"><ol class="linenums"><li class="L0"><span class="pun">%%</span><span class="pln">&nbsp;</span><span class="pun">=============</span><span class="pln">&nbsp;</span><span class="typ">Part</span><span class="pln">&nbsp;</span><span class="lit">6</span><span class="pun">:</span><span class="pln">&nbsp;</span><span class="typ">Dimension</span><span class="pln">&nbsp;</span><span class="typ">Reduction</span><span class="pln">&nbsp;</span><span class="kwd">for</span><span class="pln">&nbsp;</span><span class="typ">Faces</span><span class="pln">&nbsp;</span><span class="pun">=================</span></li><li class="L1"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;</span><span class="typ">Project</span><span class="pln">&nbsp;images&nbsp;to&nbsp;the&nbsp;eigen&nbsp;space&nbsp;</span><span class="kwd">using</span><span class="pln">&nbsp;the&nbsp;top&nbsp;k&nbsp;eigenvectors&nbsp;</span></li><li class="L2"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;</span><span class="typ">If</span><span class="pln">&nbsp;you&nbsp;are&nbsp;applying&nbsp;a&nbsp;machine&nbsp;learning&nbsp;algorithm&nbsp;</span></li><li class="L3"><span class="pln">fprintf</span><span class="pun">(</span><span class="str">'\nDimension&nbsp;reduction&nbsp;for&nbsp;face&nbsp;dataset.\n\n'</span><span class="pun">);</span></li><li class="L4"><span class="pln">&nbsp;</span></li><li class="L5"><span class="pln">K&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;</span><span class="lit">100</span><span class="pun">;</span></li><li class="L6"><span class="pln">Z&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;projectData</span><span class="pun">(</span><span class="pln">X_norm</span><span class="pun">,</span><span class="pln">&nbsp;U</span><span class="pun">,</span><span class="pln">&nbsp;K</span><span class="pun">);</span></li><li class="L7"><span class="pln">&nbsp;</span></li><li class="L8"><span class="pln">fprintf</span><span class="pun">(</span><span class="str">'The&nbsp;projected&nbsp;data&nbsp;Z&nbsp;has&nbsp;a&nbsp;size&nbsp;of:&nbsp;'</span><span class="pun">)</span></li><li class="L9"><span class="pln">fprintf</span><span class="pun">(</span><span class="str">'%d&nbsp;'</span><span class="pun">,</span><span class="pln">&nbsp;size</span><span class="pun">(</span><span class="pln">Z</span><span class="pun">));</span></li><li class="L0"><span class="pln">&nbsp;</span></li><li class="L1"><span class="pln">fprintf</span><span class="pun">(</span><span class="str">'\n\nProgram&nbsp;paused.&nbsp;Press&nbsp;enter&nbsp;to&nbsp;continue.\n'</span><span class="pun">);</span></li><li class="L2"><span class="pln">pause</span><span class="pun">;</span></li><li class="L3"><span class="pln">&nbsp;</span></li><li class="L4"><span class="pun">%%</span><span class="pln">&nbsp;</span><span class="pun">====</span><span class="pln">&nbsp;</span><span class="typ">Part</span><span class="pln">&nbsp;</span><span class="lit">7</span><span class="pun">:</span><span class="pln">&nbsp;</span><span class="typ">Visualization</span><span class="pln">&nbsp;of&nbsp;</span><span class="typ">Faces</span><span class="pln">&nbsp;after&nbsp;PCA&nbsp;</span><span class="typ">Dimension</span><span class="pln">&nbsp;</span><span class="typ">Reduction</span><span class="pln">&nbsp;</span><span class="pun">====</span></li><li class="L5"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;</span><span class="typ">Project</span><span class="pln">&nbsp;images&nbsp;to&nbsp;the&nbsp;eigen&nbsp;space&nbsp;</span><span class="kwd">using</span><span class="pln">&nbsp;the&nbsp;top&nbsp;K&nbsp;eigen&nbsp;vectors&nbsp;</span><span class="kwd">and</span><span class="pln">&nbsp;</span></li><li class="L6"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;visualize&nbsp;only&nbsp;</span><span class="kwd">using</span><span class="pln">&nbsp;those&nbsp;K&nbsp;dimensions</span></li><li class="L7"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;</span><span class="typ">Compare</span><span class="pln">&nbsp;to&nbsp;the&nbsp;original&nbsp;input</span><span class="pun">,</span><span class="pln">&nbsp;which&nbsp;</span><span class="kwd">is</span><span class="pln">&nbsp;also&nbsp;displayed</span></li><li class="L8"><span class="pln">&nbsp;</span></li><li class="L9"><span class="pln">fprintf</span><span class="pun">(</span><span class="str">'\nVisualizing&nbsp;the&nbsp;projected&nbsp;(reduced&nbsp;dimension)&nbsp;faces.\n\n'</span><span class="pun">);</span></li><li class="L0"><span class="pln">&nbsp;</span></li><li class="L1"><span class="pln">K&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;</span><span class="lit">100</span><span class="pun">;</span></li><li class="L2"><span class="pln">X_rec&nbsp;&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;recoverData</span><span class="pun">(</span><span class="pln">Z</span><span class="pun">,</span><span class="pln">&nbsp;U</span><span class="pun">,</span><span class="pln">&nbsp;K</span><span class="pun">);</span></li><li class="L3"><span class="pln">&nbsp;</span></li><li class="L4"><span class="pun">%</span><span class="pln">&nbsp;</span><span class="typ">Display</span><span class="pln">&nbsp;normalized&nbsp;data</span></li><li class="L5"><span class="pln">subplot</span><span class="pun">(</span><span class="lit">1</span><span class="pun">,</span><span class="pln">&nbsp;</span><span class="lit">2</span><span class="pun">,</span><span class="pln">&nbsp;</span><span class="lit">1</span><span class="pun">);</span></li><li class="L6"><span class="pln">displayData</span><span class="pun">(</span><span class="pln">X_norm</span><span class="pun">(</span><span class="lit">1</span><span class="pun">:</span><span class="lit">100</span><span class="pun">,:));</span></li><li class="L7"><span class="pln">title</span><span class="pun">(</span><span class="str">'Original&nbsp;faces'</span><span class="pun">);</span></li><li class="L8"><span class="pln">axis&nbsp;square</span><span class="pun">;</span></li><li class="L9"><span class="pln">&nbsp;</span></li><li class="L0"><span class="pun">%</span><span class="pln">&nbsp;</span><span class="typ">Display</span><span class="pln">&nbsp;reconstructed&nbsp;data&nbsp;</span><span class="kwd">from</span><span class="pln">&nbsp;only&nbsp;k&nbsp;eigenfaces</span></li><li class="L1"><span class="pln">subplot</span><span class="pun">(</span><span class="lit">1</span><span class="pun">,</span><span class="pln">&nbsp;</span><span class="lit">2</span><span class="pun">,</span><span class="pln">&nbsp;</span><span class="lit">2</span><span class="pun">);</span></li><li class="L2"><span class="pln">displayData</span><span class="pun">(</span><span class="pln">X_rec</span><span class="pun">(</span><span class="lit">1</span><span class="pun">:</span><span class="lit">100</span><span class="pun">,:));</span></li><li class="L3"><span class="pln">title</span><span class="pun">(</span><span class="str">'Recovered&nbsp;faces'</span><span class="pun">);</span></li><li class="L4"><span class="pln">axis&nbsp;square</span><span class="pun">;</span></li><li class="L5"><span class="pln">&nbsp;</span></li><li class="L6"><span class="pln">fprintf</span><span class="pun">(</span><span class="str">'Program&nbsp;paused.&nbsp;Press&nbsp;enter&nbsp;to&nbsp;continue.\n'</span><span class="pun">);</span></li><li class="L7"><span class="pln">pause</span><span class="pun">;</span></li></ol></pre>
<p style="text-indent: 2em;">得到</p>
<p style="text-align:center"><img src="./CS229编程7：K-means聚类与主成分分析-码农场_files/6cbb8645gw1f9mq84y94sj20v40ncjvm.jpg" title="降维还原.png" alt="降维还原.png" data-tag="bdshare"></p>
<p style="text-indent: 2em;">这里没办法可视化100维的图片，因为其不再是像素表示的，而是更抽象的低维表示，只能可视化还原后的数据。即便是还原，也是有损的，不过感觉效果还不错，大家颜值下降不大。</p>
<h2 id="h2-16">为了可视化进行的PCA<br></h2>
<p style="text-indent: 2em;">拿上次那只丑鸟做例子，如果将每个像素放到RGB三维空间中去:</p>
<pre class="prettyprint lang-as3 linenums"><ol class="linenums"><li class="L0"><span class="pun">%%</span><span class="pln">&nbsp;</span><span class="pun">===</span><span class="pln">&nbsp;</span><span class="typ">Part</span><span class="pln">&nbsp;</span><span class="lit">8</span><span class="pun">(</span><span class="pln">a</span><span class="pun">):</span><span class="pln">&nbsp;</span><span class="typ">Optional</span><span class="pln">&nbsp;</span><span class="pun">(</span><span class="pln">ungraded</span><span class="pun">)</span><span class="pln">&nbsp;</span><span class="typ">Exercise</span><span class="pun">:</span><span class="pln">&nbsp;PCA&nbsp;</span><span class="kwd">for</span><span class="pln">&nbsp;</span><span class="typ">Visualization</span><span class="pln">&nbsp;</span><span class="pun">===</span></li><li class="L1"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;</span><span class="typ">One</span><span class="pln">&nbsp;useful&nbsp;application&nbsp;of&nbsp;PCA&nbsp;</span><span class="kwd">is</span><span class="pln">&nbsp;to&nbsp;</span><span class="kwd">use</span><span class="pln">&nbsp;it&nbsp;to&nbsp;visualize&nbsp;high</span><span class="pun">-</span><span class="pln">dimensional</span></li><li class="L2"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;data</span><span class="pun">.</span><span class="pln">&nbsp;</span><span class="typ">In</span><span class="pln">&nbsp;the&nbsp;</span><span class="kwd">last</span><span class="pln">&nbsp;K</span><span class="pun">-</span><span class="typ">Means</span><span class="pln">&nbsp;exercise&nbsp;you&nbsp;ran&nbsp;K</span><span class="pun">-</span><span class="typ">Means</span><span class="pln">&nbsp;on&nbsp;</span><span class="lit">3</span><span class="pun">-</span><span class="pln">dimensional&nbsp;</span></li><li class="L3"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;pixel&nbsp;colors&nbsp;of&nbsp;an&nbsp;image</span><span class="pun">.</span><span class="pln">&nbsp;</span><span class="typ">We</span><span class="pln">&nbsp;first&nbsp;visualize&nbsp;</span><span class="kwd">this</span><span class="pln">&nbsp;output&nbsp;</span><span class="kwd">in</span><span class="pln">&nbsp;</span><span class="lit">3D</span><span class="pun">,</span><span class="pln">&nbsp;</span><span class="kwd">and</span><span class="pln">&nbsp;</span><span class="kwd">then</span></li><li class="L4"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;apply&nbsp;PCA&nbsp;to&nbsp;obtain&nbsp;a&nbsp;visualization&nbsp;</span><span class="kwd">in</span><span class="pln">&nbsp;</span><span class="lit">2D</span><span class="pun">.</span></li><li class="L5"><span class="pln">&nbsp;</span></li><li class="L6"><span class="pln">close&nbsp;all</span><span class="pun">;</span><span class="pln">&nbsp;close&nbsp;all</span><span class="pun">;</span><span class="pln">&nbsp;clc</span></li><li class="L7"><span class="pln">&nbsp;</span></li><li class="L8"><span class="pun">%</span><span class="pln">&nbsp;</span><span class="typ">Re</span><span class="pun">-</span><span class="pln">load&nbsp;the&nbsp;image&nbsp;</span><span class="kwd">from</span><span class="pln">&nbsp;the&nbsp;previous&nbsp;exercise&nbsp;</span><span class="kwd">and</span><span class="pln">&nbsp;run&nbsp;K</span><span class="pun">-</span><span class="typ">Means</span><span class="pln">&nbsp;on&nbsp;it</span></li><li class="L9"><span class="pun">%</span><span class="pln">&nbsp;</span><span class="typ">For</span><span class="pln">&nbsp;</span><span class="kwd">this</span><span class="pln">&nbsp;to&nbsp;work</span><span class="pun">,</span><span class="pln">&nbsp;you&nbsp;need&nbsp;to&nbsp;complete&nbsp;the&nbsp;K</span><span class="pun">-</span><span class="typ">Means</span><span class="pln">&nbsp;assignment&nbsp;first</span></li><li class="L0"><span class="pln">A&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;</span><span class="kwd">double</span><span class="pun">(</span><span class="pln">imread</span><span class="pun">(</span><span class="str">'bird_small.png'</span><span class="pun">));</span></li><li class="L1"><span class="pln">&nbsp;</span></li><li class="L2"><span class="pun">%</span><span class="pln">&nbsp;</span><span class="typ">If</span><span class="pln">&nbsp;imread&nbsp;does&nbsp;</span><span class="kwd">not</span><span class="pln">&nbsp;work&nbsp;</span><span class="kwd">for</span><span class="pln">&nbsp;you</span><span class="pun">,</span><span class="pln">&nbsp;you&nbsp;can&nbsp;</span><span class="kwd">try</span><span class="pln">&nbsp;instead</span></li><li class="L3"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;&nbsp;load&nbsp;</span><span class="pun">(</span><span class="str">'bird_small.mat'</span><span class="pun">);</span></li><li class="L4"><span class="pln">&nbsp;</span></li><li class="L5"><span class="pln">A&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;A&nbsp;</span><span class="pun">/</span><span class="pln">&nbsp;</span><span class="lit">255</span><span class="pun">;</span></li><li class="L6"><span class="pln">img_size&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;size</span><span class="pun">(</span><span class="pln">A</span><span class="pun">);</span></li><li class="L7"><span class="pln">X&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;reshape</span><span class="pun">(</span><span class="pln">A</span><span class="pun">,</span><span class="pln">&nbsp;img_size</span><span class="pun">(</span><span class="lit">1</span><span class="pun">)</span><span class="pln">&nbsp;</span><span class="pun">*</span><span class="pln">&nbsp;img_size</span><span class="pun">(</span><span class="lit">2</span><span class="pun">),</span><span class="pln">&nbsp;</span><span class="lit">3</span><span class="pun">);</span></li><li class="L8"><span class="pln">K&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;</span><span class="lit">16</span><span class="pun">;</span><span class="pln">&nbsp;</span></li><li class="L9"><span class="pln">max_iters&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;</span><span class="lit">10</span><span class="pun">;</span></li><li class="L0"><span class="pln">initial_centroids&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;kMeansInitCentroids</span><span class="pun">(</span><span class="pln">X</span><span class="pun">,</span><span class="pln">&nbsp;K</span><span class="pun">);</span></li><li class="L1"><span class="pun">[</span><span class="pln">centroids</span><span class="pun">,</span><span class="pln">&nbsp;idx</span><span class="pun">]</span><span class="pln">&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;runkMeans</span><span class="pun">(</span><span class="pln">X</span><span class="pun">,</span><span class="pln">&nbsp;initial_centroids</span><span class="pun">,</span><span class="pln">&nbsp;max_iters</span><span class="pun">);</span></li><li class="L2"><span class="pln">&nbsp;</span></li><li class="L3"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;</span><span class="typ">Sample</span><span class="pln">&nbsp;</span><span class="lit">1000</span><span class="pln">&nbsp;random&nbsp;indexes&nbsp;</span><span class="pun">(</span><span class="pln">since&nbsp;working&nbsp;</span><span class="kwd">with</span><span class="pln">&nbsp;all&nbsp;the&nbsp;data&nbsp;</span><span class="kwd">is</span></li><li class="L4"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;too&nbsp;expensive</span><span class="pun">.</span><span class="pln">&nbsp;</span><span class="typ">If</span><span class="pln">&nbsp;you&nbsp;have&nbsp;a&nbsp;fast&nbsp;computer</span><span class="pun">,</span><span class="pln">&nbsp;you&nbsp;may&nbsp;increase&nbsp;</span><span class="kwd">this</span><span class="pun">.</span></li><li class="L5"><span class="pln">sel&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;floor</span><span class="pun">(</span><span class="pln">rand</span><span class="pun">(</span><span class="lit">1000</span><span class="pun">,</span><span class="pln">&nbsp;</span><span class="lit">1</span><span class="pun">)</span><span class="pln">&nbsp;</span><span class="pun">*</span><span class="pln">&nbsp;size</span><span class="pun">(</span><span class="pln">X</span><span class="pun">,</span><span class="pln">&nbsp;</span><span class="lit">1</span><span class="pun">))</span><span class="pln">&nbsp;</span><span class="pun">+</span><span class="pln">&nbsp;</span><span class="lit">1</span><span class="pun">;</span></li><li class="L6"><span class="pln">&nbsp;</span></li><li class="L7"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;</span><span class="typ">Setup</span><span class="pln">&nbsp;</span><span class="typ">Color</span><span class="pln">&nbsp;</span><span class="typ">Palette</span></li><li class="L8"><span class="pln">palette&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;hsv</span><span class="pun">(</span><span class="pln">K</span><span class="pun">);</span></li><li class="L9"><span class="pln">colors&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;palette</span><span class="pun">(</span><span class="pln">idx</span><span class="pun">(</span><span class="pln">sel</span><span class="pun">),</span><span class="pln">&nbsp;</span><span class="pun">:);</span></li><li class="L0"><span class="pln">&nbsp;</span></li><li class="L1"><span class="pun">%</span><span class="pln">&nbsp;&nbsp;</span><span class="typ">Visualize</span><span class="pln">&nbsp;the&nbsp;data&nbsp;</span><span class="kwd">and</span><span class="pln">&nbsp;centroid&nbsp;memberships&nbsp;</span><span class="kwd">in</span><span class="pln">&nbsp;</span><span class="lit">3D</span></li><li class="L2"><span class="pln">figure</span><span class="pun">;</span></li><li class="L3"><span class="pln">scatter3</span><span class="pun">(</span><span class="pln">X</span><span class="pun">(</span><span class="pln">sel</span><span class="pun">,</span><span class="pln">&nbsp;</span><span class="lit">1</span><span class="pun">),</span><span class="pln">&nbsp;X</span><span class="pun">(</span><span class="pln">sel</span><span class="pun">,</span><span class="pln">&nbsp;</span><span class="lit">2</span><span class="pun">),</span><span class="pln">&nbsp;X</span><span class="pun">(</span><span class="pln">sel</span><span class="pun">,</span><span class="pln">&nbsp;</span><span class="lit">3</span><span class="pun">),</span><span class="pln">&nbsp;</span><span class="lit">10</span><span class="pun">,</span><span class="pln">&nbsp;colors</span><span class="pun">);</span></li><li class="L4"><span class="pln">title</span><span class="pun">(</span><span class="str">'Pixel&nbsp;dataset&nbsp;plotted&nbsp;in&nbsp;3D.&nbsp;Color&nbsp;shows&nbsp;centroid&nbsp;memberships'</span><span class="pun">);</span></li><li class="L5"><span class="pln">&nbsp;</span></li><li class="L6"><span class="kwd">for</span><span class="pln">&nbsp;i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">:</span><span class="lit">2</span><span class="pun">:</span><span class="lit">360</span><span class="pln">&nbsp;&nbsp;</span></li><li class="L7"><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">%</span><span class="pln">view</span><span class="pun">(</span><span class="pln">a</span><span class="pun">,</span><span class="pln">b</span><span class="pun">):</span><span class="pln">a</span><span class="pun">????</span><span class="pln">b</span><span class="pun">????</span><span class="pln">&nbsp;&nbsp;</span></li><li class="L8"><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;view</span><span class="pun">(</span><span class="pln">i</span><span class="pun">,</span><span class="lit">20</span><span class="pun">);</span><span class="pln">&nbsp;&nbsp;</span></li><li class="L9"><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;pause</span><span class="pun">(</span><span class="lit">0.06</span><span class="pun">);</span></li><li class="L0"><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;frame</span><span class="pun">=</span><span class="pln">getframe</span><span class="pun">(</span><span class="pln">gcf</span><span class="pun">);</span></li><li class="L1"><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;im</span><span class="pun">=</span><span class="pln">frame2im</span><span class="pun">(</span><span class="pln">frame</span><span class="pun">);</span></li><li class="L2"><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">[</span><span class="pln">I</span><span class="pun">,</span><span class="pln">map</span><span class="pun">]=</span><span class="pln">rgb2ind</span><span class="pun">(</span><span class="pln">im</span><span class="pun">,</span><span class="lit">256</span><span class="pun">);</span></li><li class="L3"><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln">&nbsp;i</span><span class="pun">==</span><span class="lit">1</span></li><li class="L4"><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imwrite</span><span class="pun">(</span><span class="pln">I</span><span class="pun">,</span><span class="pln">map</span><span class="pun">,</span><span class="str">'ex.gif'</span><span class="pun">,</span><span class="str">'gif'</span><span class="pun">,</span><span class="str">'Loopcount'</span><span class="pun">,</span><span class="typ">Inf</span><span class="pun">,</span><span class="str">'DelayTime'</span><span class="pun">,</span><span class="lit">0.2</span><span class="pun">);</span></li><li class="L5"><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">else</span></li><li class="L6"><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imwrite</span><span class="pun">(</span><span class="pln">I</span><span class="pun">,</span><span class="pln">map</span><span class="pun">,</span><span class="str">'ex.gif'</span><span class="pun">,</span><span class="str">'gif'</span><span class="pun">,</span><span class="str">'WriteMode'</span><span class="pun">,</span><span class="str">'append'</span><span class="pun">,</span><span class="str">'DelayTime'</span><span class="pun">,</span><span class="lit">0.2</span><span class="pun">);</span><span class="pln">&nbsp;&nbsp;</span></li><li class="L7"><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">end</span></li><li class="L8"><span class="kwd">end</span><span class="pln">&nbsp;&nbsp;</span></li><li class="L9"><span class="pln">&nbsp;</span></li><li class="L0"><span class="pln">fprintf</span><span class="pun">(</span><span class="str">'Program&nbsp;paused.&nbsp;Press&nbsp;enter&nbsp;to&nbsp;continue.\n'</span><span class="pun">);</span></li><li class="L1"><span class="pln">pause</span><span class="pun">;</span></li></ol></pre>
<p style="text-indent: 2em;">我加了段动画，会得到：</p>
<p style="text-align: center"><img src="./CS229编程7：K-means聚类与主成分分析-码农场_files/6cbb8645gw1f9mqo4t80kg20v40ncqvc.gif" data-tag="bdshare"></p>
<p style="text-indent: 2em;">高维的数据并不适合可视化，因为你无法在论文里贴一段动画:-D，所有就有先降维再可视化的需求。</p>
<h3 id="h3-17">PCA降维</h3>
<p style="text-indent: 2em;">将其视作普通数据降维即可：</p>
<pre class="prettyprint lang-as3 linenums"><ol class="linenums"><li class="L0"><span class="pun">%%</span><span class="pln">&nbsp;</span><span class="pun">===</span><span class="pln">&nbsp;</span><span class="typ">Part</span><span class="pln">&nbsp;</span><span class="lit">8</span><span class="pun">(</span><span class="pln">b</span><span class="pun">):</span><span class="pln">&nbsp;</span><span class="typ">Optional</span><span class="pln">&nbsp;</span><span class="pun">(</span><span class="pln">ungraded</span><span class="pun">)</span><span class="pln">&nbsp;</span><span class="typ">Exercise</span><span class="pun">:</span><span class="pln">&nbsp;PCA&nbsp;</span><span class="kwd">for</span><span class="pln">&nbsp;</span><span class="typ">Visualization</span><span class="pln">&nbsp;</span><span class="pun">===</span></li><li class="L1"><span class="pun">%</span><span class="pln">&nbsp;</span><span class="typ">Use</span><span class="pln">&nbsp;PCA&nbsp;to&nbsp;project&nbsp;</span><span class="kwd">this</span><span class="pln">&nbsp;cloud&nbsp;to&nbsp;</span><span class="lit">2D</span><span class="pln">&nbsp;</span><span class="kwd">for</span><span class="pln">&nbsp;visualization</span></li><li class="L2"><span class="pln">&nbsp;</span></li><li class="L3"><span class="pun">%</span><span class="pln">&nbsp;</span><span class="typ">Subtract</span><span class="pln">&nbsp;the&nbsp;mean&nbsp;to&nbsp;</span><span class="kwd">use</span><span class="pln">&nbsp;PCA</span></li><li class="L4"><span class="pun">[</span><span class="pln">X_norm</span><span class="pun">,</span><span class="pln">&nbsp;mu</span><span class="pun">,</span><span class="pln">&nbsp;sigma</span><span class="pun">]</span><span class="pln">&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;featureNormalize</span><span class="pun">(</span><span class="pln">X</span><span class="pun">);</span></li><li class="L5"><span class="pln">&nbsp;</span></li><li class="L6"><span class="pun">%</span><span class="pln">&nbsp;PCA&nbsp;</span><span class="kwd">and</span><span class="pln">&nbsp;project&nbsp;the&nbsp;data&nbsp;to&nbsp;</span><span class="lit">2D</span></li><li class="L7"><span class="pun">[</span><span class="pln">U</span><span class="pun">,</span><span class="pln">&nbsp;S</span><span class="pun">]</span><span class="pln">&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;pca</span><span class="pun">(</span><span class="pln">X_norm</span><span class="pun">);</span></li><li class="L8"><span class="pln">Z&nbsp;</span><span class="pun">=</span><span class="pln">&nbsp;projectData</span><span class="pun">(</span><span class="pln">X_norm</span><span class="pun">,</span><span class="pln">&nbsp;U</span><span class="pun">,</span><span class="pln">&nbsp;</span><span class="lit">2</span><span class="pun">);</span></li><li class="L9"><span class="pln">&nbsp;</span></li><li class="L0"><span class="pun">%</span><span class="pln">&nbsp;</span><span class="typ">Plot</span><span class="pln">&nbsp;</span><span class="kwd">in</span><span class="pln">&nbsp;</span><span class="lit">2D</span></li><li class="L1"><span class="pln">figure</span><span class="pun">;</span></li><li class="L2"><span class="pln">plotDataPoints</span><span class="pun">(</span><span class="pln">Z</span><span class="pun">(</span><span class="pln">sel</span><span class="pun">,</span><span class="pln">&nbsp;</span><span class="pun">:),</span><span class="pln">&nbsp;idx</span><span class="pun">(</span><span class="pln">sel</span><span class="pun">),</span><span class="pln">&nbsp;K</span><span class="pun">);</span></li><li class="L3"><span class="pln">title</span><span class="pun">(</span><span class="str">'Pixel&nbsp;dataset&nbsp;plotted&nbsp;in&nbsp;2D,&nbsp;using&nbsp;PCA&nbsp;for&nbsp;dimensionality&nbsp;reduction'</span><span class="pun">);</span></li><li class="L4"><span class="pln">fprintf</span><span class="pun">(</span><span class="str">'Program&nbsp;paused.&nbsp;Press&nbsp;enter&nbsp;to&nbsp;continue.\n'</span><span class="pun">);</span></li><li class="L5"><span class="pln">pause</span><span class="pun">;</span></li></ol></pre>
<p style="text-indent: 2em;">得到</p>
<p style="text-align:center"><img src="./CS229编程7：K-means聚类与主成分分析-码农场_files/6cbb8645gw1f9mqnnvnjkj20v40nc79j.jpg" title="降维丑鸟.png" alt="降维丑鸟.png" data-tag="bdshare"></p>
<p style="text-indent: 2em;">如果用鼠标旋转上面的三维视图，应该可以得到类似这张平面图的视图，这就是降维的直观解释了。</p>
<p style="text-indent: 2em;"></p>
<p class="post-copyright"><a href="http://www.hankcs.com/license/" target="_blank"><img alt="知识共享许可协议" style="border-width: 0px;margin: 0 !important;" src="./CS229编程7：K-means聚类与主成分分析-码农场_files/CC-BY-NC-SA-icon-88x31.png" width="88" height="31" border="0" vspace="0" title="知识共享许可协议" data-tag="bdshare"></a>&nbsp;<a href="http://www.hankcs.com/license/" target="_blank" textvalue="知识共享署名-非商业性使用-相同方式共享">知识共享署名-非商业性使用-相同方式共享</a>：<a href="http://www.hankcs.com/">码农场</a> » <a href="http://www.hankcs.com/ml/principal-component-analysis-k-means-cs229.html">CS229编程7：K-means聚类与主成分分析</a></p>		</article>
								<div class="action-share bdsharebuttonbox bdshare-button-style0-24" data-bd-bind="1534732865932">
			<span>分享到：</span><a class="bds_qzone" data-cmd="qzone" title="分享到QQ空间"></a><a class="bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a><a class="bds_weixin" data-cmd="weixin" title="分享到微信"></a><a class="bds_tqq" data-cmd="tqq" title="分享到腾讯微博"></a><a class="bds_sqq" data-cmd="sqq" title="分享到QQ好友"></a><a class="bds_bdhome" data-cmd="bdhome" title="分享到百度新首页"></a><a class="bds_tqf" data-cmd="tqf" title="分享到腾讯朋友"></a><a class="bds_renren" data-cmd="renren" title="分享到人人网"></a><a class="bds_diandian" data-cmd="diandian" title="分享到点点网"></a><a class="bds_youdao" data-cmd="youdao" title="分享到有道云笔记"></a><a class="bds_ty" data-cmd="ty" title="分享到天涯社区"></a><a class="bds_kaixin001" data-cmd="kaixin001" title="分享到开心网"></a><a class="bds_taobao" data-cmd="taobao"></a><a class="bds_douban" data-cmd="douban" title="分享到豆瓣网"></a><a class="bds_fbook" data-cmd="fbook" title="分享到Facebook"></a><a class="bds_twi" data-cmd="twi" title="分享到Twitter"></a><a class="bds_mail" data-cmd="mail" title="分享到邮件分享"></a><a class="bds_copy" data-cmd="copy" title="分享到复制网址"></a><a class="bds_more" data-cmd="more">更多</a> <span>(</span><a class="bds_count" data-cmd="count" title="累计分享1次">1</a><span>)</span>		</div>
		<div class="article-tags">继续浏览有关 <a href="http://www.hankcs.com/ml/"><i class="fa fa-folder-open"></i> 机器学习</a><a href="http://www.hankcs.com/tag/cs229/" rel="tag">CS229</a><a href="http://www.hankcs.com/tag/matlab/" rel="tag">matlab</a> 的文章</div>		<div class="asb asb-post asb-post-02"><script async="" src="./CS229编程7：K-means聚类与主成分分析-码农场_files/f(8).txt"></script>
<!-- 文章页正文下 页首横幅 -->
<ins class="adsbygoogle" style="display:inline-block;width:728px;height:90px" data-ad-client="ca-pub-1152644711996772" data-ad-slot="2657945648" data-adsbygoogle-status="done"><ins id="aswift_1_expand" style="display:inline-table;border:none;height:90px;margin:0;padding:0;position:relative;visibility:visible;width:728px;background-color:transparent;"><ins id="aswift_1_anchor" style="display:block;border:none;height:90px;margin:0;padding:0;position:relative;visibility:visible;width:728px;background-color:transparent;"><iframe width="728" height="90" frameborder="0" marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no" allowfullscreen="true" onload="var i=this.id,s=window.google_iframe_oncopy,H=s&amp;&amp;s.handlers,h=H&amp;&amp;H[i],w=this.contentWindow,d;try{d=w.document}catch(e){}if(h&amp;&amp;d&amp;&amp;(!d.body||!d.body.firstChild)){if(h.call){setTimeout(h,0)}else if(h.match){try{h=s.upd(h,i)}catch(e){}w.location.replace(h)}}" id="aswift_1" name="aswift_1" style="left:0;position:absolute;top:0;width:728px;height:90px;" src="./CS229编程7：K-means聚类与主成分分析-码农场_files/saved_resource(16).html"></iframe></ins></ins></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></div>		<nav class="article-nav">
			<span class="article-nav-prev">上一篇 <a href="http://www.hankcs.com/ml/python-step-by-step-to-achieve-the-principal-component-analysis.html" rel="prev">Python循序渐进主成分分析</a></span>
			<span class="article-nav-next"><a href="http://www.hankcs.com/ml/anomaly-detection-and-recommender-systems-cs229.html" rel="next">CS229编程8：异常检测与推荐系统</a> 下一篇</span>
		</nav>
				<div class="asb asb-post asb-post-03"><script async="" src="./CS229编程7：K-means聚类与主成分分析-码农场_files/f(8).txt"></script>
<!-- 匹配内容 -->
<ins class="adsbygoogle" style="display: block; height: 466px;" data-ad-client="ca-pub-1152644711996772" data-ad-slot="7343699642" data-ad-format="autorelaxed" data-adsbygoogle-status="done"><ins id="aswift_2_expand" style="display:inline-table;border:none;height:466px;margin:0;padding:0;position:relative;visibility:visible;width:778px;background-color:transparent;"><ins id="aswift_2_anchor" style="display:block;border:none;height:466px;margin:0;padding:0;position:relative;visibility:visible;width:778px;background-color:transparent;"><iframe width="778" height="466" frameborder="0" marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no" allowfullscreen="true" onload="var i=this.id,s=window.google_iframe_oncopy,H=s&amp;&amp;s.handlers,h=H&amp;&amp;H[i],w=this.contentWindow,d;try{d=w.document}catch(e){}if(h&amp;&amp;d&amp;&amp;(!d.body||!d.body.firstChild)){if(h.call){setTimeout(h,0)}else if(h.match){try{h=s.upd(h,i)}catch(e){}w.location.replace(h)}}" id="aswift_2" name="aswift_2" style="left:0;position:absolute;top:0;width:778px;height:466px;" src="./CS229编程7：K-means聚类与主成分分析-码农场_files/saved_resource(17).html"></iframe></ins></ins></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></div>		<div class="title" id="comments">
	<h3>评论 <b>4</b></h3>
</div>
<div id="respond" class="no_webshot">
		
	<form action="http://www.hankcs.com/wp-comments-post.php" method="post" id="commentform">
		<div class="comt">
			<div class="comt-title">
				<img alt="" data-src="http://0.gravatar.com/avatar/?s=50&amp;d=http%3A%2F%2Fwww.hankcs.com%2Fwp-content%2Fthemes%2Fdux%2Fimg%2Favatar-default.png&amp;r=g" srcset="http://1.gravatar.com/avatar/?s=100&amp;d=http%3A%2F%2Fwww.hankcs.com%2Fwp-content%2Fthemes%2Fdux%2Fimg%2Favatar-default.png&amp;r=g 2x" class="avatar avatar-50 photo avatar-default" height="50" width="50" src="./CS229编程7：K-means聚类与主成分分析-码农场_files/avatar-default.png">				<p><a id="cancel-comment-reply-link" href="javascript:;">取消</a></p>
			</div>
			<div class="comt-box">
				<textarea placeholder="此处不受理任何开源项目问题，请在GitHub上发issue ，大家一起讨论，谢谢。" class="input-block-level comt-area" name="comment" id="comment" cols="100%" rows="3" tabindex="1" onkeydown="if(event.ctrlKey&amp;&amp;event.keyCode==13){document.getElementById(&#39;submit&#39;).click();return false};"></textarea>
				<div class="comt-ctrl">
					<div class="comt-tips"><input type="hidden" name="comment_post_ID" value="8446" id="comment_post_ID">
<input type="hidden" name="comment_parent" id="comment_parent" value="0">
<p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="ed0497d278"></p><label for="comment_mail_notify" class="checkbox inline hide" style="padding-top:0"><input type="checkbox" name="comment_mail_notify" id="comment_mail_notify" value="comment_mail_notify" checked="checked">有人回复时邮件通知我</label><p style="display: none;"></p><div class="comt-tip comt-loading" style="display: none;">评论提交中...</div><div class="comt-tip comt-error" style="display: none;">#</div></div>
					<button type="submit" name="submit" id="submit" tabindex="5">提交评论</button>
					<!-- <span data-type="comment-insert-smilie" class="muted comt-smilie"><i class="icon-thumbs-up icon12"></i> 表情</span> -->
				</div>
			</div>

												<div class="comt-comterinfo" id="comment-author-info">
						<ul>
							<li class="form-inline"><label class="hide" for="author">昵称</label><input class="ipt" type="text" name="author" id="author" value="" tabindex="2" placeholder="昵称"><span class="text-muted">昵称 (必填)</span></li>
							<li class="form-inline"><label class="hide" for="email">邮箱</label><input class="ipt" type="text" name="email" id="email" value="" tabindex="3" placeholder="邮箱"><span class="text-muted">邮箱 (必填)</span></li>
							<li class="form-inline"><label class="hide" for="url">网址</label><input class="ipt" type="text" name="url" id="url" value="" tabindex="4" placeholder="网址"><span class="text-muted">网址</span></li>
						</ul>
					</div>
									</div>

	<input type="hidden" id="ak_js" name="ak_js" value="1534732865692"></form>
	</div>
<div id="postcomments">
	<ol class="commentlist">
		<li class="comment even thread-even depth-1" id="comment-4511"><span class="comt-f">#4</span><div class="comt-avatar"><img alt="" data-src="http://2.gravatar.com/avatar/?s=50&amp;d=http%3A%2F%2Fwww.hankcs.com%2Fwp-content%2Fthemes%2Fdux%2Fimg%2Favatar-default.png&amp;r=g" srcset="http://2.gravatar.com/avatar/?s=100&amp;d=http%3A%2F%2Fwww.hankcs.com%2Fwp-content%2Fthemes%2Fdux%2Fimg%2Favatar-default.png&amp;r=g 2x" class="avatar avatar-50 photo avatar-default" height="50" width="50" src="./CS229编程7：K-means聚类与主成分分析-码农场_files/avatar-default.png"></div><div class="comt-main" id="div-comment-4511"><p>笑脸是  :  )</p>
<div class="comt-meta"><span class="comt-author"><a href="http://weibo.com/1966337717" rel="external nofollow" class="url" target="_blank">也是wo</a></span>2年前 (2017-02-10)<a rel="nofollow" class="comment-reply-link" href="javascript:;" onclick="return addComment.moveForm( &quot;div-comment-4511&quot;, &quot;4511&quot;, &quot;respond&quot;, &quot;8446&quot; )" aria-label="回复给也是wo">回复</a></div></div></li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-4510"><span class="comt-f">#3</span><div class="comt-avatar"><img alt="" data-src="http://0.gravatar.com/avatar/?s=50&amp;d=http%3A%2F%2Fwww.hankcs.com%2Fwp-content%2Fthemes%2Fdux%2Fimg%2Favatar-default.png&amp;r=g" srcset="http://0.gravatar.com/avatar/?s=100&amp;d=http%3A%2F%2Fwww.hankcs.com%2Fwp-content%2Fthemes%2Fdux%2Fimg%2Favatar-default.png&amp;r=g 2x" class="avatar avatar-50 photo avatar-default" height="50" width="50" src="./CS229编程7：K-means聚类与主成分分析-码农场_files/avatar-default.png"></div><div class="comt-main" id="div-comment-4510"><p>稍微简洁点</p>
<div class="comt-meta"><span class="comt-author"><a href="http://weibo.com/1966337717" rel="external nofollow" class="url" target="_blank">也是wo</a></span>2年前 (2017-02-10)<a rel="nofollow" class="comment-reply-link" href="javascript:;" onclick="return addComment.moveForm( &quot;div-comment-4510&quot;, &quot;4510&quot;, &quot;respond&quot;, &quot;8446&quot; )" aria-label="回复给也是wo">回复</a></div></div></li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-4509"><span class="comt-f">#2</span><div class="comt-avatar"><img alt="" data-src="http://0.gravatar.com/avatar/?s=50&amp;d=http%3A%2F%2Fwww.hankcs.com%2Fwp-content%2Fthemes%2Fdux%2Fimg%2Favatar-default.png&amp;r=g" srcset="http://0.gravatar.com/avatar/?s=100&amp;d=http%3A%2F%2Fwww.hankcs.com%2Fwp-content%2Fthemes%2Fdux%2Fimg%2Favatar-default.png&amp;r=g 2x" class="avatar avatar-50 photo avatar-default" height="50" width="50" src="./CS229编程7：K-means聚类与主成分分析-码农场_files/avatar-default.png"></div><div class="comt-main" id="div-comment-4509"><p>findClosestCentroids.m 我的实现是:<br>
K = size(centroids, 1);<br>
idx = zeros(size(X,1), 1);<br>
[m, n] = size(X)<br>
for i = 1 : m<br>
    X_tmp = ones(K, 1) * X(i, <img src="./CS229编程7：K-means聚类与主成分分析-码农场_files/icon_smile.gif"> ;<br>
    [val, idx(i, 1)]= min(sum((X_tmp – centroids).^2, 2), [], 1);<br>
end</p>
<div class="comt-meta"><span class="comt-author"><a href="http://weibo.com/1966337717" rel="external nofollow" class="url" target="_blank">也是wo</a></span>2年前 (2017-02-10)<a rel="nofollow" class="comment-reply-link" href="javascript:;" onclick="return addComment.moveForm( &quot;div-comment-4509&quot;, &quot;4509&quot;, &quot;respond&quot;, &quot;8446&quot; )" aria-label="回复给也是wo">回复</a></div></div></li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-4508"><span class="comt-f">#1</span><div class="comt-avatar"><img alt="" data-src="http://2.gravatar.com/avatar/?s=50&amp;d=http%3A%2F%2Fwww.hankcs.com%2Fwp-content%2Fthemes%2Fdux%2Fimg%2Favatar-default.png&amp;r=g" srcset="http://0.gravatar.com/avatar/?s=100&amp;d=http%3A%2F%2Fwww.hankcs.com%2Fwp-content%2Fthemes%2Fdux%2Fimg%2Favatar-default.png&amp;r=g 2x" class="avatar avatar-50 photo avatar-default" height="50" width="50" src="./CS229编程7：K-means聚类与主成分分析-码农场_files/avatar-default.png"></div><div class="comt-main" id="div-comment-4508"><p>computeCentroids.m 我的实现是:<br>
[m n] = size(X);<br>
centroids = zeros(K, n);<br>
for i = 1 : K<br>
    num = size(find(i == idx), 1);<br>
    centroids(i, <img src="./CS229编程7：K-means聚类与主成分分析-码农场_files/icon_smile.gif">  = sum(X(find(i == idx), <img src="./CS229编程7：K-means聚类与主成分分析-码农场_files/icon_smile.gif"> , 1) ./ num;<br>
end</p>
<div class="comt-meta"><span class="comt-author"><a href="http://weibo.com/1966337717" rel="external nofollow" class="url" target="_blank">也是wo</a></span>2年前 (2017-02-10)<a rel="nofollow" class="comment-reply-link" href="javascript:;" onclick="return addComment.moveForm( &quot;div-comment-4508&quot;, &quot;4508&quot;, &quot;respond&quot;, &quot;8446&quot; )" aria-label="回复给也是wo">回复</a></div></div></li><!-- #comment-## -->
	</ol>
	<div class="pagenav">
			</div>
</div>
	</div>
	</div>
	<aside class="sidebar">
<div class="widget widget_categories affix-top" style="top: 0px;"><h3>栏目分类</h3><form action="http://www.hankcs.com/" method="get"><label class="screen-reader-text" for="cat">栏目分类</label><select name="cat" id="cat" class="postform">
	<option value="-1">选择分类目录</option>
	<option class="level-0" value="18">ACG&nbsp;&nbsp;(7)</option>
	<option class="level-1" value="117">&nbsp;&nbsp;&nbsp;游戏&nbsp;&nbsp;(5)</option>
	<option class="level-0" value="7">Web开发&nbsp;&nbsp;(80)</option>
	<option class="level-1" value="64">&nbsp;&nbsp;&nbsp;BAE&nbsp;&nbsp;(13)</option>
	<option class="level-1" value="11">&nbsp;&nbsp;&nbsp;Linux相关&nbsp;&nbsp;(9)</option>
	<option class="level-1" value="54">&nbsp;&nbsp;&nbsp;Mac OS&nbsp;&nbsp;(1)</option>
	<option class="level-1" value="27">&nbsp;&nbsp;&nbsp;WordPress&nbsp;&nbsp;(8)</option>
	<option class="level-1" value="65">&nbsp;&nbsp;&nbsp;Yii&nbsp;&nbsp;(17)</option>
	<option class="level-1" value="2">&nbsp;&nbsp;&nbsp;主机域名&nbsp;&nbsp;(26)</option>
	<option class="level-1" value="66">&nbsp;&nbsp;&nbsp;数据库&nbsp;&nbsp;(4)</option>
	<option class="level-0" value="140">信息安全&nbsp;&nbsp;(3)</option>
	<option class="level-0" value="1">其他类别&nbsp;&nbsp;(184)</option>
	<option class="level-1" value="78">&nbsp;&nbsp;&nbsp;心情&nbsp;&nbsp;(1)</option>
	<option class="level-1" value="15">&nbsp;&nbsp;&nbsp;旧的博文&nbsp;&nbsp;(170)</option>
	<option class="level-0" value="87">操作系统&nbsp;&nbsp;(3)</option>
	<option class="level-1" value="88">&nbsp;&nbsp;&nbsp;Windows&nbsp;&nbsp;(2)</option>
	<option class="level-0" value="81">数学基礎&nbsp;&nbsp;(3)</option>
	<option class="level-0" value="4">日语教程&nbsp;&nbsp;(120)</option>
	<option class="level-1" value="96">&nbsp;&nbsp;&nbsp;口译&nbsp;&nbsp;(1)</option>
	<option class="level-1" value="59">&nbsp;&nbsp;&nbsp;新编日语商务贸易会话&nbsp;&nbsp;(14)</option>
	<option class="level-1" value="19">&nbsp;&nbsp;&nbsp;新编日语阅读文选&nbsp;&nbsp;(34)</option>
	<option class="level-2" value="44">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;第一册&nbsp;&nbsp;(20)</option>
	<option class="level-2" value="61">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;第三册&nbsp;&nbsp;(2)</option>
	<option class="level-2" value="20">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;第二册&nbsp;&nbsp;(10)</option>
	<option class="level-1" value="46">&nbsp;&nbsp;&nbsp;日语入门&nbsp;&nbsp;(2)</option>
	<option class="level-1" value="62">&nbsp;&nbsp;&nbsp;日语听力&nbsp;&nbsp;(2)</option>
	<option class="level-1" value="5">&nbsp;&nbsp;&nbsp;日语综合教程&nbsp;&nbsp;(64)</option>
	<option class="level-2" value="120">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;第七册&nbsp;&nbsp;(14)</option>
	<option class="level-2" value="50">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;第三册&nbsp;&nbsp;(7)</option>
	<option class="level-2" value="73">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;第五册&nbsp;&nbsp;(12)</option>
	<option class="level-2" value="98">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;第六册&nbsp;&nbsp;(18)</option>
	<option class="level-2" value="6">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;第四册&nbsp;&nbsp;(12)</option>
	<option class="level-1" value="86">&nbsp;&nbsp;&nbsp;月の珊瑚&nbsp;&nbsp;(3)</option>
	<option class="level-0" value="131">机器学习&nbsp;&nbsp;(58)</option>
	<option class="level-0" value="16">经济人文&nbsp;&nbsp;(19)</option>
	<option class="level-1" value="17">&nbsp;&nbsp;&nbsp;国际贸易理论与政策&nbsp;&nbsp;(9)</option>
	<option class="level-1" value="30">&nbsp;&nbsp;&nbsp;当代世界经济与政治&nbsp;&nbsp;(3)</option>
	<option class="level-0" value="9">编程开发&nbsp;&nbsp;(557)</option>
	<option class="level-1" value="8">&nbsp;&nbsp;&nbsp;Android&nbsp;&nbsp;(30)</option>
	<option class="level-1" value="13">&nbsp;&nbsp;&nbsp;C++&nbsp;&nbsp;(237)</option>
	<option class="level-1" value="25">&nbsp;&nbsp;&nbsp;Drupal&nbsp;&nbsp;(23)</option>
	<option class="level-1" value="10">&nbsp;&nbsp;&nbsp;Java&nbsp;&nbsp;(69)</option>
	<option class="level-1" value="123">&nbsp;&nbsp;&nbsp;Javascript&nbsp;&nbsp;(1)</option>
	<option class="level-1" value="24">&nbsp;&nbsp;&nbsp;PHP&nbsp;&nbsp;(57)</option>
	<option class="level-1" value="94">&nbsp;&nbsp;&nbsp;Python&nbsp;&nbsp;(8)</option>
	<option class="level-1" value="14">&nbsp;&nbsp;&nbsp;汇编逆向&nbsp;&nbsp;(12)</option>
	<option class="level-1" value="70">&nbsp;&nbsp;&nbsp;算法&nbsp;&nbsp;(236)</option>
	<option class="level-1" value="121">&nbsp;&nbsp;&nbsp;网络&nbsp;&nbsp;(6)</option>
	<option class="level-0" value="104">自然语言处理&nbsp;&nbsp;(95)</option>
	<option class="level-1" value="109">&nbsp;&nbsp;&nbsp;中文分词&nbsp;&nbsp;(12)</option>
	<option class="level-1" value="128">&nbsp;&nbsp;&nbsp;句法分析&nbsp;&nbsp;(8)</option>
	<option class="level-1" value="127">&nbsp;&nbsp;&nbsp;命名实体识别&nbsp;&nbsp;(7)</option>
	<option class="level-1" value="105">&nbsp;&nbsp;&nbsp;语料库&nbsp;&nbsp;(4)</option>
	<option class="level-0" value="12">软件发布&nbsp;&nbsp;(9)</option>
</select>
</form>
<script type="text/javascript">
/* <![CDATA[ */
(function() {
	var dropdown = document.getElementById( "cat" );
	function onCatChange() {
		if ( dropdown.options[ dropdown.selectedIndex ].value > 0 ) {
			dropdown.parentNode.submit();
		}
	}
	dropdown.onchange = onCatChange;
})();
/* ]]> */
</script>

</div><div class="widget widget_archive" style="top: 0px;"><h3>文章归档</h3>		<label class="screen-reader-text" for="archives-dropdown-5">文章归档</label>
		<select id="archives-dropdown-5" name="archive-dropdown" onchange="document.location.href=this.options[this.selectedIndex].value;">
			
			<option value="">选择月份</option>
				<option value="http://www.hankcs.com/2018/02/"> 2018年二月 &nbsp;(2)</option>
	<option value="http://www.hankcs.com/2017/12/"> 2017年十二月 &nbsp;(2)</option>
	<option value="http://www.hankcs.com/2017/11/"> 2017年十一月 &nbsp;(2)</option>
	<option value="http://www.hankcs.com/2017/08/"> 2017年八月 &nbsp;(1)</option>
	<option value="http://www.hankcs.com/2017/07/"> 2017年七月 &nbsp;(14)</option>
	<option value="http://www.hankcs.com/2017/06/"> 2017年六月 &nbsp;(28)</option>
	<option value="http://www.hankcs.com/2017/05/"> 2017年五月 &nbsp;(8)</option>
	<option value="http://www.hankcs.com/2017/03/"> 2017年三月 &nbsp;(12)</option>
	<option value="http://www.hankcs.com/2017/02/"> 2017年二月 &nbsp;(13)</option>
	<option value="http://www.hankcs.com/2017/01/"> 2017年一月 &nbsp;(22)</option>
	<option value="http://www.hankcs.com/2016/12/"> 2016年十二月 &nbsp;(2)</option>
	<option value="http://www.hankcs.com/2016/11/"> 2016年十一月 &nbsp;(15)</option>
	<option value="http://www.hankcs.com/2016/10/"> 2016年十月 &nbsp;(3)</option>
	<option value="http://www.hankcs.com/2016/09/"> 2016年九月 &nbsp;(3)</option>
	<option value="http://www.hankcs.com/2016/08/"> 2016年八月 &nbsp;(7)</option>
	<option value="http://www.hankcs.com/2016/07/"> 2016年七月 &nbsp;(1)</option>
	<option value="http://www.hankcs.com/2016/06/"> 2016年六月 &nbsp;(1)</option>
	<option value="http://www.hankcs.com/2016/05/"> 2016年五月 &nbsp;(3)</option>
	<option value="http://www.hankcs.com/2016/04/"> 2016年四月 &nbsp;(2)</option>
	<option value="http://www.hankcs.com/2016/03/"> 2016年三月 &nbsp;(3)</option>
	<option value="http://www.hankcs.com/2016/02/"> 2016年二月 &nbsp;(3)</option>
	<option value="http://www.hankcs.com/2015/12/"> 2015年十二月 &nbsp;(3)</option>
	<option value="http://www.hankcs.com/2015/11/"> 2015年十一月 &nbsp;(6)</option>
	<option value="http://www.hankcs.com/2015/10/"> 2015年十月 &nbsp;(4)</option>
	<option value="http://www.hankcs.com/2015/09/"> 2015年九月 &nbsp;(4)</option>
	<option value="http://www.hankcs.com/2015/08/"> 2015年八月 &nbsp;(2)</option>
	<option value="http://www.hankcs.com/2015/07/"> 2015年七月 &nbsp;(6)</option>
	<option value="http://www.hankcs.com/2015/05/"> 2015年五月 &nbsp;(3)</option>
	<option value="http://www.hankcs.com/2015/04/"> 2015年四月 &nbsp;(5)</option>
	<option value="http://www.hankcs.com/2015/03/"> 2015年三月 &nbsp;(3)</option>
	<option value="http://www.hankcs.com/2015/02/"> 2015年二月 &nbsp;(22)</option>
	<option value="http://www.hankcs.com/2015/01/"> 2015年一月 &nbsp;(14)</option>
	<option value="http://www.hankcs.com/2014/12/"> 2014年十二月 &nbsp;(10)</option>
	<option value="http://www.hankcs.com/2014/11/"> 2014年十一月 &nbsp;(21)</option>
	<option value="http://www.hankcs.com/2014/10/"> 2014年十月 &nbsp;(14)</option>
	<option value="http://www.hankcs.com/2014/09/"> 2014年九月 &nbsp;(16)</option>
	<option value="http://www.hankcs.com/2014/08/"> 2014年八月 &nbsp;(11)</option>
	<option value="http://www.hankcs.com/2014/07/"> 2014年七月 &nbsp;(6)</option>
	<option value="http://www.hankcs.com/2014/06/"> 2014年六月 &nbsp;(13)</option>
	<option value="http://www.hankcs.com/2014/05/"> 2014年五月 &nbsp;(28)</option>
	<option value="http://www.hankcs.com/2014/04/"> 2014年四月 &nbsp;(41)</option>
	<option value="http://www.hankcs.com/2014/03/"> 2014年三月 &nbsp;(26)</option>
	<option value="http://www.hankcs.com/2014/02/"> 2014年二月 &nbsp;(52)</option>
	<option value="http://www.hankcs.com/2014/01/"> 2014年一月 &nbsp;(28)</option>
	<option value="http://www.hankcs.com/2013/12/"> 2013年十二月 &nbsp;(29)</option>
	<option value="http://www.hankcs.com/2013/11/"> 2013年十一月 &nbsp;(21)</option>
	<option value="http://www.hankcs.com/2013/10/"> 2013年十月 &nbsp;(11)</option>
	<option value="http://www.hankcs.com/2013/09/"> 2013年九月 &nbsp;(19)</option>
	<option value="http://www.hankcs.com/2013/08/"> 2013年八月 &nbsp;(22)</option>
	<option value="http://www.hankcs.com/2013/07/"> 2013年七月 &nbsp;(36)</option>
	<option value="http://www.hankcs.com/2013/06/"> 2013年六月 &nbsp;(24)</option>
	<option value="http://www.hankcs.com/2013/05/"> 2013年五月 &nbsp;(36)</option>
	<option value="http://www.hankcs.com/2013/04/"> 2013年四月 &nbsp;(29)</option>
	<option value="http://www.hankcs.com/2013/03/"> 2013年三月 &nbsp;(46)</option>
	<option value="http://www.hankcs.com/2013/02/"> 2013年二月 &nbsp;(5)</option>
	<option value="http://www.hankcs.com/2012/05/"> 2012年五月 &nbsp;(2)</option>
	<option value="http://www.hankcs.com/2012/04/"> 2012年四月 &nbsp;(6)</option>
	<option value="http://www.hankcs.com/2010/12/"> 2010年十二月 &nbsp;(5)</option>
	<option value="http://www.hankcs.com/2010/11/"> 2010年十一月 &nbsp;(10)</option>
	<option value="http://www.hankcs.com/2010/10/"> 2010年十月 &nbsp;(13)</option>
	<option value="http://www.hankcs.com/2010/09/"> 2010年九月 &nbsp;(6)</option>
	<option value="http://www.hankcs.com/2010/08/"> 2010年八月 &nbsp;(5)</option>
	<option value="http://www.hankcs.com/2010/07/"> 2010年七月 &nbsp;(3)</option>
	<option value="http://www.hankcs.com/2010/06/"> 2010年六月 &nbsp;(12)</option>
	<option value="http://www.hankcs.com/2010/05/"> 2010年五月 &nbsp;(14)</option>
	<option value="http://www.hankcs.com/2010/04/"> 2010年四月 &nbsp;(8)</option>
	<option value="http://www.hankcs.com/2010/03/"> 2010年三月 &nbsp;(16)</option>
	<option value="http://www.hankcs.com/2010/01/"> 2010年一月 &nbsp;(16)</option>
	<option value="http://www.hankcs.com/2009/12/"> 2009年十二月 &nbsp;(33)</option>
	<option value="http://www.hankcs.com/2009/11/"> 2009年十一月 &nbsp;(26)</option>
	<option value="http://www.hankcs.com/2009/09/"> 2009年九月 &nbsp;(2)</option>

		</select>
		</div><div class="widget widget_ui_posts"><h3>热门文章</h3><ul>		<li><a target="_blank" href="http://www.hankcs.com/ml/machine-learning-entry-list.html"><span class="thumbnail"><img src="./CS229编程7：K-means聚类与主成分分析-码农场_files/6cbb8645gw1ew7s3qoi2uj20h30meaco.jpg" class="thumb" alt="机器学习入门书单" title="机器学习入门书单"></span><span class="text">机器学习入门书单</span><span class="muted">2015-02-04</span><span class="muted">评论(34)</span></a></li>
		<li><a target="_blank" href="http://www.hankcs.com/ml/back-propagation-neural-network.html"><span class="thumbnail"><img src="./CS229编程7：K-means聚类与主成分分析-码农场_files/6cbb8645gw1exsm4yho09j208c044t8o.jpg" class="thumb" alt="反向传播神经网络极简入门" title="反向传播神经网络极简入门"></span><span class="text">反向传播神经网络极简入门</span><span class="muted">2015-11-08</span><span class="muted">评论(32)</span></a></li>
		<li><a target="_blank" href="http://www.hankcs.com/ml/naive-bayesian-method.html"><span class="thumbnail"><img src="./CS229编程7：K-means聚类与主成分分析-码农场_files/6cbb8645jw1eozn0y3spcj20mn0h3q3a.jpg" class="thumb" alt="朴素贝叶斯法" title="朴素贝叶斯法"></span><span class="text">朴素贝叶斯法</span><span class="muted">2015-02-09</span><span class="muted">评论(15)</span></a></li>
		<li><a target="_blank" href="http://www.hankcs.com/ml/the-perceptron.html"><span class="thumbnail"><img src="./CS229编程7：K-means聚类与主成分分析-码农场_files/6cbb8645jw1eosuidbbwng20m80gotio.gif" class="thumb" alt="感知机" title="感知机"></span><span class="text">感知机</span><span class="muted">2015-02-05</span><span class="muted">评论(13)</span></a></li>
		<li><a target="_blank" href="http://www.hankcs.com/ml/k-nearest-neighbor-method.html"><span class="thumbnail"><img src="./CS229编程7：K-means聚类与主成分分析-码农场_files/6cbb8645jw1eoxj45stqqg20m80godki.gif" class="thumb" alt="k近邻法" title="k近邻法"></span><span class="text">k近邻法</span><span class="muted">2015-02-06</span><span class="muted">评论(13)</span></a></li>
		<li><a target="_blank" href="http://www.hankcs.com/ml/understanding-the-convolution-in-deep-learning.html"><span class="thumbnail"><img src="./CS229编程7：K-means聚类与主成分分析-码农场_files/006Fmjmcly1fdwjpji6qtj30dw05d0t8.jpg" class="thumb" alt="理解深度学习中的卷积" title="理解深度学习中的卷积"></span><span class="text">理解深度学习中的卷积</span><span class="muted">2017-03-24</span><span class="muted">评论(12)</span></a></li>
</ul></div><div class="widget widget_ui_posts" style="top: 0px;"><h3>最新文章</h3><ul>		<li><a target="_blank" href="http://www.hankcs.com/ml/structural-learning-with-amortized-inference.html"><span class="thumbnail"><img src="./CS229编程7：K-means聚类与主成分分析-码农场_files/006Fmjmcly1fmsl6ov9noj31kw12d48e.jpg" class="thumb" alt="Structural Learning with Amortized Inference" title="Structural Learning with Amortized Inference"></span><span class="text">Structural Learning with Amortized Inference</span><span class="muted">2017-12-25</span><span class="muted">评论(0)</span></a></li>
		<li><a target="_blank" href="http://www.hankcs.com/ml/compile-and-install-tensorflow-from-source.html"><span class="thumbnail"><img src="./CS229编程7：K-means聚类与主成分分析-码农场_files/6cbb8645gw1f9ty3e8d82j20ju0g6jsn.jpg" class="thumb" alt="从源码编译安装TensorFlow" title="从源码编译安装TensorFlow"></span><span class="text">从源码编译安装TensorFlow</span><span class="muted">2017-06-26</span><span class="muted">评论(3)</span></a></li>
		<li><a target="_blank" href="http://www.hankcs.com/ml/hinton-recent-applications-of-deep-neural-nets.html"><span class="thumbnail"><img src="./CS229编程7：K-means聚类与主成分分析-码农场_files/006Fmjmcly1fga3c5iit4j30n40hg0tw.jpg" class="thumb" alt="Hinton神经网络公开课16 Recent applications of deep neural nets" title="Hinton神经网络公开课16 Recent applications of deep neural nets"></span><span class="text">Hinton神经网络公开课16 Recent applications of deep neural nets</span><span class="muted">2017-06-05</span><span class="muted">评论(0)</span></a></li>
		<li><a target="_blank" href="http://www.hankcs.com/ml/hinton-modeling-hierarchical-structure-with-neural-nets.html"><span class="thumbnail"><img src="./CS229编程7：K-means聚类与主成分分析-码农场_files/006Fmjmcly1fg9g1g542jj30z60n07t8.jpg" class="thumb" alt="Hinton神经网络公开课15 Modeling hierarchical structure with neural nets" title="Hinton神经网络公开课15 Modeling hierarchical structure with neural nets"></span><span class="text">Hinton神经网络公开课15 Modeling hierarchical structure with neural nets</span><span class="muted">2017-06-04</span><span class="muted">评论(0)</span></a></li>
		<li><a target="_blank" href="http://www.hankcs.com/ml/nnml-rbm.html"><span class="thumbnail"><img src="./CS229编程7：K-means聚类与主成分分析-码农场_files/006Fmjmcly1fg8ao6kthsj31kw11x48q.jpg" class="thumb" alt="Hinton神经网络公开课编程练习4 Restricted Boltzmann Machines" title="Hinton神经网络公开课编程练习4 Restricted Boltzmann Machines"></span><span class="text">Hinton神经网络公开课编程练习4 Restricted Boltzmann Machines</span><span class="muted">2017-06-03</span><span class="muted">评论(3)</span></a></li>
		<li><a target="_blank" href="http://www.hankcs.com/ml/hinton-deep-neural-nets-with-generative-pre-training.html"><span class="thumbnail"><img src="./CS229编程7：K-means聚类与主成分分析-码农场_files/006Fmjmcly1fg61rho89qj30p00e6gsm.jpg" class="thumb" alt="Hinton神经网络公开课14 Deep neural nets with generative pre-training" title="Hinton神经网络公开课14 Deep neural nets with generative pre-training"></span><span class="text">Hinton神经网络公开课14 Deep neural nets with generative pre-training</span><span class="muted">2017-06-02</span><span class="muted">评论(0)</span></a></li>
</ul></div><div class="widget_text widget widget_custom_html"><h3>订阅关注</h3><div class="textwidget custom-html-widget"><iframe width="100%" height="400" class="share_self" frameborder="0" scrolling="no" src="./CS229编程7：K-means聚类与主成分分析-码农场_files/index.html"></iframe></div></div><div class="widget widget_ui_tags" style="top: 0px;"><h3>热门标签</h3><div class="d_tags"><a href="http://www.hankcs.com/tag/%e3%80%8a%e6%8c%91%e6%88%98%e7%a8%8b%e5%ba%8f%e8%ae%be%e8%ae%a1%e7%ab%9e%e8%b5%9b%e7%ac%ac2%e7%89%88%e3%80%8b/">《挑战程序设计竞赛(第2版)》 (184)</a><a href="http://www.hankcs.com/tag/%e3%80%8a%e6%97%a5%e8%af%ad%e7%bb%bc%e5%90%88%e6%95%99%e7%a8%8b%e3%80%8b/">《日语综合教程》 (57)</a><a href="http://www.hankcs.com/tag/cs224n/">CS224n (36)</a><a href="http://www.hankcs.com/tag/%e3%80%8a%e6%96%b0%e7%bc%96%e6%97%a5%e8%af%ad%e9%98%85%e8%af%bb%e6%96%87%e9%80%89%e3%80%8b/">《新编日语阅读文选》 (34)</a><a href="http://www.hankcs.com/tag/%e3%80%8a%e6%99%ba%e8%83%bdweb%e7%ae%97%e6%b3%95%e3%80%8b/">《智能Web算法》 (20)</a><a href="http://www.hankcs.com/tag/%e4%b8%ad%e6%96%87%e5%88%86%e8%af%8d/">中文分词 (19)</a><a href="http://www.hankcs.com/tag/neural-networks-for-machine-learning/">Neural Networks for Machine Learning (19)</a><a href="http://www.hankcs.com/tag/wordpress/">WordPress (17)</a><a href="http://www.hankcs.com/tag/%e6%b7%b1%e5%ba%a6%e5%ad%a6%e4%b9%a0/">深度学习 (16)</a><a href="http://www.hankcs.com/tag/lucene/">Lucene (15)</a><a href="http://www.hankcs.com/tag/%e7%bb%b4%e7%89%b9%e6%af%94%e7%ae%97%e6%b3%95/">维特比算法 (15)</a><a href="http://www.hankcs.com/tag/%e6%96%b0%e7%bc%96%e6%97%a5%e8%af%ad%e5%95%86%e5%8a%a1%e8%b4%b8%e6%98%93%e4%bc%9a%e8%af%9d/">新编日语商务贸易会话 (14)</a><a href="http://www.hankcs.com/tag/intellij-idea/">IntelliJ IDEA (13)</a><a href="http://www.hankcs.com/tag/%e3%80%8a%e7%bb%9f%e8%ae%a1%e5%ad%a6%e4%b9%a0%e6%96%b9%e6%b3%95%e3%80%8b/">《统计学习方法》 (12)</a><a href="http://www.hankcs.com/tag/uva/">UVa (11)</a><a href="http://www.hankcs.com/tag/drupal7%e4%b8%93%e4%b8%9a%e5%bc%80%e5%8f%91%e6%8c%87%e5%8d%97-%e7%ac%ac%e4%b8%89%e7%89%88/">Drupal7专业开发指南 第三版 (10)</a><a href="http://www.hankcs.com/tag/%e3%80%8a%e6%8c%91%e6%88%98%e7%bc%96%e7%a8%8b-%e7%a8%8b%e5%ba%8f%e8%ae%be%e8%ae%a1%e7%ab%9e%e8%b5%9b%e8%ae%ad%e7%bb%83%e6%89%8b%e5%86%8c%e3%80%8b/">《挑战编程-程序设计竞赛训练手册》 (10)</a><a href="http://www.hankcs.com/tag/hmm/">HMM (10)</a><a href="http://www.hankcs.com/tag/matlab/">matlab (9)</a><a href="http://www.hankcs.com/tag/tensorflow/">TensorFlow (9)</a><a href="http://www.hankcs.com/tag/cs229/">CS229 (8)</a><a href="http://www.hankcs.com/tag/word2vec/">word2vec (8)</a><a href="http://www.hankcs.com/tag/google-code-jam/">Google code jam (7)</a><a href="http://www.hankcs.com/tag/%e3%80%8ac%e6%a0%87%e5%87%86%e7%a8%8b%e5%ba%8f%e5%ba%93-%e8%87%aa%e4%bf%ae%e6%95%99%e7%a8%8b%e4%b8%8e%e5%8f%82%e8%80%83%e6%89%8b%e5%86%8c%e3%80%8b/">《C++标准程序库—自修教程与参考手册》 (7)</a><a href="http://www.hankcs.com/tag/crf/">CRF (7)</a><a href="http://www.hankcs.com/tag/yii/">Yii (6)</a><a href="http://www.hankcs.com/tag/cnn/">CNN (6)</a><a href="http://www.hankcs.com/tag/webrtc/">WebRTC (5)</a><a href="http://www.hankcs.com/tag/cocos2d-x/">Cocos2d-x (5)</a><a href="http://www.hankcs.com/tag/rnn/">RNN (5)</a></div></div></aside></section>

<div class="branding branding-black">
	<div class="container">
		<h2>我的开源项目</h2>
		<a target="blank" class="btn btn-lg" href="https://github.com/hankcs/HanLP">HanLP自然语言处理包</a><a target="blank" class="btn btn-lg" href="https://github.com/hankcs/AhoCorasickDoubleArrayTrie">基于DoubleArrayTrie的Aho Corasick自动机</a>	</div>
</div>
<footer class="footer">
	<div class="container">
		<div class="fcode">
					</div>
		<p>© 2018 <a href="http://www.hankcs.com/">码农场</a> &nbsp; <a href="http://www.hankcs.com/sitemap.xml">网站地图</a> &nbsp; <a href="http://www.miitbeian.gov.cn/" target="_blank">沪ICP备14002007号-1</a></p>
		<div style="display:none">
<script language="javascript" type="text/javascript" src="./CS229编程7：K-means聚类与主成分分析-码农场_files/trace.js.下载"></script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-47205472-1', 'auto');
  ga('send', 'pageview');

</script>
</div>	</div>
</footer>

<script>
window.jsui={
    www: 'http://www.hankcs.com',
    uri: 'http://www.hankcs.com/wp-content/themes/dux',
    ver: '1.3',
	roll: ["1","2","6","4"],
    ajaxpager: '500',
    url_rp: 'http://www.hankcs.com/about/'
};
</script>
<script type="text/javascript" src="./CS229编程7：K-means聚类与主成分分析-码农场_files/bootstrap.min.js.下载"></script>
<script type="text/javascript" src="./CS229编程7：K-means聚类与主成分分析-码农场_files/loader.js.下载"></script>
<script type="text/javascript" src="./CS229编程7：K-means聚类与主成分分析-码农场_files/wp-embed.min.js.下载"></script>
<script async="async" type="text/javascript" src="./CS229编程7：K-means聚类与主成分分析-码农场_files/form.js.下载"></script>

<iframe id="google_osd_static_frame_9740039620167" name="google_osd_static_frame" style="display: none; width: 0px; height: 0px;" src="./CS229编程7：K-means聚类与主成分分析-码农场_files/saved_resource(18).html"></iframe>    <div class="m-mask"></div>    <div class="rollbar"><ul><li><a href="javascript:(scrollTo());"><i class="fa fa-angle-up"></i></a><h6>去顶部<i></i></h6></li><li><a href="javascript:(on_click_toc_button());"><i class="fa fa-list post_open_icon"></i></a><h6 id="toc_label">打开目录</h6></li><li><a href="javascript:(scrollTo(&#39;#comments&#39;,-15));"><i class="fa fa-comments"></i></a><h6>去评论<i></i></h6></li></ul></div><ul class="m-navbar">
			<li id="menu-item-1834" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1834"><a href="http://www.hankcs.com/program/cpp/">C++</a></li>
<li id="menu-item-1835" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1835"><a href="http://www.hankcs.com/program/java/">Java</a></li>
<li id="menu-item-5754" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-5754"><a href="http://www.hankcs.com/ml/">机器学习</a></li>
<li id="menu-item-2954" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-2954"><a href="http://www.hankcs.com/nlp/">NLP</a>
<ul class="sub-menu">
	<li id="menu-item-4344" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-4344"><a href="http://www.hankcs.com/nlp/corpus/">语料库</a></li>
	<li id="menu-item-4342" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-4342"><a href="http://www.hankcs.com/nlp/segment/">中文分词</a></li>
	<li id="menu-item-4343" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-4343"><a href="http://www.hankcs.com/nlp/ner/">命名实体识别</a></li>
	<li id="menu-item-4479" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-4479"><a href="http://www.hankcs.com/nlp/parsing/">句法分析</a></li>
</ul>
</li>
<li id="menu-item-1837" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1837"><a href="http://www.hankcs.com/program/algorithm/">算法</a></li>
<li id="menu-item-1839" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1839"><a href="http://www.hankcs.com/software/">软件</a></li>
<li id="menu-item-1838" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-1838"><a href="http://www.hankcs.com/nihongonote/">日语</a>
<ul class="sub-menu">
	<li id="menu-item-1860" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1860"><a href="http://www.hankcs.com/nihongonote/riyurimen/">日语入门</a></li>
	<li id="menu-item-1861" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1861"><a href="http://www.hankcs.com/nihongonote/listening/">日语听力</a></li>
	<li id="menu-item-1863" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-1863"><a href="http://www.hankcs.com/nihongonote/tekusuto/">日语综合教程</a>
	<ul class="sub-menu">
		<li id="menu-item-2190" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-2190"><a href="http://www.hankcs.com/nihongonote/tekusuto/disance/">第三册</a></li>
		<li id="menu-item-2192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-2192"><a href="http://www.hankcs.com/nihongonote/tekusuto/daiyonnsatu/">第四册</a></li>
		<li id="menu-item-2191" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-2191"><a href="http://www.hankcs.com/nihongonote/tekusuto/5/">第五册</a></li>
		<li id="menu-item-2702" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-2702"><a href="http://www.hankcs.com/nihongonote/tekusuto/%e7%ac%ac%e5%85%ad%e5%86%8c/">第六册</a></li>
		<li id="menu-item-3604" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3604"><a href="http://www.hankcs.com/nihongonote/tekusuto/%e7%ac%ac%e4%b8%83%e5%86%8c/">第七册</a></li>
	</ul>
</li>
	<li id="menu-item-1859" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-1859"><a href="http://www.hankcs.com/nihongonote/fd2/">新编日语阅读文选</a>
	<ul class="sub-menu">
		<li id="menu-item-2187" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-2187"><a href="http://www.hankcs.com/nihongonote/fd2/c1/">第一册</a></li>
		<li id="menu-item-2189" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-2189"><a href="http://www.hankcs.com/nihongonote/fd2/c2/">第二册</a></li>
		<li id="menu-item-2188" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-2188"><a href="http://www.hankcs.com/nihongonote/fd2/c3/">第三册</a></li>
	</ul>
</li>
	<li id="menu-item-1858" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1858"><a href="http://www.hankcs.com/nihongonote/jpkaiwa/">日语商务贸易会话</a></li>
</ul>
</li>
<li id="menu-item-1843" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1843"><a href="http://www.hankcs.com/about/">关于</a></li>
							<li class="navto-search"><a href="javascript:;" class="search-show active"><i class="fa fa-search"></i></a></li>
					</ul>			<div class="sign">			    <div class="sign-mask"></div>			    <div class="container">			        <a href="http://www.hankcs.com/ml/principal-component-analysis-k-means-cs229.html#" class="close-link signclose-loader"><i class="fa fa-close"></i></a>			        <div class="sign-tips"></div>			        <form id="sign-in">  			            <h3><small class="signup-loader">切换注册</small>登录</h3>			            <h6>			                <label for="inputEmail">用户名或邮箱</label>			                <input type="text" name="username" class="form-control" id="inputEmail" placeholder="用户名或邮箱">			            </h6>			            <h6>			                <label for="inputPassword">密码</label>			                <input type="password" name="password" class="form-control" id="inputPassword" placeholder="登录密码">			            </h6>			            <div class="sign-submit">			                <input type="button" class="btn btn-primary signsubmit-loader" name="submit" value="登录">  			                <input type="hidden" name="action" value="signin">			                <label><input type="checkbox" checked="checked" name="remember" value="forever">记住我</label>			            </div><div class="sign-info"><a href="http://www.hankcs.com/about/">找回密码？</a></div></form>			        <form id="sign-up"> 			            <h3><small class="signin-loader">切换登录</small>注册</h3>			            <h6>			                <label for="inputName">昵称</label>			                <input type="text" name="name" class="form-control" id="inputName" placeholder="设置昵称">			            </h6>			            <h6>			                <label for="inputEmail">邮箱</label>			                <input type="email" name="email" class="form-control" id="inputEmail" placeholder="邮箱">			            </h6>			            <div class="sign-submit">			                <input type="button" class="btn btn-primary btn-block signsubmit-loader" name="submit" value="快速注册">  			                <input type="hidden" name="action" value="signup">  			            </div>			        </form>			    </div>			</div>		<img style="width:0;height:0;display:none;visibility:hidden;" src="./CS229编程7：K-means聚类与主成分分析-码农场_files/saved_resource(1)"><img style="width:0;height:0;display:none;visibility:hidden;" src="./CS229编程7：K-means聚类与主成分分析-码农场_files/saved_resource(2)"></body><iframe id="google_shimpl" style="display: none;" src="./CS229编程7：K-means聚类与主成分分析-码农场_files/saved_resource(19).html"></iframe></html>